!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).firebase=t()}(this,(function(){"use strict";!function(e){if(!e.fetch){var t="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,r="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in e,s="ArrayBuffer"in e;if(s)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(e){return e&&DataView.prototype.isPrototypeOf(e)},c=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};p.prototype.append=function(e,t){e=h(e),t=d(t);var n=this.map[e];this.map[e]=n?n+","+t:t},p.prototype.delete=function(e){delete this.map[h(e)]},p.prototype.get=function(e){return e=h(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(h(e))},p.prototype.set=function(e,t){this.map[h(e)]=d(t)},p.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},p.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),f(e)},p.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),f(e)},p.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),f(e)},n&&(p.prototype[Symbol.iterator]=p.prototype.entries);var u=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},v.call(w.prototype),v.call(I.prototype),I.prototype.clone=function(){return new I(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},I.error=function(){var e=new I(null,{status:0,statusText:""});return e.type="error",e};var l=[301,302,303,307,308];I.redirect=function(e,t){if(-1===l.indexOf(t))throw new RangeError("Invalid status code");return new I(null,{status:t,headers:{location:e}})},e.Headers=p,e.Request=w,e.Response=I,e.fetch=function(e,t){return new Promise((function(n,i){var s=new w(e,t),o=new XMLHttpRequest;o.onload=function(){var e,t,r={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",t=new p,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t)};r.url="responseURL"in o?o.responseURL:r.headers.get("X-Request-URL");var i="response"in o?o.response:o.responseText;n(new I(i,r))},o.onerror=function(){i(new TypeError("Network request failed"))},o.ontimeout=function(){i(new TypeError("Network request failed"))},o.open(s.method,s.url,!0),"include"===s.credentials?o.withCredentials=!0:"omit"===s.credentials&&(o.withCredentials=!1),"responseType"in o&&r&&(o.responseType="blob"),s.headers.forEach((function(e,t){o.setRequestHeader(t,e)})),o.send(void 0===s._bodyInit?null:s._bodyInit)}))},e.fetch.polyfill=!0}function h(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function d(e){return"string"!=typeof e&&(e=String(e)),e}function f(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function p(e){this.map={},e instanceof p?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function g(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function m(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function y(e){var t=new FileReader,n=m(t);return t.readAsArrayBuffer(e),n}function _(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(r&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(i&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(s&&r&&a(e))this._bodyArrayBuffer=_(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!s||!ArrayBuffer.prototype.isPrototypeOf(e)&&!c(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=_(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r&&(this.blob=function(){var e=g(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?g(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var e=g(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=m(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}function w(e,t){var n,r,i=(t=t||{}).body;if(e instanceof w){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),u.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function b(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function I(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:void 0);var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){var t={exports:{}};return e(t,t.exports),t.exports}var n=function(e){return e&&e.Math==Math&&e},r=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||function(){return this}()||Function("return this")(),i=function(e){try{return!!e()}catch(e){return!0}},s=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),o={}.propertyIsEnumerable,a=Object.getOwnPropertyDescriptor,c={f:a&&!o.call({1:2},1)?function(e){var t=a(this,e);return!!t&&t.enumerable}:o},u=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},l={}.toString,h=function(e){return l.call(e).slice(8,-1)},d="".split,f=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==h(e)?d.call(e,""):Object(e)}:Object,p=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},g=function(e){return f(p(e))},m=function(e){return"object"==typeof e?null!==e:"function"==typeof e},y=function(e,t){if(!m(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!m(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},_={}.hasOwnProperty,v=function(e,t){return _.call(e,t)},w=r.document,b=m(w)&&m(w.createElement),I=function(e){return b?w.createElement(e):{}},T=!s&&!i((function(){return 7!=Object.defineProperty(I("div"),"a",{get:function(){return 7}}).a})),E=Object.getOwnPropertyDescriptor,S={f:s?E:function(e,t){if(e=g(e),t=y(t,!0),T)try{return E(e,t)}catch(e){}if(v(e,t))return u(!c.f.call(e,t),e[t])}},C=function(e){if(!m(e))throw TypeError(String(e)+" is not an object");return e},k=Object.defineProperty,R={f:s?k:function(e,t,n){if(C(e),t=y(t,!0),C(n),T)try{return k(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},N=s?function(e,t,n){return R.f(e,t,u(1,n))}:function(e,t,n){return e[t]=n,e},A=function(e,t){try{N(r,e,t)}catch(n){r[e]=t}return t},P="__core-js_shared__",x=r[P]||A(P,{}),D=Function.toString;"function"!=typeof x.inspectSource&&(x.inspectSource=function(e){return D.call(e)});var O,M,L,F=x.inspectSource,U=r.WeakMap,q="function"==typeof U&&/native code/.test(F(U)),j=!1,V=t((function(e){(e.exports=function(e,t){return x[e]||(x[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.8.1",mode:"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})})),B=0,$=Math.random(),W=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++B+$).toString(36)},K=V("keys"),z=function(e){return K[e]||(K[e]=W(e))},H={},G=r.WeakMap;if(q){var Q=x.state||(x.state=new G),Y=Q.get,J=Q.has,X=Q.set;O=function(e,t){return t.facade=e,X.call(Q,e,t),t},M=function(e){return Y.call(Q,e)||{}},L=function(e){return J.call(Q,e)}}else{var Z=z("state");H[Z]=!0,O=function(e,t){return t.facade=e,N(e,Z,t),t},M=function(e){return v(e,Z)?e[Z]:{}},L=function(e){return v(e,Z)}}var ee,te={set:O,get:M,has:L,enforce:function(e){return L(e)?M(e):O(e,{})},getterFor:function(e){return function(t){var n;if(!m(t)||(n=M(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},ne=t((function(e){var t=te.get,n=te.enforce,i=String(String).split("String");(e.exports=function(e,t,s,o){var a,c=!!o&&!!o.unsafe,u=!!o&&!!o.enumerable,l=!!o&&!!o.noTargetGet;"function"==typeof s&&("string"!=typeof t||v(s,"name")||N(s,"name",t),(a=n(s)).source||(a.source=i.join("string"==typeof t?t:""))),e!==r?(c?!l&&e[t]&&(u=!0):delete e[t],u?e[t]=s:N(e,t,s)):u?e[t]=s:A(t,s)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||F(this)}))})),re=r,ie=function(e){return"function"==typeof e?e:void 0},se=function(e,t){return arguments.length<2?ie(re[e])||ie(r[e]):re[e]&&re[e][t]||r[e]&&r[e][t]},oe=Math.ceil,ae=Math.floor,ce=function(e){return isNaN(e=+e)?0:(e>0?ae:oe)(e)},ue=Math.min,le=function(e){return e>0?ue(ce(e),9007199254740991):0},he=Math.max,de=Math.min,fe=function(e){return function(t,n,r){var i,s=g(t),o=le(s.length),a=function(e,t){var n=ce(e);return n<0?he(n+t,0):de(n,t)}(r,o);if(e&&n!=n){for(;o>a;)if((i=s[a++])!=i)return!0}else for(;o>a;a++)if((e||a in s)&&s[a]===n)return e||a||0;return!e&&-1}},pe={includes:fe(!0),indexOf:fe(!1)}.indexOf,ge=function(e,t){var n,r=g(e),i=0,s=[];for(n in r)!v(H,n)&&v(r,n)&&s.push(n);for(;t.length>i;)v(r,n=t[i++])&&(~pe(s,n)||s.push(n));return s},me=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ye=me.concat("length","prototype"),_e={f:Object.getOwnPropertyNames||function(e){return ge(e,ye)}},ve={f:Object.getOwnPropertySymbols},we=se("Reflect","ownKeys")||function(e){var t=_e.f(C(e)),n=ve.f;return n?t.concat(n(e)):t},be=function(e,t){for(var n=we(t),r=R.f,i=S.f,s=0;s<n.length;s++){var o=n[s];v(e,o)||r(e,o,i(t,o))}},Ie=/#|\.prototype\./,Te=function(e,t){var n=Se[Ee(e)];return n==ke||n!=Ce&&("function"==typeof t?i(t):!!t)},Ee=Te.normalize=function(e){return String(e).replace(Ie,".").toLowerCase()},Se=Te.data={},Ce=Te.NATIVE="N",ke=Te.POLYFILL="P",Re=Te,Ne=S.f,Ae=function(e,t){var n,i,s,o,a,c=e.target,u=e.global,l=e.stat;if(n=u?r:l?r[c]||A(c,{}):(r[c]||{}).prototype)for(i in t){if(o=t[i],s=e.noTargetGet?(a=Ne(n,i))&&a.value:n[i],!Re(u?i:c+(l?".":"#")+i,e.forced)&&void 0!==s){if(typeof o==typeof s)continue;be(o,s)}(e.sham||s&&s.sham)&&N(o,"sham",!0),ne(n,i,o,e)}},Pe=function(e){return Object(p(e))},xe=!i((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),De=z("IE_PROTO"),Oe=Object.prototype,Me=xe?Object.getPrototypeOf:function(e){return e=Pe(e),v(e,De)?e[De]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Oe:null},Le=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return C(n),function(e){if(!m(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(r),t?e.call(n,r):n.__proto__=r,n}}():void 0),Fe=Object.keys||function(e){return ge(e,me)},Ue=s?Object.defineProperties:function(e,t){C(e);for(var n,r=Fe(t),i=r.length,s=0;i>s;)R.f(e,n=r[s++],t[n]);return e},qe=se("document","documentElement"),je=z("IE_PROTO"),Ve=function(){},Be=function(e){return"<script>"+e+"</"+"script>"},$e=function(){try{ee=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;$e=ee?function(e){e.write(Be("")),e.close();var t=e.parentWindow.Object;return e=null,t}(ee):((t=I("iframe")).style.display="none",qe.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(Be("document.F=Object")),e.close(),e.F);for(var n=me.length;n--;)delete $e.prototype[me[n]];return $e()};H[je]=!0;var We=Object.create||function(e,t){var n;return null!==e?(Ve.prototype=C(e),n=new Ve,Ve.prototype=null,n[je]=e):n=$e(),void 0===t?n:Ue(n,t)},Ke=!!Object.getOwnPropertySymbols&&!i((function(){return!String(Symbol())})),ze=Ke&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,He=V("wks"),Ge=r.Symbol,Qe=ze?Ge:Ge&&Ge.withoutSetter||W,Ye=function(e){return v(He,e)||(Ke&&v(Ge,e)?He[e]=Ge[e]:He[e]=Qe("Symbol."+e)),He[e]},Je={},Xe=Ye("iterator"),Ze=Array.prototype,et=function(e){return void 0!==e&&(Je.Array===e||Ze[Xe]===e)},tt=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},nt=function(e,t,n){if(tt(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},rt={};rt[Ye("toStringTag")]="z";var it="[object z]"===String(rt),st=Ye("toStringTag"),ot="Arguments"==h(function(){return arguments}()),at=it?h:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),st))?n:ot?h(t):"Object"==(r=h(t))&&"function"==typeof t.callee?"Arguments":r},ct=Ye("iterator"),ut=function(e){if(null!=e)return e[ct]||e["@@iterator"]||Je[at(e)]},lt=function(e){var t=e.return;if(void 0!==t)return C(t.call(e)).value},ht=function(e,t){this.stopped=e,this.result=t},dt=function(e,t,n){var r,i,s,o,a,c,u,l=n&&n.that,h=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_ITERATOR),f=!(!n||!n.INTERRUPTED),p=nt(t,l,1+h+f),g=function(e){return r&&lt(r),new ht(!0,e)},m=function(e){return h?(C(e),f?p(e[0],e[1],g):p(e[0],e[1])):f?p(e,g):p(e)};if(d)r=e;else{if("function"!=typeof(i=ut(e)))throw TypeError("Target is not iterable");if(et(i)){for(s=0,o=le(e.length);o>s;s++)if((a=m(e[s]))&&a instanceof ht)return a;return new ht(!1)}r=i.call(e)}for(c=r.next;!(u=c.call(r)).done;){try{a=m(u.value)}catch(e){throw lt(r),e}if("object"==typeof a&&a&&a instanceof ht)return a}return new ht(!1)},ft=function(e,t){var n=this;if(!(n instanceof ft))return new ft(e,t);Le&&(n=Le(new Error(void 0),Me(n))),void 0!==t&&N(n,"message",String(t));var r=[];return dt(e,r.push,{that:r}),N(n,"errors",r),n};ft.prototype=We(Error.prototype,{constructor:u(5,ft),message:u(5,""),name:u(5,"AggregateError")}),Ae({global:!0},{AggregateError:ft});var pt=it?{}.toString:function(){return"[object "+at(this)+"]"};it||ne(Object.prototype,"toString",pt,{unsafe:!0});var gt=r.Promise,mt=function(e,t,n){for(var r in t)ne(e,r,t[r],n);return e},yt=R.f,_t=Ye("toStringTag"),vt=function(e,t,n){e&&!v(e=n?e:e.prototype,_t)&&yt(e,_t,{configurable:!0,value:t})},wt=Ye("species"),bt=function(e){var t=se(e),n=R.f;s&&t&&!t[wt]&&n(t,wt,{configurable:!0,get:function(){return this}})},It=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e},Tt=Ye("iterator"),Et=!1;try{var St=0,Ct={next:function(){return{done:!!St++}},return:function(){Et=!0}};Ct[Tt]=function(){return this},Array.from(Ct,(function(){throw 2}))}catch(ef){}var kt,Rt,Nt,At=function(e,t){if(!t&&!Et)return!1;var n=!1;try{var r={};r[Tt]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},Pt=Ye("species"),xt=function(e,t){var n,r=C(e).constructor;return void 0===r||null==(n=C(r)[Pt])?t:tt(n)},Dt=se("navigator","userAgent")||"",Ot=/(iphone|ipod|ipad).*applewebkit/i.test(Dt),Mt="process"==h(r.process),Lt=r.location,Ft=r.setImmediate,Ut=r.clearImmediate,qt=r.process,jt=r.MessageChannel,Vt=r.Dispatch,Bt=0,$t={},Wt="onreadystatechange",Kt=function(e){if($t.hasOwnProperty(e)){var t=$t[e];delete $t[e],t()}},zt=function(e){return function(){Kt(e)}},Ht=function(e){Kt(e.data)},Gt=function(e){r.postMessage(e+"",Lt.protocol+"//"+Lt.host)};Ft&&Ut||(Ft=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return $t[++Bt]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},kt(Bt),Bt},Ut=function(e){delete $t[e]},Mt?kt=function(e){qt.nextTick(zt(e))}:Vt&&Vt.now?kt=function(e){Vt.now(zt(e))}:jt&&!Ot?(Nt=(Rt=new jt).port2,Rt.port1.onmessage=Ht,kt=nt(Nt.postMessage,Nt,1)):r.addEventListener&&"function"==typeof postMessage&&!r.importScripts&&Lt&&"file:"!==Lt.protocol&&!i(Gt)?(kt=Gt,r.addEventListener("message",Ht,!1)):kt=Wt in I("script")?function(e){qe.appendChild(I("script")).onreadystatechange=function(){qe.removeChild(this),Kt(e)}}:function(e){setTimeout(zt(e),0)});var Qt,Yt,Jt,Xt,Zt,en,tn,nn,rn={set:Ft,clear:Ut},sn=S.f,on=rn.set,an=r.MutationObserver||r.WebKitMutationObserver,cn=r.document,un=r.process,ln=r.Promise,hn=sn(r,"queueMicrotask"),dn=hn&&hn.value;dn||(Qt=function(){var e,t;for(Mt&&(e=un.domain)&&e.exit();Yt;){t=Yt.fn,Yt=Yt.next;try{t()}catch(e){throw Yt?Xt():Jt=void 0,e}}Jt=void 0,e&&e.enter()},!Ot&&!Mt&&an&&cn?(Zt=!0,en=cn.createTextNode(""),new an(Qt).observe(en,{characterData:!0}),Xt=function(){en.data=Zt=!Zt}):ln&&ln.resolve?(tn=ln.resolve(void 0),nn=tn.then,Xt=function(){nn.call(tn,Qt)}):Xt=Mt?function(){un.nextTick(Qt)}:function(){on.call(r,Qt)});var fn,pn,gn=dn||function(e){var t={fn:e,next:void 0};Jt&&(Jt.next=t),Yt||(Yt=t,Xt()),Jt=t},mn=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=tt(t),this.reject=tt(n)},yn={f:function(e){return new mn(e)}},_n=function(e,t){if(C(e),m(t)&&t.constructor===e)return t;var n=yn.f(e);return(0,n.resolve)(t),n.promise},vn=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},wn=r.process,bn=wn&&wn.versions,In=bn&&bn.v8;In?pn=(fn=In.split("."))[0]+fn[1]:Dt&&(!(fn=Dt.match(/Edge\/(\d+)/))||fn[1]>=74)&&(fn=Dt.match(/Chrome\/(\d+)/))&&(pn=fn[1]);var Tn,En,Sn,Cn,kn=pn&&+pn,Rn=rn.set,Nn=Ye("species"),An="Promise",Pn=te.get,xn=te.set,Dn=te.getterFor(An),On=gt,Mn=r.TypeError,Ln=r.document,Fn=r.process,Un=se("fetch"),qn=yn.f,jn=qn,Vn=!!(Ln&&Ln.createEvent&&r.dispatchEvent),Bn="function"==typeof PromiseRejectionEvent,$n="unhandledrejection",Wn=Re(An,(function(){if(!(F(On)!==String(On))){if(66===kn)return!0;if(!Mt&&!Bn)return!0}if(kn>=51&&/native code/.test(On))return!1;var e=On.resolve(1),t=function(e){e((function(){}),(function(){}))};return(e.constructor={})[Nn]=t,!(e.then((function(){}))instanceof t)})),Kn=Wn||!At((function(e){On.all(e).catch((function(){}))})),zn=function(e){var t;return!(!m(e)||"function"!=typeof(t=e.then))&&t},Hn=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;gn((function(){for(var r=e.value,i=1==e.state,s=0;n.length>s;){var o,a,c,u=n[s++],l=i?u.ok:u.fail,h=u.resolve,d=u.reject,f=u.domain;try{l?(i||(2===e.rejection&&Jn(e),e.rejection=1),!0===l?o=r:(f&&f.enter(),o=l(r),f&&(f.exit(),c=!0)),o===u.promise?d(Mn("Promise-chain cycle")):(a=zn(o))?a.call(o,h,d):h(o)):d(r)}catch(e){f&&!c&&f.exit(),d(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&Qn(e)}))}},Gn=function(e,t,n){var i,s;Vn?((i=Ln.createEvent("Event")).promise=t,i.reason=n,i.initEvent(e,!1,!0),r.dispatchEvent(i)):i={promise:t,reason:n},!Bn&&(s=r["on"+e])?s(i):e===$n&&function(e,t){var n=r.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},Qn=function(e){Rn.call(r,(function(){var t,n=e.facade,r=e.value;if(Yn(e)&&(t=vn((function(){Mt?Fn.emit("unhandledRejection",r,n):Gn($n,n,r)})),e.rejection=Mt||Yn(e)?2:1,t.error))throw t.value}))},Yn=function(e){return 1!==e.rejection&&!e.parent},Jn=function(e){Rn.call(r,(function(){var t=e.facade;Mt?Fn.emit("rejectionHandled",t):Gn("rejectionhandled",t,e.value)}))},Xn=function(e,t,n){return function(r){e(t,r,n)}},Zn=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,Hn(e,!0))},er=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw Mn("Promise can't be resolved itself");var r=zn(t);r?gn((function(){var n={done:!1};try{r.call(t,Xn(er,n,e),Xn(Zn,n,e))}catch(t){Zn(n,t,e)}})):(e.value=t,e.state=1,Hn(e,!1))}catch(t){Zn({done:!1},t,e)}}};Wn&&(On=function(e){It(this,On,An),tt(e),Tn.call(this);var t=Pn(this);try{e(Xn(er,t),Xn(Zn,t))}catch(e){Zn(t,e)}},(Tn=function(e){xn(this,{type:An,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=mt(On.prototype,{then:function(e,t){var n=Dn(this),r=qn(xt(this,On));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=Mt?Fn.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&Hn(n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),En=function(){var e=new Tn,t=Pn(e);this.promise=e,this.resolve=Xn(er,t),this.reject=Xn(Zn,t)},yn.f=qn=function(e){return e===On||e===Sn?new En(e):jn(e)},"function"==typeof gt&&(Cn=gt.prototype.then,ne(gt.prototype,"then",(function(e,t){var n=this;return new On((function(e,t){Cn.call(n,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof Un&&Ae({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return _n(On,Un.apply(r,arguments))}}))),Ae({global:!0,wrap:!0,forced:Wn},{Promise:On}),vt(On,An,!1),bt(An),Sn=se(An),Ae({target:An,stat:!0,forced:Wn},{reject:function(e){var t=qn(this);return t.reject.call(void 0,e),t.promise}}),Ae({target:An,stat:!0,forced:Wn},{resolve:function(e){return _n(this,e)}}),Ae({target:An,stat:!0,forced:Kn},{all:function(e){var t=this,n=qn(t),r=n.resolve,i=n.reject,s=vn((function(){var n=tt(t.resolve),s=[],o=0,a=1;dt(e,(function(e){var c=o++,u=!1;s.push(void 0),a++,n.call(t,e).then((function(e){u||(u=!0,s[c]=e,--a||r(s))}),i)})),--a||r(s)}));return s.error&&i(s.value),n.promise},race:function(e){var t=this,n=qn(t),r=n.reject,i=vn((function(){var i=tt(t.resolve);dt(e,(function(e){i.call(t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}}),Ae({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=yn.f(t),r=n.resolve,i=n.reject,s=vn((function(){var n=tt(t.resolve),i=[],s=0,o=1;dt(e,(function(e){var a=s++,c=!1;i.push(void 0),o++,n.call(t,e).then((function(e){c||(c=!0,i[a]={status:"fulfilled",value:e},--o||r(i))}),(function(e){c||(c=!0,i[a]={status:"rejected",reason:e},--o||r(i))}))})),--o||r(i)}));return s.error&&i(s.value),n.promise}});var tr="No one promise resolved";Ae({target:"Promise",stat:!0},{any:function(e){var t=this,n=yn.f(t),r=n.resolve,i=n.reject,s=vn((function(){var n=tt(t.resolve),s=[],o=0,a=1,c=!1;dt(e,(function(e){var u=o++,l=!1;s.push(void 0),a++,n.call(t,e).then((function(e){l||c||(c=!0,r(e))}),(function(e){l||c||(l=!0,s[u]=e,--a||i(new(se("AggregateError"))(s,tr)))}))})),--a||i(new(se("AggregateError"))(s,tr))}));return s.error&&i(s.value),n.promise}});var nr=!!gt&&i((function(){gt.prototype.finally.call({then:function(){}},(function(){}))}));Ae({target:"Promise",proto:!0,real:!0,forced:nr},{finally:function(e){var t=xt(this,se("Promise")),n="function"==typeof e;return this.then(n?function(n){return _n(t,e()).then((function(){return n}))}:e,n?function(n){return _n(t,e()).then((function(){throw n}))}:e)}}),"function"!=typeof gt||gt.prototype.finally||ne(gt.prototype,"finally",se("Promise").prototype.finally);var rr,ir,sr,or=function(e){return function(t,n){var r,i,s=String(p(t)),o=ce(n),a=s.length;return o<0||o>=a?e?"":void 0:(r=s.charCodeAt(o))<55296||r>56319||o+1===a||(i=s.charCodeAt(o+1))<56320||i>57343?e?s.charAt(o):r:e?s.slice(o,o+2):i-56320+(r-55296<<10)+65536}},ar={codeAt:or(!1),charAt:or(!0)},cr=Ye("iterator"),ur=!1;[].keys&&("next"in(sr=[].keys())?(ir=Me(Me(sr)))!==Object.prototype&&(rr=ir):ur=!0),null==rr&&(rr={}),v(rr,cr)||N(rr,cr,(function(){return this}));var lr={IteratorPrototype:rr,BUGGY_SAFARI_ITERATORS:ur},hr=lr.IteratorPrototype,dr=function(){return this},fr=lr.IteratorPrototype,pr=lr.BUGGY_SAFARI_ITERATORS,gr=Ye("iterator"),mr="keys",yr="values",_r="entries",vr=function(){return this},wr=function(e,t,n,r,i,s,o){!function(e,t,n){var r=t+" Iterator";e.prototype=We(hr,{next:u(1,n)}),vt(e,r,!1),Je[r]=dr}(n,t,r);var a,c,l,h=function(e){if(e===i&&m)return m;if(!pr&&e in p)return p[e];switch(e){case mr:case yr:case _r:return function(){return new n(this,e)}}return function(){return new n(this)}},d=t+" Iterator",f=!1,p=e.prototype,g=p[gr]||p["@@iterator"]||i&&p[i],m=!pr&&g||h(i),y="Array"==t&&p.entries||g;if(y&&(a=Me(y.call(new e)),fr!==Object.prototype&&a.next&&(Me(a)!==fr&&(Le?Le(a,fr):"function"!=typeof a[gr]&&N(a,gr,vr)),vt(a,d,!0))),i==yr&&g&&g.name!==yr&&(f=!0,m=function(){return g.call(this)}),p[gr]!==m&&N(p,gr,m),Je[t]=m,i)if(c={values:h(yr),keys:s?m:h(mr),entries:h(_r)},o)for(l in c)(pr||f||!(l in p))&&ne(p,l,c[l]);else Ae({target:t,proto:!0,forced:pr||f},c);return c},br=ar.charAt,Ir="String Iterator",Tr=te.set,Er=te.getterFor(Ir);wr(String,"String",(function(e){Tr(this,{type:Ir,string:String(e),index:0})}),(function(){var e,t=Er(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=br(n,r),t.index+=e.length,{value:e,done:!1})}));var Sr={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Cr=Ye("unscopables"),kr=Array.prototype;null==kr[Cr]&&R.f(kr,Cr,{configurable:!0,value:We(null)});var Rr=function(e){kr[Cr][e]=!0},Nr="Array Iterator",Ar=te.set,Pr=te.getterFor(Nr),xr=wr(Array,"Array",(function(e,t){Ar(this,{type:Nr,target:g(e),index:0,kind:t})}),(function(){var e=Pr(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");Je.Arguments=Je.Array,Rr("keys"),Rr("values"),Rr("entries");var Dr=Ye("iterator"),Or=Ye("toStringTag"),Mr=xr.values;for(var Lr in Sr){var Fr=r[Lr],Ur=Fr&&Fr.prototype;if(Ur){if(Ur[Dr]!==Mr)try{N(Ur,Dr,Mr)}catch(ef){Ur[Dr]=Mr}if(Ur[Or]||N(Ur,Or,Lr),Sr[Lr])for(var qr in xr)if(Ur[qr]!==xr[qr])try{N(Ur,qr,xr[qr])}catch(ef){Ur[qr]=xr[qr]}}}re.Promise;Ae({target:"Promise",stat:!0},{try:function(e){var t=yn.f(this),n=vn(e);return(n.error?t.reject:t.resolve)(n.value),t.promise}});var jr=Array.isArray||function(e){return"Array"==h(e)},Vr=Ye("species"),Br=function(e,t){var n;return jr(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!jr(n.prototype)?m(n)&&null===(n=n[Vr])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)},$r=[].push,Wr=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,s=6==e,o=7==e,a=5==e||s;return function(c,u,l,h){for(var d,p,g=Pe(c),m=f(g),y=nt(u,l,3),_=le(m.length),v=0,w=h||Br,b=t?w(c,_):n||o?w(c,0):void 0;_>v;v++)if((a||v in m)&&(p=y(d=m[v],v,g),e))if(t)b[v]=p;else if(p)switch(e){case 3:return!0;case 5:return d;case 6:return v;case 2:$r.call(b,d)}else switch(e){case 4:return!1;case 7:$r.call(b,d)}return s?-1:r||i?i:b}},Kr={forEach:Wr(0),map:Wr(1),filter:Wr(2),some:Wr(3),every:Wr(4),find:Wr(5),findIndex:Wr(6),filterOut:Wr(7)},zr=Object.defineProperty,Hr={},Gr=function(e){throw e},Qr=function(e,t){if(v(Hr,e))return Hr[e];t||(t={});var n=[][e],r=!!v(t,"ACCESSORS")&&t.ACCESSORS,o=v(t,0)?t[0]:Gr,a=v(t,1)?t[1]:void 0;return Hr[e]=!!n&&!i((function(){if(r&&!s)return!0;var e={length:-1};r?zr(e,1,{enumerable:!0,get:Gr}):e[1]=1,n.call(e,o,a)}))},Yr=Kr.find,Jr="find",Xr=!0,Zr=Qr(Jr);Jr in[]&&Array(1).find((function(){Xr=!1})),Ae({target:"Array",proto:!0,forced:Xr||!Zr},{find:function(e){return Yr(this,e,arguments.length>1?arguments[1]:void 0)}}),Rr(Jr);var ei=Function.call,ti=function(e,t,n){return nt(ei,r[e].prototype[t],n)},ni=(ti("Array","find"),Kr.findIndex),ri="findIndex",ii=!0,si=Qr(ri);ri in[]&&Array(1).findIndex((function(){ii=!1})),Ae({target:"Array",proto:!0,forced:ii||!si},{findIndex:function(e){return ni(this,e,arguments.length>1?arguments[1]:void 0)}}),Rr(ri);ti("Array","findIndex");var oi=function(e,t,n,r){try{return r?t(C(n)[0],n[1]):t(n)}catch(t){throw lt(e),t}},ai=function(e,t,n){var r=y(t);r in e?R.f(e,r,u(0,n)):e[r]=n},ci=!At((function(e){Array.from(e)}));Ae({target:"Array",stat:!0,forced:ci},{from:function(e){var t,n,r,i,s,o,a=Pe(e),c="function"==typeof this?this:Array,u=arguments.length,l=u>1?arguments[1]:void 0,h=void 0!==l,d=ut(a),f=0;if(h&&(l=nt(l,u>2?arguments[2]:void 0,2)),null==d||c==Array&&et(d))for(n=new c(t=le(a.length));t>f;f++)o=h?l(a[f],f):a[f],ai(n,f,o);else for(s=(i=d.call(a)).next,n=new c;!(r=s.call(i)).done;f++)o=h?oi(i,l,[r.value,f],!0):r.value,ai(n,f,o);return n.length=f,n}});re.Array.from;var ui=Kr.some,li=function(e,t){var n=[][e];return!!n&&i((function(){n.call(null,t||function(){throw 1},1)}))}("some"),hi=Qr("some");Ae({target:"Array",proto:!0,forced:!li||!hi},{some:function(e){return ui(this,e,arguments.length>1?arguments[1]:void 0)}});ti("Array","some");var di,fi="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,pi=R.f,gi=r.Int8Array,mi=gi&&gi.prototype,yi=r.Uint8ClampedArray,_i=yi&&yi.prototype,vi=gi&&Me(gi),wi=mi&&Me(mi),bi=Object.prototype,Ii=(bi.isPrototypeOf,Ye("toStringTag")),Ti=W("TYPED_ARRAY_TAG"),Ei=fi&&!!Le&&"Opera"!==at(r.opera),Si={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Ci={BigInt64Array:8,BigUint64Array:8},ki=function(e){if(!m(e))return!1;var t=at(e);return v(Si,t)||v(Ci,t)};for(di in Si)r[di]||(Ei=!1);if((!Ei||"function"!=typeof vi||vi===Function.prototype)&&(vi=function(){throw TypeError("Incorrect invocation")},Ei))for(di in Si)r[di]&&Le(r[di],vi);if((!Ei||!wi||wi===bi)&&(wi=vi.prototype,Ei))for(di in Si)r[di]&&Le(r[di].prototype,wi);if(Ei&&Me(_i)!==wi&&Le(_i,wi),s&&!v(wi,Ii))for(di in!0,pi(wi,Ii,{get:function(){return m(this)?this[Ti]:void 0}}),Si)r[di]&&N(r[di],Ti,di);var Ri=function(e){if(ki(e))return e;throw TypeError("Target is not a typed array")},Ni=function(e,t,n){if(s){if(n)for(var i in Si){var o=r[i];o&&v(o.prototype,e)&&delete o.prototype[e]}wi[e]&&!n||ne(wi,e,n?t:Ei&&mi[e]||t)}},Ai=Ye("iterator"),Pi=r.Uint8Array,xi=xr.values,Di=xr.keys,Oi=xr.entries,Mi=Ri,Li=Ni,Fi=Pi&&Pi.prototype[Ai],Ui=!!Fi&&("values"==Fi.name||null==Fi.name),qi=function(){return xi.call(Mi(this))};Li("entries",(function(){return Oi.call(Mi(this))})),Li("keys",(function(){return Di.call(Mi(this))})),Li("values",qi,!Ui),Li(Ai,qi,!Ui);var ji=Object.assign,Vi=Object.defineProperty,Bi=!ji||i((function(){if(s&&1!==ji({b:1},ji(Vi({},"a",{enumerable:!0,get:function(){Vi(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=ji({},e)[n]||Fe(ji({},t)).join("")!=r}))?function(e,t){for(var n=Pe(e),r=arguments.length,i=1,o=ve.f,a=c.f;r>i;)for(var u,l=f(arguments[i++]),h=o?Fe(l).concat(o(l)):Fe(l),d=h.length,p=0;d>p;)u=h[p++],s&&!a.call(l,u)||(n[u]=l[u]);return n}:ji;Ae({target:"Object",stat:!0,forced:Object.assign!==Bi},{assign:Bi});re.Object.assign;var $i=c.f,Wi=function(e){return function(t){for(var n,r=g(t),i=Fe(r),o=i.length,a=0,c=[];o>a;)n=i[a++],s&&!$i.call(r,n)||c.push(e?[n,r[n]]:r[n]);return c}},Ki={entries:Wi(!0),values:Wi(!1)},zi=Ki.entries;Ae({target:"Object",stat:!0},{entries:function(e){return zi(e)}});re.Object.entries;var Hi=Ki.values;Ae({target:"Object",stat:!0},{values:function(e){return Hi(e)}});re.Object.values;var Gi=Ye("match"),Qi=function(e){if(function(e){var t;return m(e)&&(void 0!==(t=e[Gi])?!!t:"RegExp"==h(e))}(e))throw TypeError("The method doesn't accept regular expressions");return e},Yi=Ye("match"),Ji=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[Yi]=!1,"/./"[e](t)}catch(e){}}return!1};Ae({target:"String",proto:!0,forced:!Ji("includes")},{includes:function(e){return!!~String(p(this)).indexOf(Qi(e),arguments.length>1?arguments[1]:void 0)}});ti("String","includes");var Xi,Zi=S.f,es="".startsWith,ts=Math.min,ns=Ji("startsWith"),rs=!(ns||(Xi=Zi(String.prototype,"startsWith"),!Xi||Xi.writable));Ae({target:"String",proto:!0,forced:!rs&&!ns},{startsWith:function(e){var t=String(p(this));Qi(e);var n=le(ts(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return es?es.call(t,r,n):t.slice(n,n+r.length)===r}});ti("String","startsWith");Ae({target:"String",proto:!0},{repeat:"".repeat||function(e){var t=String(p(this)),n="",r=ce(e);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}});ti("String","repeat");var is=Ye("species"),ss=Ye("isConcatSpreadable"),os=9007199254740991,as="Maximum allowed index exceeded",cs=kn>=51||!i((function(){var e=[];return e[ss]=!1,e.concat()[0]!==e})),us=function(e){return kn>=51||!i((function(){var t=[];return(t.constructor={})[is]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}("concat"),ls=function(e){if(!m(e))return!1;var t=e[ss];return void 0!==t?!!t:jr(e)};Ae({target:"Array",proto:!0,forced:!cs||!us},{concat:function(e){var t,n,r,i,s,o=Pe(this),a=Br(o,0),c=0;for(t=-1,r=arguments.length;t<r;t++)if(ls(s=-1===t?o:arguments[t])){if(c+(i=le(s.length))>os)throw TypeError(as);for(n=0;n<i;n++,c++)n in s&&ai(a,c,s[n])}else{if(c>=os)throw TypeError(as);ai(a,c++,s)}return a.length=c,a}});var hs=_e.f,ds={}.toString,fs="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],ps={f:function(e){return fs&&"[object Window]"==ds.call(e)?function(e){try{return hs(e)}catch(e){return fs.slice()}}(e):hs(g(e))}},gs={f:Ye},ms=R.f,ys=function(e){var t=re.Symbol||(re.Symbol={});v(t,e)||ms(t,e,{value:gs.f(e)})},_s=Kr.forEach,vs=z("hidden"),ws="Symbol",bs=Ye("toPrimitive"),Is=te.set,Ts=te.getterFor(ws),Es=Object.prototype,Ss=r.Symbol,Cs=se("JSON","stringify"),ks=S.f,Rs=R.f,Ns=ps.f,As=c.f,Ps=V("symbols"),xs=V("op-symbols"),Ds=V("string-to-symbol-registry"),Os=V("symbol-to-string-registry"),Ms=V("wks"),Ls=r.QObject,Fs=!Ls||!Ls.prototype||!Ls.prototype.findChild,Us=s&&i((function(){return 7!=We(Rs({},"a",{get:function(){return Rs(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=ks(Es,t);r&&delete Es[t],Rs(e,t,n),r&&e!==Es&&Rs(Es,t,r)}:Rs,qs=function(e,t){var n=Ps[e]=We(Ss.prototype);return Is(n,{type:ws,tag:e,description:t}),s||(n.description=t),n},js=ze?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof Ss},Vs=function(e,t,n){e===Es&&Vs(xs,t,n),C(e);var r=y(t,!0);return C(n),v(Ps,r)?(n.enumerable?(v(e,vs)&&e[vs][r]&&(e[vs][r]=!1),n=We(n,{enumerable:u(0,!1)})):(v(e,vs)||Rs(e,vs,u(1,{})),e[vs][r]=!0),Us(e,r,n)):Rs(e,r,n)},Bs=function(e,t){C(e);var n=g(t),r=Fe(n).concat(zs(n));return _s(r,(function(t){s&&!$s.call(n,t)||Vs(e,t,n[t])})),e},$s=function(e){var t=y(e,!0),n=As.call(this,t);return!(this===Es&&v(Ps,t)&&!v(xs,t))&&(!(n||!v(this,t)||!v(Ps,t)||v(this,vs)&&this[vs][t])||n)},Ws=function(e,t){var n=g(e),r=y(t,!0);if(n!==Es||!v(Ps,r)||v(xs,r)){var i=ks(n,r);return!i||!v(Ps,r)||v(n,vs)&&n[vs][r]||(i.enumerable=!0),i}},Ks=function(e){var t=Ns(g(e)),n=[];return _s(t,(function(e){v(Ps,e)||v(H,e)||n.push(e)})),n},zs=function(e){var t=e===Es,n=Ns(t?xs:g(e)),r=[];return _s(n,(function(e){!v(Ps,e)||t&&!v(Es,e)||r.push(Ps[e])})),r};if(Ke||(ne((Ss=function(){if(this instanceof Ss)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=W(e),n=function(e){this===Es&&n.call(xs,e),v(this,vs)&&v(this[vs],t)&&(this[vs][t]=!1),Us(this,t,u(1,e))};return s&&Fs&&Us(Es,t,{configurable:!0,set:n}),qs(t,e)}).prototype,"toString",(function(){return Ts(this).tag})),ne(Ss,"withoutSetter",(function(e){return qs(W(e),e)})),c.f=$s,R.f=Vs,S.f=Ws,_e.f=ps.f=Ks,ve.f=zs,gs.f=function(e){return qs(Ye(e),e)},s&&(Rs(Ss.prototype,"description",{configurable:!0,get:function(){return Ts(this).description}}),ne(Es,"propertyIsEnumerable",$s,{unsafe:!0}))),Ae({global:!0,wrap:!0,forced:!Ke,sham:!Ke},{Symbol:Ss}),_s(Fe(Ms),(function(e){ys(e)})),Ae({target:ws,stat:!0,forced:!Ke},{for:function(e){var t=String(e);if(v(Ds,t))return Ds[t];var n=Ss(t);return Ds[t]=n,Os[n]=t,n},keyFor:function(e){if(!js(e))throw TypeError(e+" is not a symbol");if(v(Os,e))return Os[e]},useSetter:function(){Fs=!0},useSimple:function(){Fs=!1}}),Ae({target:"Object",stat:!0,forced:!Ke,sham:!s},{create:function(e,t){return void 0===t?We(e):Bs(We(e),t)},defineProperty:Vs,defineProperties:Bs,getOwnPropertyDescriptor:Ws}),Ae({target:"Object",stat:!0,forced:!Ke},{getOwnPropertyNames:Ks,getOwnPropertySymbols:zs}),Ae({target:"Object",stat:!0,forced:i((function(){ve.f(1)}))},{getOwnPropertySymbols:function(e){return ve.f(Pe(e))}}),Cs){var Hs=!Ke||i((function(){var e=Ss();return"[null]"!=Cs([e])||"{}"!=Cs({a:e})||"{}"!=Cs(Object(e))}));Ae({target:"JSON",stat:!0,forced:Hs},{stringify:function(e,t,n){for(var r,i=[e],s=1;arguments.length>s;)i.push(arguments[s++]);if(r=t,(m(t)||void 0!==e)&&!js(e))return jr(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!js(t))return t}),i[1]=t,Cs.apply(null,i)}})}Ss.prototype[bs]||N(Ss.prototype,bs,Ss.prototype.valueOf),vt(Ss,ws),H[vs]=!0,ys("asyncIterator");var Gs=R.f,Qs=r.Symbol;if(s&&"function"==typeof Qs&&(!("description"in Qs.prototype)||void 0!==Qs().description)){var Ys={},Js=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof Js?new Qs(e):void 0===e?Qs():Qs(e);return""===e&&(Ys[t]=!0),t};be(Js,Qs);var Xs=Js.prototype=Qs.prototype;Xs.constructor=Js;var Zs=Xs.toString,eo="Symbol(test)"==String(Qs("test")),to=/^Symbol\((.*)\)[^)]+$/;Gs(Xs,"description",{configurable:!0,get:function(){var e=m(this)?this.valueOf():this,t=Zs.call(e);if(v(Ys,e))return"";var n=eo?t.slice(7,-1):t.replace(to,"$1");return""===n?void 0:n}}),Ae({global:!0,forced:!0},{Symbol:Js})}ys("hasInstance"),ys("isConcatSpreadable"),ys("iterator"),ys("match"),ys("matchAll"),ys("replace"),ys("search"),ys("species"),ys("split"),ys("toPrimitive"),ys("toStringTag"),ys("unscopables"),vt(r.JSON,"JSON",!0),vt(Math,"Math",!0),Ae({global:!0},{Reflect:{}}),vt(r.Reflect,"Reflect",!0);re.Symbol;ys("asyncDispose"),ys("dispose"),ys("observable"),ys("patternMatch"),ys("replaceAll");gs.f("iterator");var no=!i((function(){return Object.isExtensible(Object.preventExtensions({}))})),ro=t((function(e){var t=R.f,n=W("meta"),r=0,i=Object.isExtensible||function(){return!0},s=function(e){t(e,n,{value:{objectID:"O"+ ++r,weakData:{}}})},o=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!m(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!v(e,n)){if(!i(e))return"F";if(!t)return"E";s(e)}return e[n].objectID},getWeakData:function(e,t){if(!v(e,n)){if(!i(e))return!0;if(!t)return!1;s(e)}return e[n].weakData},onFreeze:function(e){return no&&o.REQUIRED&&i(e)&&!v(e,n)&&s(e),e}};H[n]=!0})),io=function(e,t,n){var s=-1!==e.indexOf("Map"),o=-1!==e.indexOf("Weak"),a=s?"set":"add",c=r[e],u=c&&c.prototype,l=c,h={},d=function(e){var t=u[e];ne(u,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(o&&!m(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return o&&!m(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(o&&!m(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})};if(Re(e,"function"!=typeof c||!(o||u.forEach&&!i((function(){(new c).entries().next()})))))l=n.getConstructor(t,e,s,a),ro.REQUIRED=!0;else if(Re(e,!0)){var f=new l,p=f[a](o?{}:-0,1)!=f,g=i((function(){f.has(1)})),y=At((function(e){new c(e)})),_=!o&&i((function(){for(var e=new c,t=5;t--;)e[a](t,t);return!e.has(-0)}));y||((l=t((function(t,n){It(t,l,e);var r=function(e,t,n){var r,i;return Le&&"function"==typeof(r=t.constructor)&&r!==n&&m(i=r.prototype)&&i!==n.prototype&&Le(e,i),e}(new c,t,l);return null!=n&&dt(n,r[a],{that:r,AS_ENTRIES:s}),r}))).prototype=u,u.constructor=l),(g||_)&&(d("delete"),d("has"),s&&d("get")),(_||p)&&d(a),o&&u.clear&&delete u.clear}return h[e]=l,Ae({global:!0,forced:l!=c},h),vt(l,e),o||n.setStrong(l,e,s),l},so=R.f,oo=ro.fastKey,ao=te.set,co=te.getterFor,uo={getConstructor:function(e,t,n,r){var i=e((function(e,o){It(e,i,t),ao(e,{type:t,index:We(null),first:void 0,last:void 0,size:0}),s||(e.size=0),null!=o&&dt(o,e[r],{that:e,AS_ENTRIES:n})})),o=co(t),a=function(e,t,n){var r,i,a=o(e),u=c(e,t);return u?u.value=n:(a.last=u={index:i=oo(t,!0),key:t,value:n,previous:r=a.last,next:void 0,removed:!1},a.first||(a.first=u),r&&(r.next=u),s?a.size++:e.size++,"F"!==i&&(a.index[i]=u)),e},c=function(e,t){var n,r=o(e),i=oo(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return mt(i.prototype,{clear:function(){for(var e=o(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,s?e.size=0:this.size=0},delete:function(e){var t=this,n=o(t),r=c(t,e);if(r){var i=r.next,a=r.previous;delete n.index[r.index],r.removed=!0,a&&(a.next=i),i&&(i.previous=a),n.first==r&&(n.first=i),n.last==r&&(n.last=a),s?n.size--:t.size--}return!!r},forEach:function(e){for(var t,n=o(this),r=nt(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!c(this,e)}}),mt(i.prototype,n?{get:function(e){var t=c(this,e);return t&&t.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),s&&so(i.prototype,"size",{get:function(){return o(this).size}}),i},setStrong:function(e,t,n){var r=t+" Iterator",i=co(t),s=co(r);wr(e,t,(function(e,t){ao(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=s(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),bt(t)}},lo=(io("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),uo),re.Map,function(e){var t,n,r,i,s=arguments.length,o=s>1?arguments[1]:void 0;return tt(this),(t=void 0!==o)&&tt(o),null==e?new this:(n=[],t?(r=0,i=nt(o,s>2?arguments[2]:void 0,2),dt(e,(function(e){n.push(i(e,r++))}))):dt(e,n.push,{that:n}),new this(n))});Ae({target:"Map",stat:!0},{from:lo});var ho=function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)};Ae({target:"Map",stat:!0},{of:ho});var fo=function(){for(var e,t=C(this),n=tt(t.delete),r=!0,i=0,s=arguments.length;i<s;i++)e=n.call(t,arguments[i]),r=r&&e;return!!r};Ae({target:"Map",proto:!0,real:!0,forced:j},{deleteAll:function(){return fo.apply(this,arguments)}});Ae({target:"Map",proto:!0,real:!0,forced:j},{emplace:function(e,t){var n=C(this),r=n.has(e)&&"update"in t?t.update(n.get(e),e,n):t.insert(e,n);return n.set(e,r),r}});var po=function(e){return Map.prototype.entries.call(e)};Ae({target:"Map",proto:!0,real:!0,forced:j},{every:function(e){var t=C(this),n=po(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3);return!dt(n,(function(e,n,i){if(!r(n,e,t))return i()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{filter:function(e){var t=C(this),n=po(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3),i=new(xt(t,se("Map"))),s=tt(i.set);return dt(n,(function(e,n){r(n,e,t)&&s.call(i,e,n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{find:function(e){var t=C(this),n=po(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3);return dt(n,(function(e,n,i){if(r(n,e,t))return i(n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{findKey:function(e){var t=C(this),n=po(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3);return dt(n,(function(e,n,i){if(r(n,e,t))return i(e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Ae({target:"Map",stat:!0},{groupBy:function(e,t){var n=new this;tt(t);var r=tt(n.has),i=tt(n.get),s=tt(n.set);return dt(e,(function(e){var o=t(e);r.call(n,o)?i.call(n,o).push(e):s.call(n,o,[e])})),n}});Ae({target:"Map",proto:!0,real:!0,forced:j},{includes:function(e){return dt(po(C(this)),(function(t,n,r){if(function(e,t){return e===t||e!=e&&t!=t}(n,e))return r()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Map",stat:!0},{keyBy:function(e,t){var n=new this;tt(t);var r=tt(n.set);return dt(e,(function(e){r.call(n,t(e),e)})),n}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{keyOf:function(e){return dt(po(C(this)),(function(t,n,r){if(n===e)return r(t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{mapKeys:function(e){var t=C(this),n=po(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3),i=new(xt(t,se("Map"))),s=tt(i.set);return dt(n,(function(e,n){s.call(i,r(n,e,t),n)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{mapValues:function(e){var t=C(this),n=po(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3),i=new(xt(t,se("Map"))),s=tt(i.set);return dt(n,(function(e,n){s.call(i,e,r(n,e,t))}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{merge:function(e){for(var t=C(this),n=tt(t.set),r=0;r<arguments.length;)dt(arguments[r++],n,{that:t,AS_ENTRIES:!0});return t}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{reduce:function(e){var t=C(this),n=po(t),r=arguments.length<2,i=r?void 0:arguments[1];if(tt(e),dt(n,(function(n,s){r?(r=!1,i=s):i=e(i,s,n,t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),r)throw TypeError("Reduce of empty map with no initial value");return i}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{some:function(e){var t=C(this),n=po(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3);return dt(n,(function(e,n,i){if(r(n,e,t))return i()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Map",proto:!0,real:!0,forced:j},{update:function(e,t){var n=C(this),r=arguments.length;tt(t);var i=n.has(e);if(!i&&r<3)throw TypeError("Updating absent value");var s=i?n.get(e):tt(r>2?arguments[2]:void 0)(e,n);return n.set(e,t(s,e,n)),n}});var go=function(e,t){var n,r=C(this),i=arguments.length>2?arguments[2]:void 0;if("function"!=typeof t&&"function"!=typeof i)throw TypeError("At least one callback required");return r.has(e)?(n=r.get(e),"function"==typeof t&&(n=t(n),r.set(e,n))):"function"==typeof i&&(n=i(),r.set(e,n)),n};Ae({target:"Map",proto:!0,real:!0,forced:j},{upsert:go}),Ae({target:"Map",proto:!0,real:!0,forced:j},{updateOrInsert:go});io("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),uo),re.Set;Ae({target:"Set",stat:!0},{from:lo}),Ae({target:"Set",stat:!0},{of:ho});var mo=function(){for(var e=C(this),t=tt(e.add),n=0,r=arguments.length;n<r;n++)t.call(e,arguments[n]);return e};Ae({target:"Set",proto:!0,real:!0,forced:j},{addAll:function(){return mo.apply(this,arguments)}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{deleteAll:function(){return fo.apply(this,arguments)}});var yo=function(e){return Set.prototype.values.call(e)};Ae({target:"Set",proto:!0,real:!0,forced:j},{every:function(e){var t=C(this),n=yo(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3);return!dt(n,(function(e,n){if(!r(e,e,t))return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{difference:function(e){var t=C(this),n=new(xt(t,se("Set")))(t),r=tt(n.delete);return dt(e,(function(e){r.call(n,e)})),n}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{filter:function(e){var t=C(this),n=yo(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3),i=new(xt(t,se("Set"))),s=tt(i.add);return dt(n,(function(e){r(e,e,t)&&s.call(i,e)}),{IS_ITERATOR:!0}),i}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{find:function(e){var t=C(this),n=yo(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3);return dt(n,(function(e,n){if(r(e,e,t))return n(e)}),{IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{intersection:function(e){var t=C(this),n=new(xt(t,se("Set"))),r=tt(t.has),i=tt(n.add);return dt(e,(function(e){r.call(t,e)&&i.call(n,e)})),n}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{isDisjointFrom:function(e){var t=C(this),n=tt(t.has);return!dt(e,(function(e,r){if(!0===n.call(t,e))return r()}),{INTERRUPTED:!0}).stopped}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{isSubsetOf:function(e){var t=function(e){var t=ut(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return C(t.call(e))}(this),n=C(e),r=n.has;return"function"!=typeof r&&(n=new(se("Set"))(e),r=tt(n.has)),!dt(t,(function(e,t){if(!1===r.call(n,e))return t()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{isSupersetOf:function(e){var t=C(this),n=tt(t.has);return!dt(e,(function(e,r){if(!1===n.call(t,e))return r()}),{INTERRUPTED:!0}).stopped}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{join:function(e){var t=C(this),n=yo(t),r=void 0===e?",":String(e),i=[];return dt(n,i.push,{that:i,IS_ITERATOR:!0}),i.join(r)}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{map:function(e){var t=C(this),n=yo(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3),i=new(xt(t,se("Set"))),s=tt(i.add);return dt(n,(function(e){s.call(i,r(e,e,t))}),{IS_ITERATOR:!0}),i}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{reduce:function(e){var t=C(this),n=yo(t),r=arguments.length<2,i=r?void 0:arguments[1];if(tt(e),dt(n,(function(n){r?(r=!1,i=n):i=e(i,n,n,t)}),{IS_ITERATOR:!0}),r)throw TypeError("Reduce of empty set with no initial value");return i}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{some:function(e){var t=C(this),n=yo(t),r=nt(e,arguments.length>1?arguments[1]:void 0,3);return dt(n,(function(e,n){if(r(e,e,t))return n()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{symmetricDifference:function(e){var t=C(this),n=new(xt(t,se("Set")))(t),r=tt(n.delete),i=tt(n.add);return dt(e,(function(e){r.call(n,e)||i.call(n,e)})),n}}),Ae({target:"Set",proto:!0,real:!0,forced:j},{union:function(e){var t=C(this),n=new(xt(t,se("Set")))(t);return dt(e,tt(n.add),{that:n}),n}});var _o=Math.floor;Ae({target:"Number",stat:!0},{isInteger:function(e){return!m(e)&&isFinite(e)&&_o(e)===e}});re.Number.isInteger;Ae({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});re.Number.isNaN;
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */var vo=function(e,t){return(vo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};var wo=function(){return(wo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function bo(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function Io(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))}function To(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function Eo(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function So(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function Co(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var ko=!1,Ro="${JSCORE_VERSION}",No=function(e,t){if(!e)throw Ao(t)},Ao=function(e){return new Error("Firebase Database ("+Ro+") INTERNAL ASSERT FAILED: "+e)},Po=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},xo={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var s=e[i],o=i+1<e.length,a=o?e[i+1]:0,c=i+2<e.length,u=c?e[i+2]:0,l=s>>2,h=(3&s)<<4|a>>4,d=(15&a)<<2|u>>6,f=63&u;c||(f=64,o||(d=64)),r.push(n[l],n[h],n[d],n[f])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Po(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){var o=((7&i)<<18|(63&(s=e[n++]))<<12|(63&(a=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{s=e[n++];var a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var s=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,a=++i<e.length?n[e.charAt(i)]:64,c=++i<e.length?n[e.charAt(i)]:64;if(++i,null==s||null==o||null==a||null==c)throw Error();var u=s<<2|o>>4;if(r.push(u),64!==a){var l=o<<4&240|a>>2;if(r.push(l),64!==c){var h=a<<6&192|c;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},Do=function(e){var t=Po(e);return xo.encodeByteArray(t,!0)},Oo=function(e){try{return xo.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Mo(e){return Lo(void 0,e)}function Lo(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=Lo(e[n],t[n]));return e}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
var Fo=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}},e}();
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Uo(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var s=wo({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[xo.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),xo.encodeString(JSON.stringify(s),!1),""].join(".")}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function qo(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function jo(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qo())}function Vo(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return!1}}function Bo(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function $o(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Wo(){var e=qo();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function Ko(){return!0===ko}function zo(){return"indexedDB"in self&&null!=indexedDB}function Ho(){return new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}function Go(){return!(!navigator||!navigator.cookieEnabled)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var Qo=function(e){function t(n,r,i){var s=e.call(this,r)||this;return s.code=n,s.customData=i,s.name="FirebaseError",Object.setPrototypeOf(s,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,Yo.prototype.create),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}vo(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t}(Error),Yo=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t[0]||{},i=this.service+"/"+e,s=this.errors[e],o=s?Jo(s,r):"Error",a=this.serviceName+": "+o+" ("+i+").",c=new Qo(i,a,r);return c},e}();function Jo(e,t){return e.replace(Xo,(function(e,n){var r=t[n];return null!=r?String(r):"<"+n+"?>"}))}var Xo=/\{\$([^}]+)}/g;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Zo(e){return JSON.parse(e)}function ea(e){return JSON.stringify(e)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var ta=function(e){var t={},n={},r={},i="";try{var s=e.split(".");t=Zo(Oo(s[0])||""),n=Zo(Oo(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}},na=function(e){var t=ta(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},ra=function(e){var t=ta(e).claims;return"object"==typeof t&&!0===t.admin};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function ia(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function sa(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function oa(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function aa(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function ca(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach((function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))})):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,i=Object.entries(e);r<i.length;r++){var s=i[r];n(s[0],s[1])}return t.length?"&"+t.join("&"):""}function ua(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=e.split("="),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}})),t}function la(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var ha=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var s,o,a=this.chain_[0],c=this.chain_[1],u=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(s=l^c&(u^l),o=1518500249):(s=c^u^l,o=1859775393):r<60?(s=c&u|l&(c|u),o=2400959708):(s=c^u^l,o=3395469782);i=(a<<5|a>>>27)+s+h+o+n[r]&4294967295;h=l,l=u,u=4294967295&(c<<30|c>>>2),c=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,s=this.inbuf_;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++r,++s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++r,++s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}();function da(e,t){var n=new fa(e,t);return n.subscribe.bind(n)}var fa=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(n)})).catch((function(e){n.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=pa),void 0===r.error&&(r.error=pa),void 0===r.complete&&(r.complete=pa);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),s},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function pa(){}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var ga=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function ma(e,t){return e+" failed: "+t+" argument "}function ya(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(ma(e,t)+"must be a valid function.")}function _a(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(ma(e,t)+"must be a valid context object.")}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var va=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var s=i-55296;r++,No(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(s<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},wa=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function ba(e,t,n){void 0===t&&(t=1e3),void 0===n&&(n=2);var r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Ia(e){return e&&e._delegate?e._delegate:e}var Ta=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},e}(),Ea="[DEFAULT]",Sa=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Map}return e.prototype.get=function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new Fo;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e))try{this.getOrInitializeService({instanceIdentifier:Ea})}catch(e){}try{for(var r=Eo(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var s=So(i.value,2),o=s[0],a=s[1],c=this.normalizeInstanceIdentifier(o);try{var u=this.getOrInitializeService({instanceIdentifier:c});a.resolve(u)}catch(e){}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}},e.prototype.clearInstance=function(e){void 0===e&&(e=Ea),this.instancesDeferred.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return Io(this,void 0,void 0,(function(){var e;return To(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(Co(Co([],So(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()})))),So(e.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.isInitialized=function(e){return void 0===e&&(e=Ea),this.instances.has(e)},e.prototype.initialize=function(e){var t,n;void 0===e&&(e={});var r=e.options,i=void 0===r?{}:r,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(this.name+"("+s+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var o=this.getOrInitializeService({instanceIdentifier:s,options:i});try{for(var a=Eo(this.instancesDeferred.entries()),c=a.next();!c.done;c=a.next()){var u=So(c.value,2),l=u[0],h=u[1];s===this.normalizeInstanceIdentifier(l)&&h.resolve(o)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return this.invokeOnInitCallbacks(o,s),o},e.prototype.onInit=function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var s=this.instances.get(r);return s&&e(s,r),function(){i.delete(e)}},e.prototype.invokeOnInitCallbacks=function(e,t){var n,r,i=this.onInitCallbacks.get(t);if(i)try{for(var s=Eo(i),o=s.next();!o.done;o=s.next()){var a=o.value;try{a(e,t)}catch(e){}}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},e.prototype.getOrInitializeService=function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,s=this.instances.get(n);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===Ea?void 0:t),options:i}),this.instances.set(n,s),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,s)}catch(e){}return s||null},e.prototype.normalizeInstanceIdentifier=function(e){return void 0===e&&(e=Ea),this.component?this.component.multipleInstances?e:Ea:e},e.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},e}();
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var Ca,ka,Ra=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new Sa(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}(),Na=[];
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(ka||(ka={}));var Aa={debug:ka.DEBUG,verbose:ka.VERBOSE,info:ka.INFO,warn:ka.WARN,error:ka.ERROR,silent:ka.SILENT},Pa=ka.INFO,xa=((Ca={})[ka.DEBUG]="log",Ca[ka.VERBOSE]="log",Ca[ka.INFO]="info",Ca[ka.WARN]="warn",Ca[ka.ERROR]="error",Ca),Da=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString(),s=xa[t];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[s].apply(console,Co(["["+i+"]  "+e.name+":"],n))}},Oa=function(){function e(e){this.name=e,this._logLevel=Pa,this._logHandler=Da,this._userLogHandler=null,Na.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in ka))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?Aa[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Co([this,ka.DEBUG],e)),this._logHandler.apply(this,Co([this,ka.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Co([this,ka.VERBOSE],e)),this._logHandler.apply(this,Co([this,ka.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Co([this,ka.INFO],e)),this._logHandler.apply(this,Co([this,ka.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Co([this,ka.WARN],e)),this._logHandler.apply(this,Co([this,ka.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,Co([this,ka.ERROR],e)),this._logHandler.apply(this,Co([this,ka.ERROR],e))},e}();
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Ma{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const La="@firebase/app-exp",Fa=new Oa("@firebase/app"),Ua="[DEFAULT]",qa={[La]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics-exp":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/auth-exp":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions-exp":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations-exp":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging-exp":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance-exp":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config-exp":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js","firebase-exp":"fire-js-all"},ja=new Map,Va=new Map;function Ba(e,t){try{e.container.addComponent(t)}catch(n){Fa.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function $a(e,t){e.container.addOrOverwriteComponent(t)}function Wa(e){const t=e.name;if(Va.has(t))return Fa.debug(`There were multiple attempts to register component ${t}.`),!1;Va.set(t,e);for(const t of ja.values())Ba(t,e);return!0}function Ka(e,t){return e.container.getProvider(t)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const za=new Yo("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."});
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Ha{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ta("app-exp",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw za.create("app-deleted",{appName:this._name})}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Ga="9.0.0-beta.5";function Qa(e,t={}){if("object"!=typeof t){t={name:t}}const n=Object.assign({name:Ua,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw za.create("bad-app-name",{appName:String(r)});if(ja.has(r))throw za.create("duplicate-app",{appName:r});const i=new Ra(r);for(const e of Va.values())i.addComponent(e);const s=new Ha(e,n,i);return ja.set(r,s),s}async function Ya(e){const t=e.name;ja.has(t)&&(ja.delete(t),await Promise.all(e.container.getProviders().map((e=>e.delete()))),e.isDeleted=!0)}function Ja(e,t,n){var r;let i=null!==(r=qa[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Fa.warn(e.join(" "))}Wa(new Ta(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}function Xa(e,t){if(null!==e&&"function"!=typeof e)throw za.create("invalid-log-argument");!function(e,t){for(var n=function(n){var r=null;t&&t.level&&(r=Aa[t.level]),n.userLogHandler=null===e?null:function(t,n){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var o=i.map((function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((function(e){return e})).join(" ");n>=(null!=r?r:t.logLevel)&&e({level:ka[n].toLowerCase(),message:o,args:i,type:t.name})}},r=0,i=Na;r<i.length;r++)n(i[r])}(e,t)}function Za(e){var t;t=e,Na.forEach((function(e){e.setLogLevel(t)}))}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var ec;Wa(new Ta("platform-logger",(e=>new Ma(e)),"PRIVATE")),Ja(La,"0.0.900-exp.57f19127c",ec),Ja("fire-js","");var tc=Object.freeze({__proto__:null,SDK_VERSION:Ga,_DEFAULT_ENTRY_NAME:Ua,_addComponent:Ba,_addOrOverwriteComponent:$a,_apps:ja,_clearComponents:function(){Va.clear()},_components:Va,_getProvider:Ka,_registerComponent:Wa,_removeServiceInstance:function(e,t,n="[DEFAULT]"){Ka(e,t).clearInstance(n)},deleteApp:Ya,getApp:function(e="[DEFAULT]"){const t=ja.get(e);if(!t)throw za.create("no-app",{appName:e});return t},getApps:function(){return Array.from(ja.values())},initializeApp:Qa,onLog:Xa,registerVersion:Ja,setLogLevel:Za});
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class nc{constructor(e,t){this._delegate=e,this.firebase=t,Ba(e,new Ta("app-compat",(()=>this),"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise((e=>{this._delegate.checkDestroyed(),e()})).then((()=>(this.firebase.INTERNAL.removeApp(this.name),Ya(this._delegate))))}_getService(e,t="[DEFAULT]"){var n;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t="[DEFAULT]"){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Ba(this._delegate,e)}_addOrOverwriteComponent(e){$a(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const rc=new Yo("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."});const ic=
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function e(){const t=
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e){const t={},n={__esModule:!0,initializeApp:function(r,i={}){const s=Qa(r,i),o=new e(s,n);return t[s.name]=o,o},app:r,registerVersion:Ja,setLogLevel:Za,onLog:Xa,apps:null,SDK_VERSION:Ga,INTERNAL:{registerComponent:function(t){const i=t.name,s=i.replace("-compat","");if(Wa(t)&&"PUBLIC"===t.type){const o=(e=r())=>{if("function"!=typeof e[s])throw rc.create("invalid-app-argument",{appName:i});return e[s]()};void 0!==t.serviceProps&&Lo(o,t.serviceProps),n[s]=o,e.prototype[s]=function(...e){return this._getService.bind(this,i).apply(this,t.multipleInstances?e:[])}}return"PUBLIC"===t.type?n[s]:null},removeApp:function(e){delete t[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:tc}};function r(e){if(!ia(t,e=e||Ua))throw rc.create("no-app",{appName:e});return t[e]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(t).map((e=>t[e]))}}),r.App=e,n}(nc);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){Lo(t,e)},createSubscribe:da,ErrorFactory:Yo,deepExtend:Lo}),t}(),sc=new Oa("@firebase/app-compat");
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){sc.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const e=self.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&sc.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const oc=ic;!
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e){Ja("@firebase/app-compat","0.0.900-exp.57f19127c",e)}();
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
oc.registerVersion("firebase-exp","9.0.0-beta.5","app-compat");const ac=
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "useAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"Auth can only be initialized once per app."}},cc=new Yo("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),uc=new Oa("@firebase/auth-exp");function lc(e,...t){uc.logLevel<=ka.ERROR&&uc.error(`Auth (9.0.0-beta.5): ${e}`,...t)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function hc(e,...t){throw fc(e,...t)}function dc(e,...t){return fc(e,...t)}function fc(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return cc.create(e,...t)}function pc(e,t,...n){if(!e)throw fc(t,...n)}function gc(e){const t="INTERNAL ASSERTION FAILED: "+e;throw lc(t),new Error(t)}function mc(e,t){e||gc(t)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const yc=new Map;function _c(e){mc(e instanceof Function,"Expected a class definition");let t=yc.get(e);return t?(mc(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,yc.set(e,t),t)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function vc(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function wc(){return"http:"===bc()||"https:"===bc()}function bc(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Ic{constructor(e,t){this.shortDelay=e,this.longDelay=t,mc(t>e,"Short delay should be less than long delay!"),this.isMobile=jo()||$o()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(wc()||Bo()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Tc(e,t){mc(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Ec{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void gc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void gc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void gc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Sc={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded"},Cc=new Ic(3e4,6e4);
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function kc(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Rc(e,t,n,r,i={}){return Nc(e,i,(()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=ca(Object.assign({key:e.config.apiKey},s)).slice(1),a=new(Ec.headers());return a.set("Content-Type","application/json"),a.set("X-Client-Version",e._getSdkClientVersion()),e.languageCode&&a.set("X-Firebase-Locale",e.languageCode),Ec.fetch()(Pc(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}async function Nc(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Sc),t);try{const t=new xc(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw Dc(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=(i.ok?s.errorMessage:s.error.message).split(" : ")[0];if("FEDERATED_USER_ID_ALREADY_LINKED"===t)throw Dc(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===t)throw Dc(e,"email-already-in-use",s);hc(e,r[t]||t.toLowerCase().replace(/[_\s]+/g,"-"))}}catch(t){if(t instanceof Qo)throw t;hc(e,"network-request-failed")}}async function Ac(e,t,n,r,i={}){const s=await Rc(e,t,n,r,i);return"mfaPendingCredential"in s&&hc(e,"multi-factor-auth-required",{serverResponse:s}),s}function Pc(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?Tc(e.config,i):`${e.config.apiScheme}://${i}`}class xc{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(dc(this.auth,"timeout"))),Cc.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Dc(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=dc(e,t,r);return i.customData._tokenResponse=n,i}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Oc(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function Mc(e){return 1e3*Number(e)}function Lc(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return lc("JWT malformed, contained fewer than 3 sections"),null;try{const e=Oo(n);return e?JSON.parse(e):(lc("Failed to decode base64 JWT payload"),null)}catch(e){return lc("Caught error parsing JWT payload as JSON",e),null}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function Fc(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof Qo&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class Uc{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e.code&&this.schedule(!0))}this.schedule()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class qc{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Oc(this.lastLoginAt),this.creationTime=Oc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function jc(e){var t;const n=e.auth,r=await e.getIdToken(),i=await Fc(e,async function(e,t){return Rc(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));pc(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=bo(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[];const a=(c=e.providerData,u=o,[...c.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var c,u;const l=e.isAnonymous,h=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!l&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new qc(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Vc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){pc(e.idToken,"internal-error"),pc(void 0!==e.idToken,"internal-error"),pc(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=Lc(e);return pc(t,"internal-error"),pc(void 0!==t.exp,"internal-error"),pc(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return pc(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(e,t){const n=await Nc(e,{},(()=>{const n=ca({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=Pc(e,r,"/v1/token",`key=${i}`);return Ec.fetch()(s,{method:"POST",headers:{"X-Client-Version":e._getSdkClientVersion(),"Content-Type":"application/x-www-form-urlencoded"},body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Vc;return n&&(pc("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(pc("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(pc("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Vc,this.toJSON())}_performRefresh(){return gc("not implemented")}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Bc(e,t){pc("string"==typeof e||void 0===e,"internal-error",{appName:t})}class $c{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=bo(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new Uc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.metadata=new qc(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Fc(this,this.stsTokenManager.getToken(this.auth,e));return pc(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=Ia(e),r=await n.getIdToken(t),i=Lc(r);pc(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Oc(Mc(i.auth_time)),issuedAtTime:Oc(Mc(i.iat)),expirationTime:Oc(Mc(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Ia(e);await jc(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(pc(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new $c(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){pc(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await jc(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Fc(this,async function(e,t){return Rc(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,c,u;const l=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:_,emailVerified:v,isAnonymous:w,providerData:b,stsTokenManager:I}=t;pc(_&&I,e,"internal-error");const T=Vc.fromJSON(this.name,I);pc("string"==typeof _,e,"internal-error"),Bc(l,e.name),Bc(h,e.name),pc("boolean"==typeof v,e,"internal-error"),pc("boolean"==typeof w,e,"internal-error"),Bc(d,e.name),Bc(f,e.name),Bc(p,e.name),Bc(g,e.name),Bc(m,e.name),Bc(y,e.name);const E=new $c({uid:_,auth:e,email:h,emailVerified:v,displayName:l,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:T,createdAt:m,lastLoginAt:y});return b&&Array.isArray(b)&&(E.providerData=b.map((e=>Object.assign({},e)))),g&&(E._redirectEventId=g),E}static async _fromIdTokenResponse(e,t,n=!1){const r=new Vc;r.updateFromServerResponse(t);const i=new $c({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await jc(i),i}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Wc{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Wc.type="NONE";const Kc=Wc;
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function zc(e,t,n){return`firebase:${e}:${t}:${n}`}class Hc{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=zc(this.userKey,r.apiKey,i),this.fullPersistenceKey=zc("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?$c._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Hc(_c(Kc),e,n);let r=_c(Kc);for(const e of t)if(await e._isAvailable()){r=e;break}let i=null;const s=zc(n,e.config.apiKey,e.name);for(const n of t)try{const t=await n._get(s);if(t){const s=$c._fromJSON(e,t);n!==r&&(i=s);break}}catch(e){}return i&&await r._set(s,i.toJSON()),await Promise.all(t.map((async e=>{if(e!==r)try{await e._remove(s)}catch(e){}}))),new Hc(r,e,n)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Gc(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Xc(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Qc(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(eu(t))return"Blackberry";if(tu(t))return"Webos";if(Yc(t))return"Safari";if((t.includes("chrome/")||Jc(t))&&!t.includes("edge/"))return"Chrome";if(Zc(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Qc(e=qo()){return/firefox\//i.test(e)}function Yc(e=qo()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Jc(e=qo()){return/crios\//i.test(e)}function Xc(e=qo()){return/iemobile/i.test(e)}function Zc(e=qo()){return/android/i.test(e)}function eu(e=qo()){return/blackberry/i.test(e)}function tu(e=qo()){return/webos/i.test(e)}function nu(e=qo()){return/iphone|ipad|ipod/i.test(e)}function ru(e=qo()){return nu(e)||Zc(e)||tu(e)||eu(e)||/windows phone/i.test(e)||Xc(e)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function iu(e,t=[]){let n;switch(e){case"Browser":n=Gc(qo());break;case"Worker":n=`${Gc(qo())}-${e}`;break;default:n=e}return`${n}/JsCore/9.0.0-beta.5/${t.length?t.join(","):"FirebaseCore-web"}`}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class su{constructor(e,t){this.app=e,this.config=t,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new au(this),this.idTokenSubscription=new au(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.redirectInitializerError=null,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cc,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=t.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=_c(t)),this._initializationPromise=this.queue((async()=>{var n;this._deleted||(this.persistenceManager=await Hc.create(this,e),this._deleted||((null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)&&await this._popupRedirectResolver._initialize(this),await this.initializeCurrentUser(t),this._deleted||(this._isInitialized=!0)))})),this._initializationPromise.then((()=>{if(this.redirectInitializerError)throw this.redirectInitializerError}))}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e):void 0}async initializeCurrentUser(e){var t;let n=await this.assertedPersistence.getCurrentUser();if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,i=null==n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(e);r&&r!==i||!(null==s?void 0:s.user)||(n=s.user)}return n?n._redirectEventId?(pc(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){this.redirectInitializerError=e,await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await jc(e)}catch(e){if("auth/network-request-failed"!==e.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?Ia(e):null;return t&&pc(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){if(!this._deleted)return e&&pc(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(_c(e))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Yo("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&_c(e)||this._popupRedirectResolver;pc(t,this,"argument-error"),this.redirectPersistenceManager=await Hc.create(this,[_c(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return pc(s,this,"internal-error"),s.then((()=>i(this.currentUser))),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return pc(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=iu(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getSdkClientVersion(){return this.clientVersion}}function ou(e){return Ia(e)}class au{constructor(e){this.auth=e,this.observer=null,this.addObserver=da((e=>this.observer=e))}get next(){return pc(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function cu(e,t,n){const r=ou(e);pc(r._canInitEmulator,r,"emulator-config-failed"),pc(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null==n?void 0:n.disableWarnings),s=uu(t),{host:o,port:a}=function(e){const t=uu(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:lu(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:lu(t)}}}(t),c=null===a?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),function(e){function t(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"==typeof window||"undefined"==typeof document||e||("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(i)}function uu(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function lu(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class hu{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return gc("not implemented")}_getIdTokenResponse(e){return gc("not implemented")}_linkToIdToken(e,t){return gc("not implemented")}_getReauthenticationResolver(e){return gc("not implemented")}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function du(e,t){return Rc(e,"POST","/v1/accounts:resetPassword",kc(e,t))}async function fu(e,t){return Rc(e,"POST","/v1/accounts:update",t)}async function pu(e,t){return Rc(e,"POST","/v1/accounts:sendOobCode",kc(e,t))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class gu extends hu{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new gu(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new gu(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
return async function(e,t){return Ac(e,"POST","/v1/accounts:signInWithPassword",kc(e,t))}(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
return async function(e,t){return Ac(e,"POST","/v1/accounts:signInWithEmailLink",kc(e,t))}(e,{email:this._email,oobCode:this._password});default:hc(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return fu(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return Ac(e,"POST","/v1/accounts:signInWithEmailLink",kc(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:hc(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function mu(e,t){return Ac(e,"POST","/v1/accounts:signInWithIdp",kc(e,t))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class yu extends hu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new yu(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):hc("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=bo(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new yu(n,r);return Object.assign(s,i),s}_getIdTokenResponse(e){return mu(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,mu(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,mu(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ca(t)}return e}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const _u={USER_NOT_FOUND:"user-not-found"};
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class vu extends hu{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new vu({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new vu({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Ac(e,"POST","/v1/accounts:signInWithPhoneNumber",kc(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Ac(e,"POST","/v1/accounts:signInWithPhoneNumber",kc(e,t));if(n.temporaryProof)throw Dc(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Ac(e,"POST","/v1/accounts:signInWithPhoneNumber",kc(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),_u)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new vu({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class wu{constructor(e){var t,n,r,i,s,o;const a=ua(la(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,l=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);pc(c&&u&&l,"argument-error"),this.apiKey=c,this.operation=l,this.code=u,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=ua(la(e)).link,n=t?ua(la(t)).deep_link_id:null,r=ua(la(e)).deep_link_id;return(r?ua(la(r)).link:null)||r||n||t||e}(e);try{return new wu(t)}catch(e){return null}}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class bu{constructor(){this.providerId=bu.PROVIDER_ID}static credential(e,t){return gu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=wu.parseLink(t);return pc(n,"argument-error"),gu._fromEmailAndCode(e,n.code,n.tenantId)}}bu.PROVIDER_ID="password",bu.EMAIL_PASSWORD_SIGN_IN_METHOD="password",bu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Iu{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Tu extends Iu{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Eu extends Tu{static credentialFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;return pc("providerId"in t&&"signInMethod"in t,"argument-error"),yu._fromParams(t)}credential(e){return this._credential(e)}_credential(e){return pc(e.idToken||e.accessToken,"argument-error"),yu._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Eu.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Eu.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:r,pendingToken:i,nonce:s,providerId:o}=e;if(!(n||r||t||i))return null;if(!o)return null;try{return new Eu(o)._credential({idToken:t,accessToken:n,rawNonce:s,pendingToken:i})}catch(e){return null}}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Su extends Tu{constructor(){super("facebook.com")}static credential(e){return yu._fromParams({providerId:Su.PROVIDER_ID,signInMethod:Su.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Su.credentialFromTaggedObject(e)}static credentialFromError(e){return Su.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Su.credential(e.oauthAccessToken)}catch(e){return null}}}Su.FACEBOOK_SIGN_IN_METHOD="facebook.com",Su.PROVIDER_ID="facebook.com";
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Cu extends Tu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return yu._fromParams({providerId:Cu.PROVIDER_ID,signInMethod:Cu.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Cu.credentialFromTaggedObject(e)}static credentialFromError(e){return Cu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Cu.credential(t,n)}catch(e){return null}}}Cu.GOOGLE_SIGN_IN_METHOD="google.com",Cu.PROVIDER_ID="google.com";
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class ku extends Tu{constructor(){super("github.com")}static credential(e){return yu._fromParams({providerId:ku.PROVIDER_ID,signInMethod:ku.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ku.credentialFromTaggedObject(e)}static credentialFromError(e){return ku.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return ku.credential(e.oauthAccessToken)}catch(e){return null}}}ku.GITHUB_SIGN_IN_METHOD="github.com",ku.PROVIDER_ID="github.com";class Ru extends hu{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return mu(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,mu(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,mu(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,pendingToken:i}=t;return n&&r&&i&&n===r?new Ru(n,i):null}static _create(e,t){return new Ru(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Nu extends Tu{constructor(){super("twitter.com")}static credential(e,t){return yu._fromParams({providerId:Nu.PROVIDER_ID,signInMethod:Nu.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Nu.credentialFromTaggedObject(e)}static credentialFromError(e){return Nu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Nu.credential(t,n)}catch(e){return null}}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function Au(e,t){return Ac(e,"POST","/v1/accounts:signUp",kc(e,t))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */Nu.TWITTER_SIGN_IN_METHOD="twitter.com",Nu.PROVIDER_ID="twitter.com";class Pu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await $c._fromIdTokenResponse(e,n,r),s=xu(n);return new Pu({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=xu(n);return new Pu({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function xu(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Du extends Qo{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,this.name="FirebaseError",Object.setPrototypeOf(this,Du.prototype),this.appName=e.name,this.code=t.code,this.tenantId=null!==(i=e.tenantId)&&void 0!==i?i:void 0,this.serverResponse=t.customData.serverResponse}static _fromErrorAndOperation(e,t,n,r){return new Du(e,t,n,r)}}function Ou(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Du._fromErrorAndOperation(e,n,t,r);throw n}))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Mu(e){return new Set(e.map((({providerId:e})=>e)).filter((e=>!!e)))}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function Lu(e,t){const n=Ia(e);await Uu(!0,n,t);const{providerUserInfo:r}=await async function(e,t){return Rc(e,"POST","/v1/accounts:update",t)}(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),i=Mu(r||[]);return n.providerData=n.providerData.filter((e=>i.has(e.providerId))),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function Fu(e,t,n=!1){const r=await Fc(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Pu._forOperation(e,"link",r)}async function Uu(e,t,n){await jc(t);const r=!1===e?"provider-already-linked":"no-such-provider";pc(Mu(t.providerData).has(n)===e,t.auth,r)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function qu(e,t,n=!1){const{auth:r}=e,i="reauthenticate";try{const s=await Fc(e,Ou(r,i,t,e),n);pc(s.idToken,r,"internal-error");const o=Lc(s.idToken);pc(o,r,"internal-error");const{sub:a}=o;return pc(e.uid===a,r,"user-mismatch"),Pu._forOperation(e,i,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&hc(r,"user-mismatch"),e}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function ju(e,t,n=!1){const r="signIn",i=await Ou(e,r,t),s=await Pu._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function Vu(e,t){return ju(ou(e),t)}async function Bu(e,t){const n=Ia(e);return await Uu(!1,n,t.providerId),Fu(n,t)}async function $u(e,t){return qu(Ia(e),t)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function Wu(e,t){const n=ou(e),r=await async function(e,t){return Ac(e,"POST","/v1/accounts:signInWithCustomToken",kc(e,t))}(n,{token:t,returnSecureToken:!0}),i=await Pu._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Ku{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?zu._fromServerResponse(e,t):hc(e,"internal-error")}}class zu extends Ku{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new zu(t)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Hu(e,t,n){var r;pc((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),pc(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(pc(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iosBundleId=n.iOS.bundleId),n.android&&(pc(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function Gu(e,t,n){const r=Ia(e),i={requestType:"PASSWORD_RESET",email:t};n&&Hu(r,i,n),await async function(e,t){return pu(e,t)}(r,i)}async function Qu(e,t){await async function(e,t){return Rc(e,"POST","/v1/accounts:update",kc(e,t))}(Ia(e),{oobCode:t})}async function Yu(e,t){const n=Ia(e),r=await du(n,{oobCode:t}),i=r.requestType;switch(pc(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":pc(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":pc(r.mfaInfo,n,"internal-error");default:pc(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=Ku._fromServerResponse(ou(n),r.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.newEmail:r.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function Ju(e,t,n){const r=Ia(e),i={requestType:"EMAIL_SIGNIN",email:t};pc(n.handleCodeInApp,r,"argument-error"),n&&Hu(r,i,n),await async function(e,t){return pu(e,t)}(r,i)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function Xu(e,t){const n={identifier:t,continueUri:wc()?vc():"http://localhost"},{signinMethods:r}=await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(e,t){return Rc(e,"POST","/v1/accounts:createAuthUri",kc(e,t))}(Ia(e),n);return r||[]}async function Zu(e,t){const n=Ia(e),r={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&Hu(n.auth,r,t);const{email:i}=await async function(e,t){return pu(e,t)}(n.auth,r);i!==e.email&&await e.reload()}async function el(e,t,n){const r=Ia(e),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&Hu(r.auth,i,n);const{email:s}=await async function(e,t){return pu(e,t)}(r.auth,i);s!==e.email&&await e.reload()}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function tl(e,{displayName:t,photoURL:n}){if(void 0===t&&void 0===n)return;const r=Ia(e),i={idToken:await r.getIdToken(),displayName:t,photoUrl:n,returnSecureToken:!0},s=await Fc(r,async function(e,t){return Rc(e,"POST","/v1/accounts:update",t)}(r.auth,i));r.displayName=s.displayName||null,r.photoURL=s.photoUrl||null;const o=r.providerData.find((({providerId:e})=>"password"===e));o&&(o.displayName=r.displayName,o.photoURL=r.photoURL),await r._updateTokensIfNecessary(s)}async function nl(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const s=await Fc(e,fu(r,i));await e._updateTokensIfNecessary(s,!0)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class rl{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class il extends rl{constructor(e,t,n,r){super(e,t,n),this.username=r}}class sl extends rl{constructor(e,t){super(e,"facebook.com",t)}}class ol extends il{constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class al extends rl{constructor(e,t){super(e,"google.com",t)}}class cl extends il{constructor(e,t,n){super(e,"twitter.com",t,n)}}function ul(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;const{providerId:r}=e,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null==e?void 0:e.idToken)){const r=null===(n=null===(t=Lc(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(r)return new rl(s,"anonymous"!==r&&"custom"!==r?r:null)}if(!r)return null;switch(r){case"facebook.com":return new sl(s,i);case"github.com":return new ol(s,i);case"google.com":return new al(s,i);case"twitter.com":return new cl(s,i,e.screenName||null);case"custom":case"anonymous":return new rl(s,null);default:return new rl(s,r,i)}}(n)}class ll{constructor(e,t){this.type=e,this.credential=t}static _fromIdtoken(e){return new ll("enroll",e)}static _fromMfaPendingCredential(e){return new ll("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(null==e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return ll._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return ll._fromIdtoken(e.multiFactorSession.idToken)}return null}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class hl{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=ou(e),r=(t.serverResponse.mfaInfo||[]).map((e=>Ku._fromServerResponse(n,e)));pc(t.serverResponse.mfaPendingCredential,n,"internal-error");const i=ll._fromMfaPendingCredential(t.serverResponse.mfaPendingCredential);return new hl(i,r,(async e=>{const r=await e._process(n,i);delete t.serverResponse.mfaInfo,delete t.serverResponse.mfaPendingCredential;const s=Object.assign(Object.assign({},t.serverResponse),{idToken:r.idToken,refreshToken:r.refreshToken});switch(t.operationType){case"signIn":const e=await Pu._fromIdTokenResponse(n,t.operationType,s);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return pc(t.user,n,"internal-error"),Pu._forOperation(t.user,t.operationType,s);default:hc(n,"internal-error")}}))}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}class dl{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload((t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map((t=>Ku._fromServerResponse(e.auth,t))))}))}static _fromUser(e){return new dl(e)}async getSession(){return ll._fromIdtoken(await this.user.getIdToken())}async enroll(e,t){const n=e,r=await this.getSession(),i=await Fc(this.user,n._process(this.user.auth,r,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t="string"==typeof e?e:e.uid,n=await this.user.getIdToken(),r=await Fc(this.user,(i=this.user.auth,s={idToken:n,mfaEnrollmentId:t},Rc(i,"POST","/v2/accounts/mfaEnrollment:withdraw",Object.assign({tenantId:i.tenantId},s))));var i,s;this.enrolledFactors=this.enrolledFactors.filter((({uid:e})=>e!==t)),await this.user._updateTokensIfNecessary(r);try{await this.user.reload()}catch(e){if("auth/user-token-expired"!==e.code)throw e}}}const fl=new WeakMap;
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class pl{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){pc(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const gl="__sak";
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ml{constructor(e,t){this.storage=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(gl,"1"),this.storage.removeItem(gl),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class yl extends ml{constructor(){super(window.localStorage,"LOCAL"),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=qo();return Yc(e)||nu(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=ru(),this.boundEventHandler=this.onStorageEvent.bind(this)}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);Wo()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}yl.type="LOCAL";const _l=yl;
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class vl{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new vl(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}vl.receivers=[];class wl{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e="",t=20){return`${e}${Math.floor(Math.random()*Math.pow(10,t))}`}();r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function bl(){return window}
/**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Il(){return void 0!==bl().WorkerGlobalScope&&"function"==typeof bl().importScripts}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Tl="firebaseLocalStorageDb",El="firebaseLocalStorage",Sl="fbase_key";class Cl{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function kl(e,t){return e.transaction([El],t?"readwrite":"readonly").objectStore(El)}function Rl(){const e=indexedDB.open(Tl,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(El,{keyPath:Sl})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;if(!n.objectStoreNames.contains(El))return await function(){const e=indexedDB.deleteDatabase(Tl);return new Cl(e).toPromise()}(),Rl();t(n)}))}))}async function Nl(e,t,n){const r=kl(e,!0).put({[Sl]:t,value:n});return new Cl(r).toPromise()}function Al(e,t){const n=kl(e,!0).delete(t);return new Cl(n).toPromise()}class Pl{constructor(){this.type="LOCAL",this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Rl()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Il()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=vl._getInstance(Il()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new wl(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Rl();return await Nl(e,gl,"1"),await Al(e,gl),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Nl(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=kl(e,!1).get(t),r=await new Cl(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Al(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=kl(e,!1).getAll();return new Cl(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Pl.type="LOCAL";const xl=Pl;
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Dl{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ml(e);default:return!1}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Ml(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(dc(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ol(e))}saveEventToCache(e){this.cachedEventUids.add(Ol(e)),this.lastProcessedEventTime=Date.now()}}function Ol(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Ml({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}function Ll(e){return`${e||""}${Math.floor(1e9*Math.random())}`}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Fl=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ul=/^https?/;async function ql(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Rc(e,"GET","/v1/projects",{})}(e);for(const e of t)try{if(jl(e))return}catch(e){}hc(e,"unauthorized-domain")}function jl(e){const t=vc(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Ul.test(n))return!1;if(Fl.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Vl(e){return new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=n,r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function Bl(e){return`__${e}${Math.floor(1e6*Math.random())}`}
/**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const $l=new Ic(3e4,6e4);function Wl(){const e=bl().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let Kl=null;function zl(e){return Kl=Kl||function(e){return new Promise(((t,n)=>{var r,i,s;function o(){Wl(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Wl(),n(dc(e,"network-request-failed"))},timeout:$l.get()})}if(null===(i=null===(r=bl().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=bl().gapi)||void 0===s?void 0:s.load)){const t=Bl("iframefcb");return bl()[t]=()=>{gapi.load?o():n(dc(e,"network-request-failed"))},Vl(`https://apis.google.com/js/api.js?onload=${t}`)}o()}})).catch((e=>{throw Kl=null,e}))}(e),Kl}
/**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Hl=new Ic(5e3,15e3),Gl={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},Ql=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Yl(e){const t=e.config;pc(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Tc(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:Ga},i=Ql.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${ca(r).slice(1)}`}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Jl extends ml{constructor(){super(window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Jl.type="SESSION";const Xl=Jl,Zl={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};
/**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class eh{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function th(e,t,n,r=500,i=600){const s=Math.min((window.screen.availHeight-i)/2,0).toString(),o=Math.min((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},Zl),{width:r.toString(),height:i.toString(),top:s,left:o}),u=qo().toLowerCase();n&&(a=Jc(u)?"_blank":n),Qc(u)&&(t=t||"http://localhost",c.scrollbars="yes");const l=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=qo()){var t;return nu(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(u)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t||"",a),new eh(null);const h=window.open(t||"",a,l);pc(h,e,"popup-blocked");try{h.focus()}catch(e){}return new eh(h)}function nh(e,t){return t?_c(t):(pc(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class rh extends hu{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return mu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return mu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return mu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ih(e){return ju(e.auth,new rh(e),e.bypassAuthState)}function sh(e){const{auth:t,user:n}=e;return pc(n,t,"internal-error"),qu(n,new rh(e),e.bypassAuthState)}async function oh(e){const{auth:t,user:n}=e;return pc(n,t,"internal-error"),Fu(n,new rh(e),e.bypassAuthState)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ah{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ih;case"linkViaPopup":case"linkViaRedirect":return oh;case"reauthViaPopup":case"reauthViaRedirect":return sh;default:hc(this.auth,"internal-error")}}resolve(e){mc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){mc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const ch=new Map;class uh extends ah{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=ch.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=dh(t),r="true"===await hh(e)._get(n);return await hh(e)._remove(n),r}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}ch.set(this.auth._key(),e)}return e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function lh(e,t){return hh(e)._set(dh(t),"true")}function hh(e){return _c(e._redirectPersistence)}function dh(e){return zc("pendingRedirect",e.config.apiKey,e.name)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function fh(e,t,n){return async function(e,t,n){const r=ou(e);pc(t instanceof Iu,e,"argument-error");const i=nh(r,n);return await lh(i,r),i._openRedirect(r,t,"signInViaRedirect")}(e,t,n)}function ph(e,t,n){return async function(e,t,n){const r=Ia(e);pc(t instanceof Iu,r.auth,"argument-error");const i=nh(r.auth,n);await lh(i,r.auth);const s=await yh(r);return i._openRedirect(r.auth,t,"reauthViaRedirect",s)}(e,t,n)}function gh(e,t,n){return async function(e,t,n){const r=Ia(e);pc(t instanceof Iu,r.auth,"argument-error");const i=nh(r.auth,n);await Uu(!1,r,t.providerId),await lh(i,r.auth);const s=await yh(r);return i._openRedirect(r.auth,t,"linkViaRedirect",s)}(e,t,n)}async function mh(e,t,n=!1){const r=ou(e),i=nh(r,t),s=new uh(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}async function yh(e){const t=Ll(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const _h="__/auth/handler",vh="emulator/auth/handler";function wh(e,t,n,r,i,s){pc(e.config.authDomain,e,"auth-domain-config-required"),pc(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Ga,eventId:i};if(t instanceof Iu){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",oa(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof Tu){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/${_h}`;return Tc(e,vh)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e)}?${ca(a).slice(1)}`}const bh="webStorageSupport";const Ih=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Xl,this._completeRedirectFn=mh}async _openPopup(e,t,n,r){var i;mc(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return th(e,wh(e,t,n,vc(),r),Ll())}async _openRedirect(e,t,n,r){var i;return await this._originValidation(e),i=wh(e,t,n,vc(),r),bl().location.href=i,new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(mc(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n}async initAndGetManager(e){const t=await async function(e){const t=await zl(e),n=bl().gapi;return pc(n,e,"internal-error"),t.open({where:document.body,url:Yl(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Gl,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=dc(e,"network-request-failed"),s=bl().setTimeout((()=>{r(i)}),Hl.get());function o(){bl().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}(e),n=new Dl(e);return t.register("authEvent",(t=>{pc(null==t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(bh,{type:bh},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==i&&t(!!i),hc(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ql(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ru()||Yc()||nu()}},Th="facebook.com",Eh="github.com",Sh="google.com",Ch="password",kh="twitter.com",Rh="EMAIL_SIGNIN",Nh="PASSWORD_RESET",Ah="RECOVER_EMAIL",Ph="REVERT_SECOND_FACTOR_ADDITION",xh="VERIFY_AND_CHANGE_EMAIL",Dh="VERIFY_EMAIL";
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Oh=1e12;class Mh{constructor(e){this.auth=e,this.counter=Oh,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new Lh(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||Oh;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||Oh;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||Oh;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class Lh{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r="string"==typeof e?document.getElementById(e):e;pc(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(e){}this.timerId=window.setTimeout((()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(e){}this.isVisible&&this.execute()}),6e4)}),500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Fh=Bl("rcb"),Uh=new Ic(3e4,6e4);class qh{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!bl().grecaptcha}load(e,t=""){return pc(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)?Promise.resolve(bl().grecaptcha):new Promise(((n,r)=>{const i=bl().setTimeout((()=>{r(dc(e,"network-request-failed"))}),Uh.get());bl()[Fh]=()=>{bl().clearTimeout(i),delete bl()[Fh];const s=bl().grecaptcha;if(!s)return void r(dc(e,"internal-error"));const o=s.render;s.render=(e,t)=>{const n=o(e,t);return this.counter++,n},this.hostLanguage=t,n(s)};Vl(`https://www.google.com/recaptcha/api.js??${ca({onload:Fh,render:"explicit",hl:t})}`).catch((()=>{clearTimeout(i),r(dc(e,"internal-error"))}))}))}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!bl().grecaptcha&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class jh{async load(e){return new Mh(e)}clearedOneInstance(){}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Vh="recaptcha",Bh={theme:"light",type:"image"};class $h{constructor(e,t=Object.assign({},Bh),n){this.parameters=t,this.type=Vh,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=ou(n),this.isInvisible="invisible"===this.parameters.size,pc("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const r="string"==typeof e?document.getElementById(e):e;pc(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new jh:new qh,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise((n=>{const r=e=>{e&&(this.tokenChangeListeners.delete(r),n(e))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)}))}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((e=>{throw this.renderPromise=null,e}))),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((e=>{this.container.removeChild(e)}))}validateStartingState(){pc(!this.parameters.sitekey,this.auth,"argument-error"),pc(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),pc("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach((e=>e(t))),"function"==typeof e)e(t);else if("string"==typeof e){const n=bl()[e];"function"==typeof n&&n(t)}}}assertNotDestroyed(){pc(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){pc(wc()&&!Il(),this.auth,"internal-error"),await function(){let e=null;return new Promise((t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()})).catch((t=>{throw e&&window.removeEventListener("load",e),t}))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(e){return(await Rc(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);pc(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return pc(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Wh{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=vu._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function Kh(e,t,n){var r;const i=await n.verify();try{let s;if(pc("string"==typeof i,e,"argument-error"),pc(n.type===Vh,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){pc("enroll"===t.type,e,"internal-error");return(await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e,t){return Rc(e,"POST","/v2/accounts/mfaEnrollment:start",Object.assign({tenantId:e.tenantId},t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo}{pc("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;pc(n,e,"missing-multi-factor-info");return(await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e,t){return Rc(e,"POST","/v2/accounts/mfaSignIn:start",Object.assign({tenantId:e.tenantId},t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Rc(e,"POST","/v1/accounts:sendVerificationCode",kc(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class zh{constructor(e){this.providerId=zh.PROVIDER_ID,this.auth=ou(e)}verifyPhoneNumber(e,t){return Kh(this.auth,e,Ia(t))}static credential(e,t){return vu._fromVerification(e,t)}static credentialFromResult(e){const t=e;return zh.credentialFromTaggedObject(t)}static credentialFromError(e){return zh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?vu._fromTokenResponse(t,n):null}}zh.PROVIDER_ID="phone",zh.PHONE_SIGN_IN_METHOD="phone";
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Hh=new Ic(2e3,1e4);class Gh extends ah{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Gh.currentPopupAction&&Gh.currentPopupAction.cancel(),Gh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return pc(e,this.auth,"internal-error"),e}async onExecution(){mc(1===this.filter.length,"Popup operations only handle one event");const e=Ll();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(dc(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(dc(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Gh.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(dc(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(e,Hh.get())};e()}}Gh.currentPopupAction=null;class Qh extends class{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return gc("unexpected MultiFactorSessionType")}}}{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Qh(e)}_finalizeEnroll(e,t,n){return function(e,t){return Rc(e,"POST","/v2/accounts/mfaEnrollment:finalize",Object.assign({tenantId:e.tenantId},t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return function(e,t){return Rc(e,"POST","/v2/accounts/mfaSignIn:finalize",Object.assign({tenantId:e.tenantId},t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class Yh{constructor(){}static assertion(e){return Qh._fromCredential(e)}}var Jh;
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Xh(){return window}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */Jh="Browser",Wa(new Ta("auth-exp",((e,{options:t})=>{const n=e.getProvider("app-exp").getImmediate(),{apiKey:r,authDomain:i}=n.options;return(e=>{pc(r&&!r.includes(":"),"invalid-api-key",{appName:e.name}),pc(!(null==i?void 0:i.includes(":")),"argument-error",{appName:e.name});const n={apiKey:r,authDomain:i,clientPlatform:Jh,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:iu(Jh)},s=new su(e,n);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(_c);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(s,t),s})(n)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),Wa(new Ta("auth-internal",(e=>(e=>new pl(e))(ou(e.getProvider("auth-exp").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Ja("@firebase/auth-exp","0.0.900-exp.57f19127c",function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Jh));async function Zh(e,t,n){var r;const{BuildInfo:i}=Xh();mc(t.sessionId,"AuthEvent did not contain a session ID");const s=await async function(e){const t=function(e){if(mc(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return n}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(t.sessionId),o={};return nu()?o.ibi=i.packageName:Zc()?o.apn=i.packageName:hc(e,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,wh(e,n,t.type,void 0,null!==(r=t.eventId)&&void 0!==r?r:void 0,o)}function ed(e){const{cordova:t}=Xh();return new Promise((n=>{t.plugins.browsertab.isAvailable((r=>{let i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,function(e=qo()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}()?"_blank":"_system","location=yes"),n(i)}))}))}class td extends Dl{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise((e=>{this.resolveInialized=e}))}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach((t=>t(e))),super.onEvent(e)}async initialized(){await this.initPromise}}async function nd(e){const t=await sd()._get(od(e));return t&&await sd()._remove(od(e)),t}function rd(e,t){var n,r;const i=function(e){const t=ad(e),n=t.link?decodeURIComponent(t.link):void 0,r=ad(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return ad(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){const t=ad(i),s=t.firebaseError?function(e){try{return JSON.parse(e)}catch(e){return null}}(decodeURIComponent(t.firebaseError)):null,o=null===(r=null===(n=null==s?void 0:s.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],a=o?dc(o):null;return a?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:a,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function id(){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<20;n++){const n=Math.floor(Math.random()*t.length);e.push(t.charAt(n))}return e.join("")}function sd(){return _c(_l)}function od(e){return zc("authEvent",e.config.apiKey,e.name)}function ad(e){if(!(null==e?void 0:e.includes("?")))return{};const[t,...n]=e.split("?");return ua(n.join("?"))}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const cd=class{constructor(){this._redirectPersistence=Xl,this._shouldInitProactively=!0,this.eventManagers=new Map,this._completeRedirectFn=mh}async _initialize(e){const t=e._key();let n=this.eventManagers.get(t);return n||(n=new td(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){hc(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,r){!function(e){var t,n,r,i,s,o,a,c,u,l;const h=Xh();pc("function"==typeof(null===(t=null==h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),pc(void 0!==(null===(n=null==h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),pc("function"==typeof(null===(s=null===(i=null===(r=null==h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===s?void 0:s.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),pc("function"==typeof(null===(c=null===(a=null===(o=null==h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===a?void 0:a.browsertab)||void 0===c?void 0:c.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),pc("function"==typeof(null===(l=null===(u=null==h?void 0:h.cordova)||void 0===u?void 0:u.InAppBrowser)||void 0===l?void 0:l.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),ch.clear();const s=function(e,t,n=null){return{type:t,eventId:n,urlResponse:null,sessionId:id(),postBody:null,tenantId:e.tenantId,error:dc(e,"no-auth-event")}}(e,n,r);await function(e,t){return sd()._set(od(e),t)}(e,s);const o=await Zh(e,s,t);return async function(e,t,n){const{cordova:r}=Xh();let i=()=>{};try{await new Promise(((s,o)=>{let a=null;function c(){var e;s();const t=null===(e=r.plugins.browsertab)||void 0===e?void 0:e.close;"function"==typeof t&&t(),"function"==typeof(null==n?void 0:n.close)&&n.close()}function u(){a||(a=window.setTimeout((()=>{o(dc(e,"redirect-cancelled-by-user"))}),2e3))}function l(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&u()}t.addPassiveListener(c),document.addEventListener("resume",u,!1),Zc()&&document.addEventListener("visibilitychange",l,!1),i=()=>{t.removePassiveListener(c),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",l,!1),a&&window.clearTimeout(a)}}))}finally{i()}}(e,i,await ed(o))}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(){return Promise.resolve()}attachCallbackListeners(e,t){const{universalLinks:n,handleOpenURL:r,BuildInfo:i}=Xh(),s=setTimeout((async()=>{await nd(e),t.onEvent(ud())}),500),o=async n=>{clearTimeout(s);const r=await nd(e);let i=null;r&&(null==n?void 0:n.url)&&(i=rd(r,n.url)),t.onEvent(i||ud())};void 0!==n&&"function"==typeof n.subscribe&&n.subscribe(null,o);const a=r,c=`${i.packageName.toLowerCase()}://`;Xh().handleOpenURL=async e=>{if(e.toLowerCase().startsWith(c)&&o({url:e}),"function"==typeof a)try{a(e)}catch(e){console.error(e)}}}};function ud(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:dc("no-auth-event")}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function ld(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function hd(e=qo()){return!("file:"!==ld()&&"ionic:"!==ld()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function dd(e=qo()){return Wo()&&11===(null===document||void 0===document?void 0:document.documentMode)||function(e=qo()){return/Edge\/\d+/.test(e)}(e)}function fd(){try{const e=self.localStorage,t=Ll();if(e)return e.setItem(t,"1"),e.removeItem(t),!dd()||zo()}catch(e){return pd()&&zo()}return!1}function pd(){return"undefined"!=typeof global&&"WorkerGlobalScope"in global&&"importScripts"in global}function gd(){return("http:"===ld()||"https:"===ld()||Bo()||hd())&&!($o()||Vo())&&fd()&&!pd()}function md(){return hd()&&"undefined"!=typeof document}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const yd={LOCAL:"local",NONE:"none",SESSION:"session"},_d=pc,vd="persistence";async function wd(e){await e._initializationPromise;const t=bd(),n=zc(vd,e.config.apiKey,e.name);(null==t?void 0:t.sessionStorage)&&t.sessionStorage.setItem(n,e._getPersistence())}function bd(){return"undefined"!=typeof window?window:null}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Id=pc,Td=_c(Ih),Ed=_c(cd);class Sd{constructor(){this.underlyingResolver=null,this._redirectPersistence=Xl,this._completeRedirectFn=mh}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,r)}async _openRedirect(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,r)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return md()||Td._shouldInitProactively}get assertedUnderlyingResolver(){return Id(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await async function(){return!!md()&&new Promise((e=>{const t=setTimeout((()=>{e(!1)}),1e3);document.addEventListener("deviceready",(()=>{clearTimeout(t),e(!0)}))}))}();this.underlyingResolver=e?Ed:Td}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Cd(e,t){var n;const r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===t.code){t.resolver=new Ad(e,function(e,t){var n;const r=Ia(e),i=t;return pc(t.operationType,r,"argument-error"),pc(null===(n=i.serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),hl._fromError(r,i)}(e,t))}else if(r){const e=kd(t),n=t;e&&(n.credential=e,n.tenantId=r.tenantId||void 0,n.email=r.email||void 0,n.phoneNumber=r.phoneNumber||void 0)}}function kd(e){const{_tokenResponse:t}=e instanceof Qo?e.customData:e;if(!t)return null;if(!(e instanceof Qo)&&"temporaryProof"in t&&"phoneNumber"in t)return zh.credentialFromResult(e);const n=t.providerId;if(!n||n===Ch)return null;let r;switch(n){case Sh:r=Cu;break;case Th:r=Su;break;case Eh:r=ku;break;case kh:r=Nu;break;default:const{oauthIdToken:e,oauthAccessToken:i,oauthTokenSecret:s,pendingToken:o,nonce:a}=t;return i||s||e||o?o?n.startsWith("saml.")?Ru._create(n,o):yu._fromParams({providerId:n,signInMethod:n,pendingToken:o,idToken:e,accessToken:i}):new Eu(n).credential({idToken:e,accessToken:i,rawNonce:a}):null}return e instanceof Qo?r.credentialFromError(e):r.credentialFromResult(e)}async function Rd(e,t){let n;try{n=await t}catch(t){throw t instanceof Qo&&Cd(e,t),t}const{operationType:r,user:i}=n;return{operationType:r,credential:(s=n,kd(s)),additionalUserInfo:ul(n),user:Pd.getOrCreate(i)};
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
var s}async function Nd(e,t){const n=await t;return{verificationId:n.verificationId,confirm:t=>Rd(e,n.confirm(t))}}class Ad{constructor(e,t){this.resolver=t,this.auth=e.wrapped()}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Rd(this.auth.unwrap(),this.resolver.resolveSignIn(e))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Pd{constructor(e){this._delegate=e,this.multiFactor=function(e){const t=Ia(e);return fl.has(t)||fl.set(t,dl._fromUser(t)),fl.get(t)}(e)}static getOrCreate(e){return Pd.USER_MAP.has(e)||Pd.USER_MAP.set(e,new Pd(e)),Pd.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Rd(this.auth,Bu(this._delegate,e))}async linkWithPhoneNumber(e,t){return Nd(this.auth,async function(e,t,n){const r=Ia(e);await Uu(!1,r,"phone");const i=await Kh(r.auth,t,Ia(n));return new Wh(i,(e=>Bu(r,e)))}(this._delegate,e,t))}async linkWithPopup(e){return Rd(this.auth,async function(e,t,n){const r=Ia(e);pc(t instanceof Iu,r.auth,"argument-error");const i=nh(r.auth,n);return new Gh(r.auth,"linkViaPopup",t,i,r).executeNotNull()}(this._delegate,e,Sd))}async linkWithRedirect(e){return await wd(ou(this.auth)),gh(this._delegate,e,Sd)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Rd(this.auth,$u(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return Nd(this.auth,async function(e,t,n){const r=Ia(e),i=await Kh(r.auth,t,Ia(n));return new Wh(i,(e=>$u(r,e)))}(this._delegate,e,t))}reauthenticateWithPopup(e){return Rd(this.auth,async function(e,t,n){const r=Ia(e);pc(t instanceof Iu,r.auth,"argument-error");const i=nh(r.auth,n);return new Gh(r.auth,"reauthViaPopup",t,i,r).executeNotNull()}(this._delegate,e,Sd))}async reauthenticateWithRedirect(e){return await wd(ou(this.auth)),ph(this._delegate,e,Sd)}sendEmailVerification(e){return Zu(this._delegate,e)}async unlink(e){return await Lu(this._delegate,e),this}updateEmail(e){return function(e,t){return nl(Ia(e),t,null)}(this._delegate,e)}updatePassword(e){return function(e,t){return nl(Ia(e),null,t)}(this._delegate,e)}updatePhoneNumber(e){return async function(e,t){await Fu(Ia(e),t)}(this._delegate,e)}updateProfile(e){return tl(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return el(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Pd.USER_MAP=new WeakMap;
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const xd=pc;class Dd{constructor(e,t){if(this.app=e,t.isInitialized())return this._delegate=t.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:n}=e.options;xd(n,"invalid-api-key",{appName:e.name});let r=[Kc];if("undefined"!=typeof window){r=function(e,t){const n=bd();if(!(null==n?void 0:n.sessionStorage))return[];const r=zc(vd,e,t);switch(n.sessionStorage.getItem(r)){case yd.NONE:return[Kc];case yd.LOCAL:return[xl,Xl];case yd.SESSION:return[Xl];default:return[]}}(n,e.name);for(const e of[xl,_l])r.includes(e)||r.push(e)}xd(n,"invalid-api-key",{appName:e.name});const i="undefined"!=typeof window?Sd:void 0;this._delegate=t.initialize({options:{persistence:r,popupRedirectResolver:i}}),this._delegate._updateErrorMap(ac),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Pd.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){cu(this._delegate,e,t)}applyActionCode(e){return Qu(this._delegate,e)}checkActionCode(e){return Yu(this._delegate,e)}confirmPasswordReset(e,t){return async function(e,t,n){await du(Ia(e),{oobCode:t,newPassword:n})}(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Rd(this._delegate,async function(e,t,n){const r=ou(e),i=await Au(r,{returnSecureToken:!0,email:t,password:n}),s=await Pu._fromIdTokenResponse(r,"signIn",i);return await r._updateCurrentUser(s.user),s}(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return Xu(this._delegate,e)}isSignInWithEmailLink(e){return function(e,t){const n=wu.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}(this._delegate,e)}async getRedirectResult(){xd(gd(),this._delegate,"operation-not-supported-in-this-environment");const e=await async function(e,t){return await ou(e)._initializationPromise,mh(e,t,!1)}(this._delegate,Sd);return e?Rd(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){!function(e,t){ou(e)._logFramework(t)}(this._delegate,e)}onAuthStateChanged(e,t,n){const{next:r,error:i,complete:s}=Od(e,t,n);return this._delegate.onAuthStateChanged(r,i,s)}onIdTokenChanged(e,t,n){const{next:r,error:i,complete:s}=Od(e,t,n);return this._delegate.onIdTokenChanged(r,i,s)}sendSignInLinkToEmail(e,t){return Ju(this._delegate,e,t)}sendPasswordResetEmail(e,t){return Gu(this._delegate,e,t||void 0)}async setPersistence(e){let t;switch(function(e,t){_d(Object.values(yd).includes(t),e,"invalid-persistence-type"),$o()?_d(t!==yd.SESSION,e,"unsupported-persistence-type"):Vo()?_d(t===yd.NONE,e,"unsupported-persistence-type"):pd()?_d(t===yd.NONE||t===yd.LOCAL&&zo(),e,"unsupported-persistence-type"):_d(t===yd.NONE||fd(),e,"unsupported-persistence-type")}(this._delegate,e),e){case yd.SESSION:t=Xl;break;case yd.LOCAL:t=await _c(xl)._isAvailable()?xl:_l;break;case yd.NONE:t=Kc;break;default:return hc("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Rd(this._delegate,async function(e){var t;const n=ou(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Pu({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await Au(n,{returnSecureToken:!0}),i=await Pu._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}(this._delegate))}signInWithCredential(e){return Rd(this._delegate,Vu(this._delegate,e))}signInWithCustomToken(e){return Rd(this._delegate,Wu(this._delegate,e))}signInWithEmailAndPassword(e,t){return Rd(this._delegate,function(e,t,n){return Vu(Ia(e),bu.credential(t,n))}(this._delegate,e,t))}signInWithEmailLink(e,t){return Rd(this._delegate,async function(e,t,n){const r=Ia(e),i=bu.credentialWithLink(t,n||vc());return pc(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Vu(r,i)}(this._delegate,e,t))}signInWithPhoneNumber(e,t){return Nd(this._delegate,async function(e,t,n){const r=ou(e),i=await Kh(r,t,Ia(n));return new Wh(i,(e=>Vu(r,e)))}(this._delegate,e,t))}async signInWithPopup(e){return xd(gd(),this._delegate,"operation-not-supported-in-this-environment"),Rd(this._delegate,async function(e,t,n){const r=ou(e);pc(t instanceof Iu,e,"argument-error");const i=nh(r,n);return new Gh(r,"signInViaPopup",t,i).executeNotNull()}(this._delegate,e,Sd))}async signInWithRedirect(e){return xd(gd(),this._delegate,"operation-not-supported-in-this-environment"),await wd(this._delegate),fh(this._delegate,e,Sd)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return async function(e,t){const{data:n}=await Yu(Ia(e),t);return n.email}(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}function Od(e,t,n){let r=e;"function"!=typeof e&&({next:r,error:t,complete:n}=e);const i=r;return{next:e=>i(e&&Pd.getOrCreate(e)),error:t,complete:n}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Md{constructor(){this.providerId="phone",this._delegate=new zh(unwrap(oc.auth()))}static credential(e,t){return zh.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}Md.PHONE_SIGN_IN_METHOD=zh.PHONE_SIGN_IN_METHOD,Md.PROVIDER_ID=zh.PROVIDER_ID;
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Ld=pc;class Fd{constructor(e,t,n=oc.app()){var r;Ld(null===(r=n.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new $h(e,t,n.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var Ud;(Ud=oc).INTERNAL.registerComponent(new Ta("auth-compat",(e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth-exp");return new Dd(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Rh,PASSWORD_RESET:Nh,RECOVER_EMAIL:Ah,REVERT_SECOND_FACTOR_ADDITION:Ph,VERIFY_AND_CHANGE_EMAIL:xh,VERIFY_EMAIL:Dh}},EmailAuthProvider:bu,FacebookAuthProvider:Su,GithubAuthProvider:ku,GoogleAuthProvider:Cu,OAuthProvider:Eu,PhoneAuthProvider:Md,PhoneMultiFactorGenerator:Yh,RecaptchaVerifier:Fd,TwitterAuthProvider:Nu,Auth:{Persistence:yd},AuthCredential:hu}).setInstantiationMode("LAZY").setMultipleInstances(!1)),Ud.registerVersion("@firebase/auth-compat","0.0.900-exp.57f19127c");
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let qd="";
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class jd{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ea(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Zo(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Vd{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return ia(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Bd=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new jd(t)}}catch(e){}return new Vd},$d=Bd("localStorage"),Wd=Bd("sessionStorage"),Kd=new Oa("@firebase/database"),zd=function(){let e=1;return function(){return e++}}(),Hd=function(e){const t=va(e),n=new ha;n.update(t);const r=n.digest();return xo.encodeByteArray(r)},Gd=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=Gd.apply(null,r):t+="object"==typeof r?ea(r):r,t+=" "}return t};let Qd=null,Yd=!0;const Jd=function(e,t){No(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(Kd.logLevel=ka.VERBOSE,Qd=Kd.log.bind(Kd),t&&Wd.set("logging_enabled",!0)):"function"==typeof e?Qd=e:(Qd=null,Wd.remove("logging_enabled"))},Xd=function(...e){if(!0===Yd&&(Yd=!1,null===Qd&&!0===Wd.get("logging_enabled")&&Jd(!0)),Qd){const t=Gd.apply(null,e);Qd(t)}},Zd=function(e){return function(...t){Xd(e,...t)}},ef=function(...e){const t="FIREBASE INTERNAL ERROR: "+Gd(...e);Kd.error(t)},tf=function(...e){const t=`FIREBASE FATAL ERROR: ${Gd(...e)}`;throw Kd.error(t),new Error(t)},nf=function(...e){const t="FIREBASE WARNING: "+Gd(...e);Kd.warn(t)},rf=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},sf="[MIN_NAME]",of="[MAX_NAME]",af=function(e,t){if(e===t)return 0;if(e===sf||t===of)return-1;if(t===sf||e===of)return 1;{const n=yf(e),r=yf(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},cf=function(e,t){return e===t?0:e<t?-1:1},uf=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+ea(t))},lf=function(e){if("object"!=typeof e||null===e)return ea(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=ea(t[r]),n+=":",n+=lf(e[t[r]]);return n+="}",n},hf=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function df(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const ff=function(e){No(!rf(e),"Invalid JSON number");const t=1023;let n,r,i,s,o;0===e?(r=0,i=0,n=1/e==-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(e)/Math.LN2),t),r=s+t,i=Math.round(e*Math.pow(2,52-s)-Math.pow(2,52))):(r=0,i=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(o=11;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);a.push(n?1:0),a.reverse();const c=a.join("");let u="";for(o=0;o<64;o+=8){let e=parseInt(c.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),u+=e}return u.toLowerCase()};const pf=new RegExp("^-?(0*)\\d{1,10}$"),gf=-2147483648,mf=2147483647,yf=function(e){if(pf.test(e)){const t=Number(e);if(t>=gf&&t<=mf)return t}return null},_f=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw nf("Exception was thrown by user callback.",t),e}),Math.floor(0))}},vf=function(e,t){const n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n};
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class wf{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){nf(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class bf{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(Xd("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',nf(e)}}class If{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}If.OWNER="owner";
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Tf=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Ef="websocket",Sf="long_polling";
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Cf{constructor(e,t,n,r,i=!1,s="",o=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=$d.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&$d.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function kf(e,t,n){let r;if(No("string"==typeof t,"typeof type must == string"),No("object"==typeof n,"typeof params must == object"),t===Ef)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Sf)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return df(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Rf{constructor(){this.counters_={}}incrementCounter(e,t=1){ia(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Mo(this.counters_)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Nf={},Af={};function Pf(e){const t=e.toString();return Nf[t]||(Nf[t]=new Rf),Nf[t]}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class xf{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&_f((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Df="start";class Of{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Zd(e),this.stats_=Pf(t),this.urlFn=e=>(this.appCheckToken&&(e.ac=this.appCheckToken),kf(t,Sf,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new xf(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new Mf(((...e)=>{const[t,n,r,i,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===Df)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={start:"t"};e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&Tf.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Of.forceAllow_=!0}static forceDisallow(){Of.forceDisallow_=!0}static isAvailable(){return!!Of.forceAllow_||!(Of.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=ea(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Do(t),r=hf(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=ea(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Mf{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=zd(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=Mf.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){Xd("frame writing exception"),e.stack&&Xd(e.stack),Xd(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Xd("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Xd("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let Lf=null;"undefined"!=typeof MozWebSocket?Lf=MozWebSocket:"undefined"!=typeof WebSocket&&(Lf=WebSocket);class Ff{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Zd(this.connId),this.stats_=Pf(t),this.connURL=Ff.connectionURL_(t,s,o,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r){const i={v:"5"};return"undefined"!=typeof location&&location.hostname&&Tf.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),kf(e,Ef,i)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,$d.set("previous_websocket_failure",!0);try{if(Ko());else{const e={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new Lf(this.connURL,[],e)}}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){Ff.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Lf&&!Ff.forceDisallow_}static previouslyFailed(){return $d.isInMemoryStorage||!0===$d.get("previous_websocket_failure")}markConnectionHealthy(){$d.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=Zo(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(No(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=ea(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=hf(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Ff.responsesRequiredToBeHealthy=2,Ff.healthyTimeout=3e4;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Uf{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Of,Ff]}initTransports_(e){const t=Ff&&Ff.isAvailable();let n=t&&!Ff.previouslyFailed();if(e.webSocketOnly&&(t||nf("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Ff];else{const e=this.transports_=[];for(const t of Uf.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class qf{constructor(e,t,n,r,i,s,o,a,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Zd("c:"+this.id+":"),this.transportManager_=new Uf(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=vf((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=uf("t",e),n=uf("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=uf("t",e),n=uf("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=uf("t",e);if("d"in e){const n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?ef("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):ef("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&nf("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),vf((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):vf((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&($d.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class jf{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Vf{constructor(e){this.allowedEvents_=e,this.listeners_={},No(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){No(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Bf extends Vf{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||jo()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new Bf}getInitialEvent(e){return No("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class $f{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Wf(){return new $f("")}function Kf(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function zf(e){return e.pieces_.length-e.pieceNum_}function Hf(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new $f(e.pieces_,t)}function Gf(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Qf(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function Yf(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new $f(t,0)}function Jf(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof $f)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new $f(n,0)}function Xf(e){return e.pieceNum_>=e.pieces_.length}function Zf(e,t){const n=Kf(e),r=Kf(t);if(null===n)return t;if(n===r)return Zf(Hf(e),Hf(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function ep(e,t){const n=Qf(e,0),r=Qf(t,0);for(let e=0;e<n.length&&e<r.length;e++){const t=af(n[e],r[e]);if(0!==t)return t}return n.length===r.length?0:n.length<r.length?-1:1}function tp(e,t){if(zf(e)!==zf(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function np(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(zf(e)>zf(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class rp{constructor(e,t){this.errorPrefix_=t,this.parts_=Qf(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=wa(this.parts_[e]);ip(this)}}function ip(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+sp(e))}function sp(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class op extends Vf{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new op}getInitialEvent(e){return No("visible"===e,"Unknown event type: "+e),[this.visible_]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const ap=1e3;class cp extends jf{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=cp.nextPersistentConnectionId_++,this.log_=Zd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ap,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!Ko())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");op.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&Bf.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(ea(i)),No(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new Fo,n={p:e._path.toString(),q:e._queryObject},r={action:"g",request:n,onComplete:e=>{const r=e.d;"ok"===e.s?(this.onDataUpdate_(n.p,r,!1,null),t.resolve(r)):t.reject(r)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_||setTimeout((()=>{const e=this.outstandingGets_[i];void 0!==e&&r===e&&(delete this.outstandingGets_[i],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+i+" timed out on connection"),t.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(i),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),No(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),No(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");const o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const s=i.d,o=i.s;cp.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&ia(e,"w")){const n=sa(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();nf(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||ra(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=na(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),No(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ea(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):ef("Unrecognized action received from server: "+ea(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){No(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ap,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=ap,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=ap),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+cp.nextConnectionId_++,i=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())},c=function(e){No(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:a,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,c]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);s?Xd("getToken() completed but was canceled"):(Xd("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=c&&c.token,o=new qf(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{nf(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&nf(e),a())}}}interrupt(e){Xd("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Xd("Resuming connection for reason: "+e),delete this.interruptReasons_[e],oa(this.interruptReasons_)&&(this.reconnectDelay_=ap,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>lf(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new $f(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){Xd("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Xd("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};e["sdk.js."+qd.replace(/\./g,"-")]=1,jo()?e["framework.cordova"]=1:$o()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Bf.getInstance().currentlyOnline();return oa(this.interruptReasons_)&&e}}cp.nextPersistentConnectionId_=0,cp.nextConnectionId_=0;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class up{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new up(e,t)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class lp{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new up(sf,e),r=new up(sf,t);return 0!==this.compare(n,r)}minPost(){return up.MIN}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let hp;class dp extends lp{static get __EMPTY_NODE(){return hp}static set __EMPTY_NODE(e){hp=e}compare(e,t){return af(e.name,t.name)}isDefinedOn(e){throw Ao("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return up.MIN}maxPost(){return new up(of,hp)}makePost(e,t){return No("string"==typeof e,"KeyIndex indexValue must always be a string."),new up(e,hp)}toString(){return".key"}}const fp=new dp;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class pp{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(e=e,s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class gp{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:gp.RED,this.left=null!=r?r:mp.EMPTY_NODE,this.right=null!=i?i:mp.EMPTY_NODE}copy(e,t,n,r,i){return new gp(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return mp.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return mp.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,gp.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,gp.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}gp.RED=!0,gp.BLACK=!1;class mp{constructor(e,t=mp.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new mp(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,gp.BLACK,null,null))}remove(e){return new mp(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,gp.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new pp(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new pp(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new pp(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new pp(this.root_,null,this.comparator_,!0,e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function yp(e,t){return af(e.name,t.name)}function _p(e,t){return af(e,t)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let vp;mp.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new gp(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const wp=function(e){return"number"==typeof e?"number:"+ff(e):"string:"+e},bp=function(e){if(e.isLeafNode()){const t=e.val();No("string"==typeof t||"number"==typeof t||"object"==typeof t&&ia(t,".sv"),"Priority must be a string or number.")}else No(e===vp||e.isEmpty(),"priority of unexpected type.");No(e===vp||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let Ip,Tp,Ep;class Sp{constructor(e,t=Sp.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,No(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),bp(this.priorityNode_)}static set __childrenNodeConstructor(e){Ip=e}static get __childrenNodeConstructor(){return Ip}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Sp(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:Sp.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Xf(e)?this:".priority"===Kf(e)?this.priorityNode_:Sp.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Sp.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=Kf(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(No(".priority"!==n||1===zf(e),".priority must be the last token in a path"),this.updateImmediateChild(n,Sp.__childrenNodeConstructor.EMPTY_NODE.updateChild(Hf(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+wp(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?ff(this.value_):this.value_,this.lazyHash_=Hd(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Sp.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Sp.__childrenNodeConstructor?-1:(No(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=Sp.VALUE_TYPE_ORDER.indexOf(t),i=Sp.VALUE_TYPE_ORDER.indexOf(n);return No(r>=0,"Unknown leaf type: "+t),No(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}Sp.VALUE_TYPE_ORDER=["object","boolean","number","string"];const Cp=new class extends lp{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?af(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return up.MIN}maxPost(){return new up(of,new Sp("[PRIORITY-POST]",Ep))}makePost(e,t){const n=Tp(e);return new up(t,new Sp("[PRIORITY-POST]",n))}toString(){return".priority"}},kp=Math.log(2);
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Rp{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/kp,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Np=function(e,t,n,r){e.sort(t);const i=function(t,r){const s=r-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new gp(a,o.node,gp.BLACK,null,null);{const c=parseInt(s/2,10)+t,u=i(t,c),l=i(c+1,r);return o=e[c],a=n?n(o):o,new gp(a,o.node,gp.BLACK,u,l)}},s=function(t){let r=null,s=null,o=e.length;const a=function(t,r){const s=o-t,a=o;o-=t;const u=i(s+1,a),l=e[s],h=n?n(l):l;c(new gp(h,l.node,r,null,u))},c=function(e){r?(r.left=e,r=e):(s=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,gp.BLACK):(a(r,gp.BLACK),a(r,gp.RED))}return s}(new Rp(e.length));return new mp(r||t,s)};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let Ap;const Pp={};class xp{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return No(Pp&&Cp,"ChildrenNode.ts has not been loaded"),Ap=Ap||new xp({".priority":Pp},{".priority":Cp}),Ap}get(e){const t=sa(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof mp?t:null}hasIndex(e){return ia(this.indexSet_,e.toString())}addIndex(e,t){No(e!==fp,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(up.Wrap);let s,o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),n.push(o),o=i.getNext();s=r?Np(n,e.getCompare()):Pp;const a=e.toString(),c=Object.assign({},this.indexSet_);c[a]=e;const u=Object.assign({},this.indexes_);return u[a]=s,new xp(u,c)}addToIndexes(e,t){const n=aa(this.indexes_,((n,r)=>{const i=sa(this.indexSet_,r);if(No(i,"Missing index implementation for "+r),n===Pp){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(up.Wrap);let s=r.getNext();for(;s;)s.name!==e.name&&n.push(s),s=r.getNext();return n.push(e),Np(n,i.getCompare())}return Pp}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new up(e.name,r))),i.insert(e,e.node)}}));return new xp(n,this.indexSet_)}removeFromIndexes(e,t){const n=aa(this.indexes_,(n=>{if(n===Pp)return n;{const r=t.get(e.name);return r?n.remove(new up(e.name,r)):n}}));return new xp(n,this.indexSet_)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let Dp;class Op{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&bp(this.priorityNode_),this.children_.isEmpty()&&No(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Dp||(Dp=new Op(new mp(_p),null,xp.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Dp}updatePriority(e){return this.children_.isEmpty()?this:new Op(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?Dp:t}}getChild(e){const t=Kf(e);return null===t?this:this.getImmediateChild(t).getChild(Hf(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(No(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new up(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const s=r.isEmpty()?Dp:this.priorityNode_;return new Op(r,s,i)}}updateChild(e,t){const n=Kf(e);if(null===n)return t;{No(".priority"!==Kf(e)||1===zf(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(Hf(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(Cp,((s,o)=>{t[s]=o.val(e),n++,i&&Op.INTEGER_REGEXP_.test(s)?r=Math.max(r,Number(s)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+wp(this.getPriority().val())+":"),this.forEachChild(Cp,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":Hd(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new up(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new up(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new up(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,up.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,up.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Mp?-1:0}withIndex(e){if(e===fp||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new Op(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===fp||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(Cp),n=t.getIterator(Cp);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===fp?null:this.indexMap_.get(e.toString())}}Op.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const Mp=new class extends Op{constructor(){super(new mp(_p),Op.EMPTY_NODE,xp.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Op.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(up,{MIN:{value:new up(sf,Op.EMPTY_NODE)},MAX:{value:new up(of,Mp)}}),dp.__EMPTY_NODE=Op.EMPTY_NODE,Sp.__childrenNodeConstructor=Op,vp=Mp,function(e){Ep=e}(Mp);function Lp(e,t=null){if(null===e)return Op.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),No(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e){return new Sp(e,Lp(t))}if(e instanceof Array){let n=Op.EMPTY_NODE;return df(e,((t,r)=>{if(ia(e,t)&&"."!==t.substring(0,1)){const e=Lp(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(Lp(t))}{const n=[];let r=!1;if(df(e,((e,t)=>{if("."!==e.substring(0,1)){const i=Lp(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new up(e,i)))}})),0===n.length)return Op.EMPTY_NODE;const i=Np(n,yp,(e=>e.name),_p);if(r){const e=Np(n,Cp.getCompare());return new Op(i,Lp(t),new xp({".priority":e},{".priority":Cp}))}return new Op(i,Lp(t),xp.Default)}}!function(e){Tp=e}(Lp);
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Fp extends lp{constructor(e){super(),this.indexPath_=e,No(!Xf(e)&&".priority"!==Kf(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?af(e.name,t.name):i}makePost(e,t){const n=Lp(e),r=Op.EMPTY_NODE.updateChild(this.indexPath_,n);return new up(t,r)}maxPost(){const e=Op.EMPTY_NODE.updateChild(this.indexPath_,Mp);return new up(of,e)}toString(){return Qf(this.indexPath_,0).join("/")}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Up=new class extends lp{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?af(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return up.MIN}maxPost(){return up.MAX}makePost(e,t){const n=Lp(e);return new up(t,n)}toString(){return".value"}},qp="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",jp=function(){let e=0;const t=[];return function(n){const r=n===e;let i;e=n;const s=new Array(8);for(i=7;i>=0;i--)s[i]=qp.charAt(n%64),n=Math.floor(n/64);No(0===n,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&63===t[i];i--)t[i]=0;t[i]++}else for(i=0;i<12;i++)t[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)o+=qp.charAt(t[i]);return No(20===o.length,"nextPushId: Length should be 20."),o}}(),Vp=function(e){if("2147483647"===e)return"-";const t=yf(e);if(null!=t)return""+(t+1);const n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e.charAt(t);if(n.length<786)return n.push("-"),n.join("");let r=n.length-1;for(;r>=0&&"z"===n[r];)r--;if(-1===r)return of;const i=n[r],s=qp.charAt(qp.indexOf(i)+1);return n[r]=s,n.slice(0,r+1).join("")},Bp=function(e){if("-2147483648"===e)return sf;const t=yf(e);if(null!=t)return""+(t-1);const n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e.charAt(t);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=qp.charAt(qp.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function $p(e){return{type:"value",snapshotNode:e}}function Wp(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Kp(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function zp(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Hp{constructor(e){this.index_=e}updateChild(e,t,n,r,i,s){No(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(Kp(t,o)):No(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?s.trackChildChange(Wp(t,n)):s.trackChildChange(zp(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(Cp,((e,r)=>{t.hasChild(e)||n.trackChildChange(Kp(e,r))})),t.isLeafNode()||t.forEachChild(Cp,((t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(zp(t,r,i))}else n.trackChildChange(Wp(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Op.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Gp{constructor(e){this.indexedFilter_=new Hp(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Gp.getStartPost_(e),this.endPost_=Gp.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,n,r,i,s){return this.matches(new up(t,n))||(n=Op.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=Op.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(Op.EMPTY_NODE);const i=this;return t.forEachChild(Cp,((e,t)=>{i.matches(new up(e,t))||(r=r.updateImmediateChild(e,Op.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Qp{constructor(e){this.rangedFilter_=new Gp(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,n,r,i,s){return this.rangedFilter_.matches(new up(t,n))||(n=Op.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,s):this.fullLimitUpdateChild_(e,t,n,i,s)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=Op.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=Op.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();let i;if(i=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),t)<=0:this.index_.compare(t,this.rangedFilter_.getEndPost())<=0,!i)break;r=r.updateImmediateChild(t.name,t.node),n++}}else{let e,n,i,s;if(r=t.withIndex(this.index_),r=r.updatePriority(Op.EMPTY_NODE),this.reverse_){s=r.getReverseIterator(this.index_),e=this.rangedFilter_.getEndPost(),n=this.rangedFilter_.getStartPost();const t=this.index_.getCompare();i=(e,n)=>t(n,e)}else s=r.getIterator(this.index_),e=this.rangedFilter_.getStartPost(),n=this.rangedFilter_.getEndPost(),i=this.index_.getCompare();let o=0,a=!1;for(;s.hasNext();){const t=s.getNext();!a&&i(e,t)<=0&&(a=!0);a&&o<this.limit_&&i(t,n)<=0?o++:r=r.updateImmediateChild(t.name,Op.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let s;if(this.reverse_){const e=this.index_.getCompare();s=(t,n)=>e(n,t)}else s=this.index_.getCompare();const o=e;No(o.numChildren()===this.limit_,"");const a=new up(t,n),c=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),u=this.rangedFilter_.matches(a);if(o.hasChild(t)){const e=o.getImmediateChild(t);let l=r.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=l&&(l.name===t||o.hasChild(l.name));)l=r.getChildAfterChild(this.index_,l,this.reverse_);const h=null==l?1:s(l,a);if(u&&!n.isEmpty()&&h>=0)return null!=i&&i.trackChildChange(zp(t,n,e)),o.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(Kp(t,e));const n=o.updateImmediateChild(t,Op.EMPTY_NODE);return null!=l&&this.rangedFilter_.matches(l)?(null!=i&&i.trackChildChange(Wp(l.name,l.node)),n.updateImmediateChild(l.name,l.node)):n}}return n.isEmpty()?e:u&&s(c,a)>=0?(null!=i&&(i.trackChildChange(Kp(c.name,c.node)),i.trackChildChange(Wp(t,n))),o.updateImmediateChild(t,n).updateImmediateChild(c.name,Op.EMPTY_NODE)):e}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Yp{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Cp}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return No(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return No(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:sf}hasEnd(){return this.endSet_}getIndexEndValue(){return No(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return No(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:of}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return No(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Cp}copy(){const e=new Yp;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Jp(e,t,n){const r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function Xp(e,t,n){const r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function Zp(e,t){const n=e.copy();return n.index_=t,n}function eg(e){const t={};if(e.isDefault())return t;let n;return e.index_===Cp?n="$priority":e.index_===Up?n="$value":e.index_===fp?n="$key":(No(e.index_ instanceof Fp,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=ea(n),e.startSet_&&(t.startAt=ea(e.indexStartValue_),e.startNameSet_&&(t.startAt+=","+ea(e.indexStartName_))),e.endSet_&&(t.endAt=ea(e.indexEndValue_),e.endNameSet_&&(t.endAt+=","+ea(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function tg(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==Cp&&(t.i=e.index_.toString()),t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ng extends jf{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=Zd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(No(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const s=ng.getListenId_(e,n),o={};this.listens_[s]=o;const a=eg(e._queryParams);this.restRequest_(i+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),sa(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=ng.getListenId_(e,t);delete this.listens_[n]}get(e){const t=eg(e._queryParams),n=e._path.toString(),r=new Fo;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ca(t);this.log_("Sending REST request for "+s);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&4===o.readyState){this.log_("REST Response for "+s+" received. status:",o.status,"response:",o.responseText);let e=null;if(o.status>=200&&o.status<300){try{e=Zo(o.responseText)}catch(e){nf("Failed to parse JSON response for "+s+": "+o.responseText)}n(null,e)}else 401!==o.status&&404!==o.status&&nf("Got unsuccessful REST response for "+s+" Status: "+o.status),n(o.status);n=null}},o.open("GET",s,!0),o.send()}))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class rg{constructor(){this.rootNode_=Op.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function ig(){return{value:null,children:new Map}}function sg(e,t,n){if(Xf(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=Kf(t);e.children.has(r)||e.children.set(r,ig());sg(e.children.get(r),t=Hf(t),n)}}function og(e,t){if(Xf(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;{const n=e.value;return e.value=null,n.forEachChild(Cp,((t,n)=>{sg(e,new $f(t),n)})),og(e,t)}}if(e.children.size>0){const n=Kf(t);if(t=Hf(t),e.children.has(n)){og(e.children.get(n),t)&&e.children.delete(n)}return 0===e.children.size}return!0}function ag(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,((e,r)=>{ag(r,new $f(t.toString()+"/"+e),n)}))}class cg{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&df(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ug{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new cg(e);const n=1e4+2e4*Math.random();vf(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;df(e,((e,r)=>{r>0&&ia(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),vf(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var lg;function hg(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(lg||(lg={}));class dg{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=lg.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Xf(this.path)){if(null!=this.affectedTree.value)return No(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new $f(e));return new dg(Wf(),t,this.revert)}}return No(Kf(this.path)===e,"operationForChild called for unrelated child."),new dg(Hf(this.path),this.affectedTree,this.revert)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class fg{constructor(e,t){this.source=e,this.path=t,this.type=lg.LISTEN_COMPLETE}operationForChild(e){return Xf(this.path)?new fg(this.source,Wf()):new fg(this.source,Hf(this.path))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class pg{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=lg.OVERWRITE}operationForChild(e){return Xf(this.path)?new pg(this.source,Wf(),this.snap.getImmediateChild(e)):new pg(this.source,Hf(this.path),this.snap)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class gg{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=lg.MERGE}operationForChild(e){if(Xf(this.path)){const t=this.children.subtree(new $f(e));return t.isEmpty()?null:t.value?new pg(this.source,Wf(),t.value):new gg(this.source,Wf(),t)}return No(Kf(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new gg(this.source,Hf(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class mg{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Xf(e))return this.isFullyInitialized()&&!this.filtered_;const t=Kf(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class yg{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function _g(e,t,n,r,i,s){const o=r.filter((e=>e.type===n));o.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw Ao("Should only compare child_ events.");const r=new up(t.childName,t.snapshotNode),i=new up(n.childName,n.snapshotNode);return e.index_.compare(r,i)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,t,n))),o.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);i.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function vg(e,t){return{eventCache:e,serverCache:t}}function wg(e,t,n,r){return vg(new mg(t,n,r),e.serverCache)}function bg(e,t,n,r){return vg(e.eventCache,new mg(t,n,r))}function Ig(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Tg(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let Eg;class Sg{constructor(e,t=(()=>(Eg||(Eg=new mp(cf)),Eg))()){this.value=e,this.children=t}static fromObject(e){let t=new Sg(null);return df(e,((e,n)=>{t=t.set(new $f(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Wf(),value:this.value};if(Xf(e))return null;{const n=Kf(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(Hf(e),t);if(null!=i){return{path:Jf(new $f(n),i.path),value:i.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(Xf(e))return this;{const t=Kf(e),n=this.children.get(t);return null!==n?n.subtree(Hf(e)):new Sg(null)}}set(e,t){if(Xf(e))return new Sg(t,this.children);{const n=Kf(e),r=(this.children.get(n)||new Sg(null)).set(Hf(e),t),i=this.children.insert(n,r);return new Sg(this.value,i)}}remove(e){if(Xf(e))return this.children.isEmpty()?new Sg(null):new Sg(null,this.children);{const t=Kf(e),n=this.children.get(t);if(n){const r=n.remove(Hf(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new Sg(null):new Sg(this.value,i)}return this}}get(e){if(Xf(e))return this.value;{const t=Kf(e),n=this.children.get(t);return n?n.get(Hf(e)):null}}setTree(e,t){if(Xf(e))return t;{const n=Kf(e),r=(this.children.get(n)||new Sg(null)).setTree(Hf(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new Sg(this.value,i)}}fold(e){return this.fold_(Wf(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(Jf(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,Wf(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(Xf(e))return null;{const r=Kf(e),i=this.children.get(r);return i?i.findOnPath_(Hf(e),Jf(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Wf(),t)}foreachOnPath_(e,t,n){if(Xf(e))return this;{this.value&&n(t,this.value);const r=Kf(e),i=this.children.get(r);return i?i.foreachOnPath_(Hf(e),Jf(t,r),n):new Sg(null)}}foreach(e){this.foreach_(Wf(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(Jf(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Cg{constructor(e){this.writeTree_=e}static empty(){return new Cg(new Sg(null))}}function kg(e,t,n){if(Xf(t))return new Cg(new Sg(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let s=r.value;const o=Zf(i,t);return s=s.updateChild(o,n),new Cg(e.writeTree_.set(i,s))}{const r=new Sg(n),i=e.writeTree_.setTree(t,r);return new Cg(i)}}}function Rg(e,t,n){let r=e;return df(n,((e,n)=>{r=kg(r,Jf(t,e),n)})),r}function Ng(e,t){if(Xf(t))return Cg.empty();{const n=e.writeTree_.setTree(t,new Sg(null));return new Cg(n)}}function Ag(e,t){return null!=Pg(e,t)}function Pg(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Zf(n.path,t)):null}function xg(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Cp,((e,n)=>{t.push(new up(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new up(e,n.value))})),t}function Dg(e,t){if(Xf(t))return e;{const n=Pg(e,t);return new Cg(null!=n?new Sg(n):e.writeTree_.subtree(t))}}function Og(e){return e.writeTree_.isEmpty()}function Mg(e,t){return Lg(Wf(),e.writeTree_,t)}function Lg(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,i)=>{".priority"===t?(No(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Lg(Jf(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(Jf(e,".priority"),r)),n}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Fg(e,t){return Yg(t,e)}function Ug(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));No(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,s=!1,o=e.allWrites.length-1;for(;i&&o>=0;){const t=e.allWrites[o];t.visible&&(o>=n&&qg(t,r.path)?i=!1:np(r.path,t.path)&&(s=!0)),o--}if(i){if(s)return function(e){e.visibleWrites=Vg(e.allWrites,jg,Wf()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(r.snap)e.visibleWrites=Ng(e.visibleWrites,r.path);else{df(r.children,(t=>{e.visibleWrites=Ng(e.visibleWrites,Jf(r.path,t))}))}return!0}return!1}function qg(e,t){if(e.snap)return np(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&np(Jf(e.path,n),t))return!0;return!1}function jg(e){return e.visible}function Vg(e,t,n){let r=Cg.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const e=s.path;let t;if(s.snap)np(n,e)?(t=Zf(n,e),r=kg(r,t,s.snap)):np(e,n)&&(t=Zf(e,n),r=kg(r,Wf(),s.snap.getChild(t)));else{if(!s.children)throw Ao("WriteRecord should have .snap or .children");if(np(n,e))t=Zf(n,e),r=Rg(r,t,s.children);else if(np(e,n))if(t=Zf(e,n),Xf(t))r=Rg(r,Wf(),s.children);else{const e=sa(s.children,Kf(t));if(e){const n=e.getChild(Hf(t));r=kg(r,Wf(),n)}}}}}return r}function Bg(e,t,n,r,i){if(r||i){const s=Dg(e.visibleWrites,t);if(!i&&Og(s))return n;if(i||null!=n||Ag(s,Wf())){const s=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(np(e.path,t)||np(t,e.path))};return Mg(Vg(e.allWrites,s,t),n||Op.EMPTY_NODE)}return null}{const r=Pg(e.visibleWrites,t);if(null!=r)return r;{const r=Dg(e.visibleWrites,t);if(Og(r))return n;if(null!=n||Ag(r,Wf())){return Mg(r,n||Op.EMPTY_NODE)}return null}}}function $g(e,t,n,r){return Bg(e.writeTree,e.treePath,t,n,r)}function Wg(e,t){return function(e,t,n){let r=Op.EMPTY_NODE;const i=Pg(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(Cp,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=Dg(e.visibleWrites,t);return n.forEachChild(Cp,((e,t)=>{const n=Mg(Dg(i,new $f(e)),t);r=r.updateImmediateChild(e,n)})),xg(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return xg(Dg(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function Kg(e,t,n,r){return function(e,t,n,r,i){No(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Jf(t,n);if(Ag(e.visibleWrites,s))return null;{const t=Dg(e.visibleWrites,s);return Og(t)?i.getChild(n):Mg(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function zg(e,t){return function(e,t){return Pg(e.visibleWrites,t)}(e.writeTree,Jf(e.treePath,t))}function Hg(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){let a;const c=Dg(e.visibleWrites,t),u=Pg(c,Wf());if(null!=u)a=u;else{if(null==n)return[];a=Mg(c,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let c=n.getNext();for(;c&&e.length<i;)0!==t(c,r)&&e.push(c),c=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,s)}function Gg(e,t,n){return function(e,t,n,r){const i=Jf(t,n),s=Pg(e.visibleWrites,i);if(null!=s)return s;if(r.isCompleteForChild(n))return Mg(Dg(e.visibleWrites,i),r.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function Qg(e,t){return Yg(Jf(e.treePath,t),e.writeTree)}function Yg(e,t){return{treePath:e,writeTree:t}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Jg{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;No("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),No(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,zp(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,Kp(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,Wp(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Ao("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,zp(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Xg=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class Zg{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new mg(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Gg(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Tg(this.viewCache_),i=Hg(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function em(e,t,n,r,i){const s=new Jg;let o,a;if(n.type===lg.OVERWRITE){const c=n;c.source.fromUser?o=rm(e,t,c.path,c.snap,r,i,s):(No(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered()&&!Xf(c.path),o=nm(e,t,c.path,c.snap,r,i,a,s))}else if(n.type===lg.MERGE){const c=n;c.source.fromUser?o=function(e,t,n,r,i,s,o){let a=t;return r.foreach(((r,c)=>{const u=Jf(n,r);im(t,Kf(u))&&(a=rm(e,a,u,c,i,s,o))})),r.foreach(((r,c)=>{const u=Jf(n,r);im(t,Kf(u))||(a=rm(e,a,u,c,i,s,o))})),a}(e,t,c.path,c.children,r,i,s):(No(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered(),o=om(e,t,c.path,c.children,r,i,a,s))}else if(n.type===lg.ACK_USER_WRITE){const a=n;o=a.revert?function(e,t,n,r,i,s){let o;if(null!=zg(r,n))return t;{const a=new Zg(r,t,i),c=t.eventCache.getNode();let u;if(Xf(n)||".priority"===Kf(n)){let n;if(t.serverCache.isFullyInitialized())n=$g(r,Tg(t));else{const e=t.serverCache.getNode();No(e instanceof Op,"serverChildren would be complete if leaf node"),n=Wg(r,e)}n=n,u=e.filter.updateFullNode(c,n,s)}else{const i=Kf(n);let l=Gg(r,i,t.serverCache);null==l&&t.serverCache.isCompleteForChild(i)&&(l=c.getImmediateChild(i)),u=null!=l?e.filter.updateChild(c,i,l,Hf(n),a,s):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(c,i,Op.EMPTY_NODE,Hf(n),a,s):c,u.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=$g(r,Tg(t)),o.isLeafNode()&&(u=e.filter.updateFullNode(u,o,s)))}return o=t.serverCache.isFullyInitialized()||null!=zg(r,Wf()),wg(t,u,o,e.filter.filtersNodes())}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,t,a.path,r,i,s):function(e,t,n,r,i,s,o){if(null!=zg(i,n))return t;const a=t.serverCache.isFiltered(),c=t.serverCache;if(null!=r.value){if(Xf(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return nm(e,t,n,c.getNode().getChild(n),i,s,a,o);if(Xf(n)){let r=new Sg(null);return c.getNode().forEachChild(fp,((e,t)=>{r=r.set(new $f(e),t)})),om(e,t,n,r,i,s,a,o)}return t}{let u=new Sg(null);return r.foreach(((e,t)=>{const r=Jf(n,e);c.isCompleteForPath(r)&&(u=u.set(e,c.getNode().getChild(r)))})),om(e,t,n,u,i,s,a,o)}}(e,t,a.path,a.affectedTree,r,i,s)}else{if(n.type!==lg.LISTEN_COMPLETE)throw Ao("Unknown operation type: "+n.type);o=function(e,t,n,r,i){const s=t.serverCache,o=bg(t,s.getNode(),s.isFullyInitialized()||Xf(n),s.isFiltered());return tm(e,o,n,r,Xg,i)}(e,t,n.path,r,s)}const c=s.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Ig(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push($p(Ig(t)))}}(t,o,c),{viewCache:o,changes:c}}function tm(e,t,n,r,i,s){const o=t.eventCache;if(null!=zg(r,n))return t;{let a,c;if(Xf(n))if(No(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=Tg(t),i=Wg(r,n instanceof Op?n:Op.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),i,s)}else{const n=$g(r,Tg(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const u=Kf(n);if(".priority"===u){No(1===zf(n),"Can't have a priority with additional path components");const i=o.getNode();c=t.serverCache.getNode();const s=Kg(r,n,i,c);a=null!=s?e.filter.updatePriority(i,s):o.getNode()}else{const l=Hf(n);let h;if(o.isCompleteForChild(u)){c=t.serverCache.getNode();const e=Kg(r,n,o.getNode(),c);h=null!=e?o.getNode().getImmediateChild(u).updateChild(l,e):o.getNode().getImmediateChild(u)}else h=Gg(r,u,t.serverCache);a=null!=h?e.filter.updateChild(o.getNode(),u,h,l,i,s):o.getNode()}}return wg(t,a,o.isFullyInitialized()||Xf(n),e.filter.filtersNodes())}}function nm(e,t,n,r,i,s,o,a){const c=t.serverCache;let u;const l=o?e.filter:e.filter.getIndexedFilter();if(Xf(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){const e=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),e,null)}else{const e=Kf(n);if(!c.isCompleteForPath(n)&&zf(n)>1)return t;const i=Hf(n),s=c.getNode().getImmediateChild(e).updateChild(i,r);u=".priority"===e?l.updatePriority(c.getNode(),s):l.updateChild(c.getNode(),e,s,i,Xg,null)}const h=bg(t,u,c.isFullyInitialized()||Xf(n),l.filtersNodes());return tm(e,h,n,i,new Zg(i,h,s),a)}function rm(e,t,n,r,i,s,o){const a=t.eventCache;let c,u;const l=new Zg(i,t,s);if(Xf(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,o),c=wg(t,u,!0,e.filter.filtersNodes());else{const i=Kf(n);if(".priority"===i)u=e.filter.updatePriority(t.eventCache.getNode(),r),c=wg(t,u,a.isFullyInitialized(),a.isFiltered());else{const s=Hf(n),u=a.getNode().getImmediateChild(i);let h;if(Xf(s))h=r;else{const e=l.getCompleteChild(i);h=null!=e?".priority"===Gf(s)&&e.getChild(Yf(s)).isEmpty()?e:e.updateChild(s,r):Op.EMPTY_NODE}if(u.equals(h))c=t;else{c=wg(t,e.filter.updateChild(a.getNode(),i,h,s,l,o),a.isFullyInitialized(),e.filter.filtersNodes())}}}return c}function im(e,t){return e.eventCache.isCompleteForChild(t)}function sm(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function om(e,t,n,r,i,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c,u=t;c=Xf(n)?r:new Sg(null).setTree(n,r);const l=t.serverCache.getNode();return c.children.inorderTraversal(((n,r)=>{if(l.hasChild(n)){const c=sm(0,t.serverCache.getNode().getImmediateChild(n),r);u=nm(e,u,new $f(n),c,i,s,o,a)}})),c.children.inorderTraversal(((n,r)=>{const c=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!c){const c=sm(0,t.serverCache.getNode().getImmediateChild(n),r);u=nm(e,u,new $f(n),c,i,s,o,a)}})),u}class am{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new Hp(n.getIndex()),i=(s=n).loadsAllData()?new Hp(s.getIndex()):s.hasLimit()?new Qp(s):new Gp(s);var s;this.processor_=function(e){return{filter:e}}(i);const o=t.serverCache,a=t.eventCache,c=r.updateFullNode(Op.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(Op.EMPTY_NODE,a.getNode(),null),l=new mg(c,o.isFullyInitialized(),r.filtersNodes()),h=new mg(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=vg(h,l),this.eventGenerator_=new yg(this.query_)}get query(){return this.query_}}function cm(e,t){const n=Tg(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Xf(t)&&!n.getImmediateChild(Kf(t)).isEmpty())?n.getChild(t):null}function um(e){return 0===e.eventRegistrations_.length}function lm(e,t,n){const r=[];if(n){No(null==t,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function hm(e,t,n,r){t.type===lg.MERGE&&null!==t.source.queryId&&(No(Tg(e.viewCache_),"We should always have a full cache before handling merges"),No(Ig(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,s=em(e.processor_,i,t,n,r);var o,a;return o=e.processor_,a=s.viewCache,No(a.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),No(a.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),No(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,dm(e,s.changes,s.viewCache.eventCache.getNode(),null)}function dm(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],s=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),_g(e,i,"child_removed",t,r,n),_g(e,i,"child_added",t,r,n),_g(e,i,"child_moved",s,r,n),_g(e,i,"child_changed",t,r,n),_g(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let fm,pm;class gm{constructor(){this.views=new Map}}function mm(e,t,n,r){const i=t.source.queryId;if(null!==i){const s=e.views.get(i);return No(null!=s,"SyncTree gave us an op for an invalid query."),hm(s,t,n,r)}{let i=[];for(const s of e.views.values())i=i.concat(hm(s,t,n,r));return i}}function ym(e,t,n,r,i){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=$g(n,i?r:null),s=!1;e?s=!0:r instanceof Op?(e=Wg(n,r),s=!1):(e=Op.EMPTY_NODE,s=!1);const o=vg(new mg(e,s,!1),new mg(r,i,!1));return new am(t,o)}return o}function _m(e,t,n,r,i,s){const o=ym(e,t,r,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){const n=e.viewCache_.eventCache,r=[];n.getNode().isLeafNode()||n.getNode().forEachChild(Cp,((e,t)=>{r.push(Wp(e,t))}));return n.isFullyInitialized()&&r.push($p(n.getNode())),dm(e,r,n.getNode(),t)}(o,n)}function vm(e,t,n,r){const i=t._queryIdentifier,s=[];let o=[];const a=Em(e);if("default"===i)for(const[t,i]of e.views.entries())o=o.concat(lm(i,n,r)),um(i)&&(e.views.delete(t),i.query._queryParams.loadsAllData()||s.push(i.query));else{const t=e.views.get(i);t&&(o=o.concat(lm(t,n,r)),um(t)&&(e.views.delete(i),t.query._queryParams.loadsAllData()||s.push(t.query)))}return a&&!Em(e)&&s.push(new(No(fm,"Reference.ts has not been loaded"),fm)(t._repo,t._path)),{removed:s,events:o}}function wm(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function bm(e,t){let n=null;for(const r of e.views.values())n=n||cm(r,t);return n}function Im(e,t){if(t._queryParams.loadsAllData())return Sm(e);{const n=t._queryIdentifier;return e.views.get(n)}}function Tm(e,t){return null!=Im(e,t)}function Em(e){return null!=Sm(e)}function Sm(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let Cm=1;class km{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Sg(null),this.pendingWriteTree_={visibleWrites:Cg.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Rm(e,t,n,r,i){return function(e,t,n,r,i){No(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=kg(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?Lm(e,new pg({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function Nm(e,t,n,r){!function(e,t,n,r){No(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=Rg(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);const i=Sg.fromObject(n);return Lm(e,new gg({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}function Am(e,t,n=!1){const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(Ug(e.pendingWriteTree_,t)){let t=new Sg(null);return null!=r.snap?t=t.set(Wf(),!0):df(r.children,(e=>{t=t.set(new $f(e),!0)})),Lm(e,new dg(r.path,t,n))}return[]}function Pm(e,t,n){return Lm(e,new pg({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function xm(e,t,n,r){const i=t._path,s=e.syncPointTree_.get(i);let o=[];if(s&&("default"===t._queryIdentifier||Tm(s,t))){const a=vm(s,t,n,r);0===s.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(i));const c=a.removed;o=a.events;const u=-1!==c.findIndex((e=>e._queryParams.loadsAllData())),l=e.syncPointTree_.findOnPath(i,((e,t)=>Em(t)));if(u&&!l){const t=e.syncPointTree_.subtree(i);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&Em(t)){return[Sm(t)]}{let e=[];return t&&(e=wm(t)),df(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const r=n[t],i=r.query,s=qm(e,r);e.listenProvider_.startListening(Km(i),jm(e,i),s.hashFn,s.onComplete)}}}if(!l&&c.length>0&&!r)if(u){const n=null;e.listenProvider_.stopListening(Km(t),n)}else c.forEach((t=>{const n=e.queryToTagMap.get(Vm(t));e.listenProvider_.stopListening(Km(t),n)}));!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=Vm(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,c)}return o}function Dm(e,t,n){const r=t._path;let i=null,s=!1;e.syncPointTree_.foreachOnPath(r,((e,t)=>{const n=Zf(e,r);i=i||bm(t,n),s=s||Em(t)}));let o,a=e.syncPointTree_.get(r);if(a?(s=s||Em(a),i=i||bm(a,Wf())):(a=new gm,e.syncPointTree_=e.syncPointTree_.set(r,a)),null!=i)o=!0;else{o=!1,i=Op.EMPTY_NODE;e.syncPointTree_.subtree(r).foreachChild(((e,t)=>{const n=bm(t,Wf());n&&(i=i.updateImmediateChild(e,n))}))}const c=Tm(a,t);if(!c&&!t._queryParams.loadsAllData()){const n=Vm(t);No(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=Cm++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let u=_m(a,t,n,Fg(e.pendingWriteTree_,r),i,o);if(!c&&!s){const n=Im(a,t);u=u.concat(function(e,t,n){const r=t._path,i=jm(e,t),s=qm(e,n),o=e.listenProvider_.startListening(Km(t),i,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(r);if(i)No(!Em(a.value),"If we're adding a query, it shouldn't be shadowed");else{const t=a.fold(((e,t,n)=>{if(!Xf(e)&&t&&Em(t))return[Sm(t).query];{let e=[];return t&&(e=e.concat(wm(t).map((e=>e.query)))),df(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(Km(r),jm(e,r))}}return o}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,t,n))}return u}function Om(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=bm(n,Zf(e,t));if(r)return r}));return Bg(r,t,i,n,!0)}function Mm(e,t){const n=t._path;let r=null;e.syncPointTree_.foreachOnPath(n,((e,t)=>{const i=Zf(e,n);r=r||bm(t,i)}));let i=e.syncPointTree_.get(n);i?r=r||bm(i,Wf()):(i=new gm,e.syncPointTree_=e.syncPointTree_.set(n,i));const s=null!=r,o=s?new mg(r,!0,!1):null;return function(e){return Ig(e.viewCache_)}(ym(i,t,Fg(e.pendingWriteTree_,t._path),s?o.getNode():Op.EMPTY_NODE,s))}function Lm(e,t){return Fm(t,e.syncPointTree_,null,Fg(e.pendingWriteTree_,Wf()))}function Fm(e,t,n,r){if(Xf(e.path))return Um(e,t,n,r);{const i=t.get(Wf());null==n&&null!=i&&(n=bm(i,Wf()));let s=[];const o=Kf(e.path),a=e.operationForChild(o),c=t.children.get(o);if(c&&a){const e=n?n.getImmediateChild(o):null,t=Qg(r,o);s=s.concat(Fm(a,c,e,t))}return i&&(s=s.concat(mm(i,e,r,n))),s}}function Um(e,t,n,r){const i=t.get(Wf());null==n&&null!=i&&(n=bm(i,Wf()));let s=[];return t.children.inorderTraversal(((t,i)=>{const o=n?n.getImmediateChild(t):null,a=Qg(r,t),c=e.operationForChild(t);c&&(s=s.concat(Um(c,i,o,a)))})),i&&(s=s.concat(mm(i,e,r,n))),s}function qm(e,t){const n=t.query,r=jm(e,n);return{hashFn:()=>(function(e){return e.viewCache_.serverCache.getNode()}(t)||Op.EMPTY_NODE).hash(),onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=Bm(e,n);if(r){const n=$m(r),i=n.path,s=n.queryId,o=Zf(i,t);return Wm(e,i,new fg(hg(s),o))}return[]}(e,n._path,r):function(e,t){return Lm(e,new fg({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return xm(e,n,null,r)}}}}function jm(e,t){const n=Vm(t);return e.queryToTagMap.get(n)}function Vm(e){return e._path.toString()+"$"+e._queryIdentifier}function Bm(e,t){return e.tagToQueryMap.get(t)}function $m(e){const t=e.indexOf("$");return No(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new $f(e.substr(0,t))}}function Wm(e,t,n){const r=e.syncPointTree_.get(t);No(r,"Missing sync point for query tag that we're tracking");return mm(r,n,Fg(e.pendingWriteTree_,t),null)}function Km(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(No(pm,"Reference.ts has not been loaded"),pm)(e._repo,e._path):e}class zm{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new zm(t)}node(){return this.node_}}class Hm{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Jf(this.path_,e);return new Hm(this.syncTree_,t)}node(){return Om(this.syncTree_,this.path_)}}const Gm=function(e,t,n){return e&&"object"==typeof e?(No(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Qm(e[".sv"],t,n):"object"==typeof e[".sv"]?Ym(e[".sv"],t):void No(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Qm=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:No(!1,"Unexpected server value: "+e)}},Ym=function(e,t,n){e.hasOwnProperty("increment")||No(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!=typeof r&&No(!1,"Unexpected increment value: "+r);const i=t.node();if(No(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const s=i.getValue();return"number"!=typeof s?r:s+r},Jm=function(e,t,n,r){return Zm(t,new Hm(n,e),r)},Xm=function(e,t,n){return Zm(e,new zm(t),n)};function Zm(e,t,n){const r=e.getPriority().val(),i=Gm(r,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const r=e,s=Gm(r.getValue(),t,n);return s!==r.getValue()||i!==r.getPriority().val()?new Sp(s,Lp(i)):e}{const r=e;return s=r,i!==r.getPriority().val()&&(s=s.updatePriority(new Sp(i))),r.forEachChild(Cp,((e,r)=>{const i=Zm(r,t.getImmediateChild(e),n);i!==r&&(s=s.updateImmediateChild(e,i))})),s}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ey{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function ty(e,t){let n=t instanceof $f?t:new $f(t),r=e,i=Kf(n);for(;null!==i;){const e=sa(r.node.children,i)||{children:{},childCount:0};r=new ey(i,r,e),n=Hf(n),i=Kf(n)}return r}function ny(e){return e.node.value}function ry(e,t){e.node.value=t,cy(e)}function iy(e){return e.node.childCount>0}function sy(e,t){df(e.node.children,((n,r)=>{t(new ey(n,e,r))}))}function oy(e,t,n,r){n&&!r&&t(e),sy(e,(e=>{oy(e,t,!0,r)})),n&&r&&t(e)}function ay(e){return new $f(null===e.parent?e.name:ay(e.parent)+"/"+e.name)}function cy(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===ny(e)&&!iy(e)}(n),i=ia(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,cy(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,cy(e))}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e.parent,e.name,e)}const uy=/[\[\].#$\/\u0000-\u001F\u007F]/,ly=/[\[\].#$\u0000-\u001F\u007F]/,hy=10485760,dy=function(e){return"string"==typeof e&&0!==e.length&&!uy.test(e)},fy=function(e){return"string"==typeof e&&0!==e.length&&!ly.test(e)},py=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!rf(e)||e&&"object"==typeof e&&ia(e,".sv")},gy=function(e,t,n,r){r&&void 0===t||my(ma(e,"value"),t,n)},my=function(e,t,n){const r=n instanceof $f?new rp(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+sp(r));if("function"==typeof t)throw new Error(e+"contains a function "+sp(r)+" with contents = "+t.toString());if(rf(t))throw new Error(e+"contains "+t.toString()+" "+sp(r));if("string"==typeof t&&t.length>hy/3&&wa(t)>hy)throw new Error(e+"contains a string greater than "+"10485760 utf8 bytes "+sp(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(df(t,((t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!dy(t)))throw new Error(e+" contains an invalid key ("+t+") "+sp(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=wa(t),ip(e)}(r,t),my(e,s,r),function(e){const t=e.parts_.pop();e.byteLength_-=wa(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+sp(r)+" in addition to actual children.")}},yy=function(e,t,n,r){if(r&&void 0===t)return;const i=ma(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const s=[];df(t,((e,t)=>{const r=new $f(e);if(my(i,t,Jf(n,r)),".priority"===Gf(r)&&!py(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(r)})),function(e,t){let n,r;for(n=0;n<t.length;n++){r=t[n];const i=Qf(r);for(let t=0;t<i.length;t++)if(".priority"===i[t]&&t===i.length-1);else if(!dy(i[t]))throw new Error(e+"contains an invalid key ("+i[t]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(ep);let i=null;for(n=0;n<t.length;n++){if(r=t[n],null!==i&&np(i,r))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},_y=function(e,t,n){if(!n||void 0!==t){if(rf(t))throw new Error(ma(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!py(t))throw new Error(ma(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},vy=function(e,t,n,r){if(!(r&&void 0===n||dy(n)))throw new Error(ma(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},wy=function(e,t,n,r){if(!(r&&void 0===n||fy(n)))throw new Error(ma(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},by=function(e,t){if(".info"===Kf(t))throw new Error(e+" failed = Can't modify data under /.info/")},Iy=function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!dy(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),fy(e)}(n))throw new Error(ma(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Ty{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Ey(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();null===n||tp(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)}function Sy(e,t,n){Ey(e,n),ky(e,(e=>tp(e,t)))}function Cy(e,t,n){Ey(e,n),ky(e,(e=>np(e,t)||np(t,e)))}function ky(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];if(i){t(i.path)?(Ry(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function Ry(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();Qd&&Xd("event: "+n.toString()),_f(r)}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Ny="repo_interrupt";class Ay{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ty,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=ig(),this.transactionQueueTree_=new ey,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Py(e,t,n){if(e.stats_=Pf(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new ng(e.repoInfo_,((t,n,r,i)=>{Oy(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>My(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ea(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new cp(e.repoInfo_,t,((t,n,r,i)=>{Oy(e,t,n,r,i)}),(t=>{My(e,t)}),(t=>{!function(e,t){df(t,((t,n)=>{Ly(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const n=e.toString();return Af[n]||(Af[n]=t()),Af[n]}(e.repoInfo_,(()=>new ug(e.stats_,e.server_))),e.infoData_=new rg,e.infoSyncTree_=new km({startListening:(t,n,r,i)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=Pm(e.infoSyncTree_,t._path,o),setTimeout((()=>{i("ok")}),0)),s},stopListening:()=>{}}),Ly(e,"connected",!1),e.serverSyncTree_=new km({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const s=i(n,r);Cy(e.eventQueue_,t._path,s)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function xy(e){const t=e.infoData_.getNode(new $f(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Dy(e){return function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e}({timestamp:xy(e)})}function Oy(e,t,n,r,i){e.dataUpdateCount++;const s=new $f(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(i)if(r){const t=aa(n,(e=>Lp(e)));o=function(e,t,n,r){const i=Bm(e,r);if(i){const r=$m(i),s=r.path,o=r.queryId,a=Zf(s,t),c=Sg.fromObject(n);return Wm(e,s,new gg(hg(o),a,c))}return[]}(e.serverSyncTree_,s,t,i)}else{const t=Lp(n);o=function(e,t,n,r){const i=Bm(e,r);if(null!=i){const r=$m(i),s=r.path,o=r.queryId,a=Zf(s,t);return Wm(e,s,new pg(hg(o),a,n))}return[]}(e.serverSyncTree_,s,t,i)}else if(r){const t=aa(n,(e=>Lp(e)));o=function(e,t,n){const r=Sg.fromObject(n);return Lm(e,new gg({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,s,t)}else{const t=Lp(n);o=Pm(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=Hy(e,s)),Cy(e.eventQueue_,a,o)}function My(e,t){Ly(e,"connected",t),!1===t&&function(e){$y(e,"onDisconnectEvents");const t=Dy(e),n=ig();ag(e.onDisconnect_,Wf(),((r,i)=>{const s=Jm(r,i,e.serverSyncTree_,t);sg(n,r,s)}));let r=[];ag(n,Wf(),((t,n)=>{r=r.concat(Pm(e.serverSyncTree_,t,n));const i=Xy(e,t);Hy(e,i)})),e.onDisconnect_=ig(),Cy(e.eventQueue_,Wf(),r)}(e)}function Ly(e,t,n){const r=new $f("/.info/"+t),i=Lp(n);e.infoData_.updateSnapshot(r,i);const s=Pm(e.infoSyncTree_,r,i);Cy(e.eventQueue_,r,s)}function Fy(e){return e.nextWriteId_++}function Uy(e,t,n,r,i){$y(e,"set",{path:t.toString(),value:n,priority:r});const s=Dy(e),o=Lp(n,r),a=Om(e.serverSyncTree_,t),c=Xm(o,a,s),u=Fy(e),l=Rm(e.serverSyncTree_,t,c,u,!0);Ey(e.eventQueue_,l),e.server_.put(t.toString(),o.val(!0),((n,r)=>{const s="ok"===n;s||nf("set at "+t+" failed: "+n);const o=Am(e.serverSyncTree_,u,!s);Cy(e.eventQueue_,t,o),Wy(e,i,n,r)}));const h=Xy(e,t);Hy(e,h),Cy(e.eventQueue_,h,[])}function qy(e,t,n){e.server_.onDisconnectCancel(t.toString(),((r,i)=>{"ok"===r&&og(e.onDisconnect_,t),Wy(e,n,r,i)}))}function jy(e,t,n,r){const i=Lp(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),((n,s)=>{"ok"===n&&sg(e.onDisconnect_,t,i),Wy(e,r,n,s)}))}function Vy(e,t,n){let r;r=".info"===Kf(t._path)?xm(e.infoSyncTree_,t,n):xm(e.serverSyncTree_,t,n),Sy(e.eventQueue_,t._path,r)}function By(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Ny)}function $y(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Xd(n,...t)}function Wy(e,t,n,r){t&&_f((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let i=e;r&&(i+=": "+r);const s=new Error(i);s.code=e,t(s)}}))}function Ky(e,t,n){return Om(e.serverSyncTree_,t,n)||Op.EMPTY_NODE}function zy(e,t=e.transactionQueueTree_){if(t||Jy(e,t),ny(t)){const n=Qy(e,t);No(n.length>0,"Sending zero length transaction queue");n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),i=Ky(e,t,r);let s=i;const o=i.hash();for(let e=0;e<n.length;e++){const r=n[e];No(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;const i=Zf(t,r.path);s=s.updateChild(i,r.currentOutputSnapshotRaw)}const a=s.val(!0),c=t;e.server_.put(c.toString(),a,(r=>{$y(e,"transaction put response",{path:c.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(Am(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();Jy(e,ty(e.transactionQueueTree_,t)),zy(e,e.transactionQueueTree_),Cy(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)_f(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{nf("transaction at "+c.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}Hy(e,t)}}),o)}(e,ay(t),n)}else iy(t)&&sy(t,(t=>{zy(e,t)}))}function Hy(e,t){const n=Gy(e,t),r=ay(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const s=t.filter((e=>0===e.status)).map((e=>e.currentWriteId));for(let a=0;a<t.length;a++){const c=t[a],u=Zf(n,c.path);let l,h=!1;if(No(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)h=!0,l=c.abortReason,i=i.concat(Am(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=25)h=!0,l="maxretry",i=i.concat(Am(e.serverSyncTree_,c.currentWriteId,!0));else{const n=Ky(e,c.path,s);c.currentInputSnapshot=n;const r=t[a].update(n.val());if(void 0!==r){my("transaction failed: Data returned ",r,c.path);let t=Lp(r);"object"==typeof r&&null!=r&&ia(r,".priority")||(t=t.updatePriority(n.getPriority()));const o=c.currentWriteId,a=Dy(e),u=Xm(t,n,a);c.currentOutputSnapshotRaw=t,c.currentOutputSnapshotResolved=u,c.currentWriteId=Fy(e),s.splice(s.indexOf(o),1),i=i.concat(Rm(e.serverSyncTree_,c.path,u,c.currentWriteId,c.applyLocally)),i=i.concat(Am(e.serverSyncTree_,o,!0))}else h=!0,l="nodata",i=i.concat(Am(e.serverSyncTree_,c.currentWriteId,!0))}Cy(e.eventQueue_,n,i),i=[],h&&(t[a].status=2,o=t[a].unwatcher,setTimeout(o,Math.floor(0)),t[a].onComplete&&("nodata"===l?r.push((()=>t[a].onComplete(null,!1,t[a].currentInputSnapshot))):r.push((()=>t[a].onComplete(new Error(l),!1,null)))))}var o;Jy(e,e.transactionQueueTree_);for(let e=0;e<r.length;e++)_f(r[e]);zy(e,e.transactionQueueTree_)}(e,Qy(e,n),r),r}function Gy(e,t){let n,r=e.transactionQueueTree_;for(n=Kf(t);null!==n&&void 0===ny(r);)r=ty(r,n),n=Kf(t=Hf(t));return r}function Qy(e,t){const n=[];return Yy(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function Yy(e,t,n){const r=ny(t);if(r)for(let e=0;e<r.length;e++)n.push(r[e]);sy(t,(t=>{Yy(e,t,n)}))}function Jy(e,t){const n=ny(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,ry(t,n.length>0?n:void 0)}sy(t,(t=>{Jy(e,t)}))}function Xy(e,t){const n=ay(Gy(e,t)),r=ty(e.transactionQueueTree_,t);return function(e,t,n){let r=n?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{Zy(e,t)})),Zy(e,r),oy(r,(t=>{Zy(e,t)})),n}function Zy(e,t){const n=ny(t);if(n){const r=[];let i=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(No(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):(No(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(Am(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?ry(t,void 0):n.length=s+1,Cy(e.eventQueue_,ay(t),i);for(let e=0;e<r.length;e++)_f(r[e])}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const e_=function(e,t){const n=t_(e),r=n.namespace;"firebase.com"===n.domain&&tf(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||tf("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&nf("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Cf(n.host,n.secure,r,t,i,"",r!==n.subdomain),path:new $f(n.pathString)}},t_=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",c=443;if("string"==typeof e){let u=e.indexOf("//");u>=0&&(a=e.substring(0,u-1),e=e.substring(u+2));let l=e.indexOf("/");-1===l&&(l=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(l,h)),l<h&&(i=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let r=n[e];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}t+="/"+r}return t}(e.substring(l,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):nf(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));u=t.indexOf(":"),u>=0?(o="https"===a||"wss"===a,c=parseInt(t.substring(u+1),10)):u=t.length;const f=t.slice(0,u);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=r}"ns"in d&&(s=d.ns)}return{host:t,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class n_{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ea(this.snapshot.exportVal())}}class r_{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class i_{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return No(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class s_{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new Fo;return qy(this._repo,this._path,e.wrapCallback((()=>{}))),e.promise}remove(){by("OnDisconnect.remove",this._path);const e=new Fo;return jy(this._repo,this._path,null,e.wrapCallback((()=>{}))),e.promise}set(e){by("OnDisconnect.set",this._path),gy("OnDisconnect.set",e,this._path,!1);const t=new Fo;return jy(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}setWithPriority(e,t){by("OnDisconnect.setWithPriority",this._path),gy("OnDisconnect.setWithPriority",e,this._path,!1),_y("OnDisconnect.setWithPriority",t,!1);const n=new Fo;return function(e,t,n,r,i){const s=Lp(n,r);e.server_.onDisconnectPut(t.toString(),s.val(!0),((n,r)=>{"ok"===n&&sg(e.onDisconnect_,t,s),Wy(0,i,n,r)}))}(this._repo,this._path,e,t,n.wrapCallback((()=>{}))),n.promise}update(e){by("OnDisconnect.update",this._path),yy("OnDisconnect.update",e,this._path,!1);const t=new Fo;return function(e,t,n,r){if(oa(n))return Xd("onDisconnect().update() called with empty data.  Don't do anything."),void Wy(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,((i,s)=>{"ok"===i&&df(n,((n,r)=>{const i=Lp(r);sg(e.onDisconnect_,Jf(t,n),i)})),Wy(0,r,i,s)}))}(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class o_{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return Xf(this._path)?null:Gf(this._path)}get ref(){return new l_(this._repo,this._path)}get _queryIdentifier(){const e=tg(this._queryParams),t=lf(e);return"{}"===t?"default":t}get _queryObject(){return tg(this._queryParams)}isEqual(e){if(!((e=Ia(e))instanceof o_))return!1;const t=this._repo===e._repo,n=tp(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}function a_(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function c_(e){let t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===fp){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==sf)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==of)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===Cp){if(null!=t&&!py(t)||null!=n&&!py(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(No(e.getIndex()instanceof Fp||e.getIndex()===Up,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function u_(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class l_ extends o_{constructor(e,t){super(e,t,new Yp,!1)}get parent(){const e=Yf(this._path);return null===e?null:new l_(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class h_{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new $f(e),n=p_(this.ref,e);return new h_(this._node.getChild(t),n,Cp)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((t,n)=>e(new h_(n,p_(this.ref,t),Cp))))}hasChild(e){const t=new $f(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function d_(e,t){return(e=Ia(e))._checkNotDeleted("ref"),void 0!==t?p_(e._root,t):e._root}function f_(e,t){(e=Ia(e))._checkNotDeleted("refFromURL");const n=e_(t,e._repo.repoInfo_.nodeAdmin);Iy("refFromURL",n);const r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||tf("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),d_(e,n.path.toString())}function p_(e,t){var n,r,i,s;return null===Kf((e=Ia(e))._path)?(n="child",r="path",s=!1,(i=t)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),wy(n,r,i,s)):wy("child","path",t,!1),new l_(e._repo,Jf(e._path,t))}function g_(e,t){e=Ia(e),by("set",e._path),gy("set",t,e._path,!1);const n=new Fo;return Uy(e._repo,e._path,t,null,n.wrapCallback((()=>{}))),n.promise}function m_(e,t){yy("update",t,e._path,!1);const n=new Fo;return function(e,t,n,r){$y(e,"update",{path:t.toString(),value:n});let i=!0;const s=Dy(e),o={};if(df(n,((n,r)=>{i=!1,o[n]=Jm(Jf(t,n),Lp(r),e.serverSyncTree_,s)})),i)Xd("update() called with empty data.  Don't do anything."),Wy(0,r,"ok",void 0);else{const i=Fy(e),s=Nm(e.serverSyncTree_,t,o,i);Ey(e.eventQueue_,s),e.server_.merge(t.toString(),n,((n,s)=>{const o="ok"===n;o||nf("update at "+t+" failed: "+n);const a=Am(e.serverSyncTree_,i,!o),c=a.length>0?Hy(e,t):t;Cy(e.eventQueue_,c,a),Wy(0,r,n,s)})),df(n,(n=>{const r=Xy(e,Jf(t,n));Hy(e,r)})),Cy(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((()=>{}))),n.promise}function y_(e){return function(e,t){const n=Mm(e.serverSyncTree_,t);return null!=n?Promise.resolve(n):e.server_.get(t).then((n=>{const r=Lp(n).withIndex(t._queryParams.getIndex()),i=Pm(e.serverSyncTree_,t._path,r);return Sy(e.eventQueue_,t._path,i),Promise.resolve(r)}),(n=>($y(e,"get for query "+ea(t)+" failed: "+n),Promise.reject(new Error(n)))))}((e=Ia(e))._repo,e).then((t=>new h_(t,new l_(e._repo,e._path),e._queryParams.getIndex())))}class __{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new n_("value",this,new h_(e.snapshotNode,new l_(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new r_(this,e,t):null}matches(e){return e instanceof __&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class v_{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new r_(this,e,t):null}createEvent(e,t){No(null!=e.childName,"Child events should have a childName.");const n=p_(new l_(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new n_(e.type,this,new h_(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof v_&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function w_(e,t,n,r,i){let s;if("object"==typeof r&&(s=void 0,i=r),"function"==typeof r&&(s=r),i&&i.onlyOnce){const t=n,r=(n,r)=>{Vy(e._repo,e,a),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const o=new i_(n,s||void 0),a="value"===t?new __(o):new v_(t,o);return function(e,t,n){let r;r=".info"===Kf(t._path)?Dm(e.infoSyncTree_,t,n):Dm(e.serverSyncTree_,t,n),Sy(e.eventQueue_,t._path,r)}(e._repo,e,a),()=>Vy(e._repo,e,a)}function b_(e,t,n,r){return w_(e,"value",t,n,r)}function I_(e,t,n,r){return w_(e,"child_added",t,n,r)}function T_(e,t,n,r){return w_(e,"child_changed",t,n,r)}function E_(e,t,n,r){return w_(e,"child_moved",t,n,r)}function S_(e,t,n,r){return w_(e,"child_removed",t,n,r)}function C_(e,t,n){let r=null;const i=n?new i_(n):null;"value"===t?r=new __(i):t&&(r=new v_(t,i)),Vy(e._repo,e,r)}class k_{}class R_ extends k_{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){gy("endAt",this._value,e._path,!0);const t=Xp(e._queryParams,this._value,this._key);if(u_(t),c_(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new o_(e._repo,e._path,t,e._orderByCalled)}}class N_ extends k_{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){gy("endBefore",this._value,e._path,!1);const t=function(e,t,n){let r,i;return e.index_===fp?("string"==typeof t&&(t=Bp(t)),i=Xp(e,t,n)):(r=null==n?sf:Bp(n),i=Xp(e,t,r)),i.endBeforeSet_=!0,i}(e._queryParams,this._value,this._key);if(u_(t),c_(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new o_(e._repo,e._path,t,e._orderByCalled)}}class A_ extends k_{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){gy("startAt",this._value,e._path,!0);const t=Jp(e._queryParams,this._value,this._key);if(u_(t),c_(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new o_(e._repo,e._path,t,e._orderByCalled)}}class P_ extends k_{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){gy("startAfter",this._value,e._path,!1);const t=function(e,t,n){let r;if(e.index_===fp)"string"==typeof t&&(t=Vp(t)),r=Jp(e,t,n);else{let i;i=null==n?of:Vp(n),r=Jp(e,t,i)}return r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(u_(t),c_(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new o_(e._repo,e._path,t,e._orderByCalled)}}class x_ extends k_{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new o_(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}class D_ extends k_{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new o_(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}class O_ extends k_{constructor(e){super(),this._path=e}_apply(e){a_(e,"orderByChild");const t=new $f(this._path);if(Xf(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const n=new Fp(t),r=Zp(e._queryParams,n);return c_(r),new o_(e._repo,e._path,r,!0)}}class M_ extends k_{_apply(e){a_(e,"orderByKey");const t=Zp(e._queryParams,fp);return c_(t),new o_(e._repo,e._path,t,!0)}}class L_ extends k_{_apply(e){a_(e,"orderByPriority");const t=Zp(e._queryParams,Cp);return c_(t),new o_(e._repo,e._path,t,!0)}}class F_ extends k_{_apply(e){a_(e,"orderByValue");const t=Zp(e._queryParams,Up);return c_(t),new o_(e._repo,e._path,t,!0)}}class U_ extends k_{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(gy("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new R_(this._value,this._key)._apply(new A_(this._value,this._key)._apply(e))}}function q_(e,...t){let n=Ia(e);for(const e of t)n=e._apply(n);return n}!function(e){No(!fm,"__referenceConstructor has already been defined"),fm=e}(l_),function(e){No(!pm,"__referenceConstructor has already been defined"),pm=e}(l_);
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const j_={};function V_(e,t,n,r,i){let s=r||e.options.databaseURL;void 0===s&&(e.options.projectId||tf("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Xd("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o,a,c=e_(s,i),u=c.repoInfo;"undefined"!=typeof process&&(a=process.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,s=`http://${a}?ns=${u.namespace}`,c=e_(s,i),u=c.repoInfo):o=!c.repoInfo.secure;const l=i&&o?new If(If.OWNER):new bf(e.name,e.options,t);Iy("Invalid Firebase Database URL",c),Xf(c.path)||tf("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,r){let i=j_[t.name];i||(i={},j_[t.name]=i);let s=i[e.toURLString()];s&&tf("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new Ay(e,false,n,r),i[e.toURLString()]=s,s}(u,e,l,new wf(e.name,n));return new B_(h,e)}class B_{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Py(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new l_(this._repo,Wf())),this._rootInternal}_delete(){return this._checkNotDeleted("delete"),function(e,t){const n=j_[t];n&&n[e.key]===e||tf(`Database ${t}(${e.repoInfo_}) has already been deleted.`),By(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null,Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&tf("Cannot call "+e+" on a deleted database.")}}function $_(e,t,n,r={}){(e=Ia(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&tf("Cannot call useEmulator() after instance has already been initialized.");const i=e._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&tf('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new If(If.OWNER);else if(r.mockUserToken){const t=Uo(r.mockUserToken,e.app.options.projectId);s=new If(t)}!function(e,t,n,r){e.repoInfo_=new Cf(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),r&&(e.authTokenProvider_=r)}(i,t,n,s)}function W_(e){var t;(e=Ia(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume(Ny)}function K_(e,t){Jd(e,t)}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const z_={".sv":"timestamp"};
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class H_{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function G_(e,t,n){var r;if(e=Ia(e),by("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";const i=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,s=new Fo,o=b_(e,(()=>{}));return function(e,t,n,r,i,s){$y(e,"transaction on "+t);const o={path:t,update:n,onComplete:r,status:null,order:zd(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=Ky(e,t,void 0);o.currentInputSnapshot=a;const c=o.update(a.val());if(void 0===c)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{my("transaction failed: Data returned ",c,o.path),o.status=0;const n=ty(e.transactionQueueTree_,t),r=ny(n)||[];let i;r.push(o),ry(n,r),"object"==typeof c&&null!==c&&ia(c,".priority")?(i=sa(c,".priority"),No(py(i),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):i=(Om(e.serverSyncTree_,t)||Op.EMPTY_NODE).getPriority().val();const s=Dy(e),u=Lp(c,i),l=Xm(u,a,s);o.currentOutputSnapshotRaw=u,o.currentOutputSnapshotResolved=l,o.currentWriteId=Fy(e);const h=Rm(e.serverSyncTree_,t,l,o.currentWriteId,o.applyLocally);Cy(e.eventQueue_,t,h),zy(e,e.transactionQueueTree_)}}(e._repo,e._path,t,((t,n,r)=>{let i=null;t?s.reject(t):(i=new h_(r,new l_(e._repo,e._path),Cp),s.resolve(new H_(n,i)))}),o,i),s.promise}!function(e){!function(e){qd=e}(Ga),Wa(new Ta("database-exp",((e,{instanceIdentifier:t})=>V_(e.getProvider("app-exp").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),Ja("@firebase/database","0.0.900-exp.57f19127c",e)}();
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Q_{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ea(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Zo(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Y_{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return ia(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const J_=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Q_(t)}}catch(e){}return new Y_},X_=J_("localStorage"),Z_=J_("sessionStorage"),ev=new Oa("@firebase/database"),tv=function(){let e=1;return function(){return e++}}(),nv=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=nv.apply(null,r):t+="object"==typeof r?ea(r):r,t+=" "}return t};let rv=null,iv=!0;const sv=function(...e){var t,n;if(!0===iv&&(iv=!1,null===rv&&!0===Z_.get("logging_enabled")&&(t=!0,No(!n||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(ev.logLevel=ka.VERBOSE,rv=ev.log.bind(ev),n&&Z_.set("logging_enabled",!0)):"function"==typeof t?rv=t:(rv=null,Z_.remove("logging_enabled")))),rv){const t=nv.apply(null,e);rv(t)}},ov=function(e){return function(...t){sv(e,...t)}},av=function(...e){const t="FIREBASE INTERNAL ERROR: "+nv(...e);ev.error(t)},cv=function(...e){const t="FIREBASE WARNING: "+nv(...e);ev.warn(t)},uv="[MIN_NAME]",lv="[MAX_NAME]",hv=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+ea(t))},dv=function(e){if("object"!=typeof e||null===e)return ea(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=ea(t[r]),n+=":",n+=dv(e[t[r]]);return n+="}",n},fv=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function pv(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const gv=function(e){No(!function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)}(e),"Invalid JSON number");const t=1023;let n,r,i,s,o;0===e?(r=0,i=0,n=1/e==-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(e)/Math.LN2),t),r=s+t,i=Math.round(e*Math.pow(2,52-s)-Math.pow(2,52))):(r=0,i=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(o=11;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);a.push(n?1:0),a.reverse();const c=a.join("");let u="";for(o=0;o<64;o+=8){let e=parseInt(c.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),u+=e}return u.toLowerCase()},mv=new RegExp("^-?(0*)\\d{1,10}$"),yv=function(e){if(mv.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},_v=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw cv("Exception was thrown by user callback.",t),e}),Math.floor(0))}},vv=function(e,t){const n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class wv{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function bv(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Iv=/[\[\].#$\u0000-\u001F\u007F]/,Tv=function(e,t,n,r){if(!(r&&void 0===n||function(e){return"string"==typeof e&&0!==e.length&&!Iv.test(e)}(n)))throw new Error(ma(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Ev=function(e,t){if(".info"===bv(t))throw new Error(e+" failed = Can't modify data under /.info/")};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Sv{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Sv(e,t)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let Cv;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let kv;class Rv{constructor(e,t=Rv.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,No(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),function(e){if(e.isLeafNode()){const t=e.val();No("string"==typeof t||"number"==typeof t||"object"==typeof t&&ia(t,".sv"),"Priority must be a string or number.")}else No(e===Cv||e.isEmpty(),"priority of unexpected type.");No(e===Cv||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")}(this.priorityNode_)}static set __childrenNodeConstructor(e){kv=e}static get __childrenNodeConstructor(){return kv}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Rv(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:Rv.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return function(e){return e.pieceNum_>=e.pieces_.length}(e)?this:".priority"===bv(e)?this.priorityNode_:Rv.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Rv.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=bv(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(No(".priority"!==n||1===function(e){return e.pieces_.length-e.pieceNum_}(e),".priority must be the last token in a path"),this.updateImmediateChild(n,Rv.__childrenNodeConstructor.EMPTY_NODE.updateChild(function(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new wv(e.pieces_,t)}(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+(("number"==typeof(e=this.priorityNode_.val())?"number:"+gv(e):"string:"+e)+":"));const n=typeof this.value_;t+=n+":",t+="number"===n?gv(this.value_):this.value_,this.lazyHash_=function(e){const t=va(e),n=new ha;n.update(t);const r=n.digest();return xo.encodeByteArray(r)}(t)}var e;return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Rv.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Rv.__childrenNodeConstructor?-1:(No(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=Rv.VALUE_TYPE_ORDER.indexOf(t),i=Rv.VALUE_TYPE_ORDER.indexOf(n);return No(r>=0,"Unknown leaf type: "+t),No(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}Rv.VALUE_TYPE_ORDER=["object","boolean","number","string"];const Nv=new class extends class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Sv(uv,e),r=new Sv(uv,t);return 0!==this.compare(n,r)}minPost(){return Sv.MIN}}{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?function(e,t){if(e===t)return 0;if(e===uv||t===lv)return-1;if(t===uv||e===lv)return 1;{const n=yv(e),r=yv(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}}(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Sv.MIN}maxPost(){return new Sv(lv,new Rv("[PRIORITY-POST]",undefined))}makePost(e,t){const n=undefined();return new Sv(t,new Rv("[PRIORITY-POST]",n))}toString(){return".priority"}};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Av{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Nv}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return No(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return No(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:uv}hasEnd(){return this.endSet_}getIndexEndValue(){return No(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return No(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:lv}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return No(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Nv}copy(){const e=new Av;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Pv{constructor(e){this._delegate=e}cancel(e){ga("OnDisconnect.cancel",0,1,arguments.length),ya("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then((()=>e(null)),(t=>e(t))),t}remove(e){ga("OnDisconnect.remove",0,1,arguments.length),ya("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then((()=>e(null)),(t=>e(t))),t}set(e,t){ga("OnDisconnect.set",1,2,arguments.length),ya("OnDisconnect.set","onComplete",t,!0);const n=this._delegate.set(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){ga("OnDisconnect.setWithPriority",2,3,arguments.length),ya("OnDisconnect.setWithPriority","onComplete",n,!0);const r=this._delegate.setWithPriority(e,t);return n&&r.then((()=>n(null)),(e=>n(e))),r}update(e,t){if(ga("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,cv("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ya("OnDisconnect.update","onComplete",t,!0);const n=this._delegate.update(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class xv{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return ga("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Dv{constructor(e,t){this._database=e,this._delegate=t}val(){return ga("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ga("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ga("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ga("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ga("DataSnapshot.child",0,1,arguments.length),e=String(e),Tv("DataSnapshot.child","path",e,!1),new Dv(this._database,this._delegate.child(e))}hasChild(e){return ga("DataSnapshot.hasChild",1,1,arguments.length),Tv("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return ga("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ga("DataSnapshot.forEach",1,1,arguments.length),ya("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((t=>e(new Dv(this._database,t))))}hasChildren(){return ga("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ga("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ga("DataSnapshot.ref",0,0,arguments.length),new Mv(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Ov{constructor(e,t){this.database=e,this._delegate=t}on(e,t,n,r){var i;ga("Query.on",2,4,arguments.length),ya("Query.on","callback",t,!1);const s=Ov.getCancelAndContextArgs_("Query.on",n,r),o=(e,n)=>{t.call(s.context,new Dv(this.database,e),n)};o.userCallback=t,o.context=s.context;const a=null===(i=s.cancel)||void 0===i?void 0:i.bind(s.context);switch(e){case"value":return b_(this._delegate,o,a),t;case"child_added":return I_(this._delegate,o,a),t;case"child_removed":return S_(this._delegate,o,a),t;case"child_changed":return T_(this._delegate,o,a),t;case"child_moved":return E_(this._delegate,o,a),t;default:throw new Error(ma("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,n){if(ga("Query.off",0,3,arguments.length),function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(ma(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}("Query.off",e,!0),ya("Query.off","callback",t,!0),_a("Query.off","context",n,!0),t){const r=()=>{};r.userCallback=t,r.context=n,C_(this._delegate,e,r)}else C_(this._delegate,e)}get(){return y_(this._delegate).then((e=>new Dv(this.database,e)))}once(e,t,n,r){ga("Query.once",1,4,arguments.length),ya("Query.once","callback",t,!0);const i=Ov.getCancelAndContextArgs_("Query.once",n,r),s=new Fo,o=(e,n)=>{const r=new Dv(this.database,e);t&&t.call(i.context,r,n),s.resolve(r)};o.userCallback=t,o.context=i.context;const a=e=>{i.cancel&&i.cancel.call(i.context,e),s.reject(e)};switch(e){case"value":b_(this._delegate,o,a,{onlyOnce:!0});break;case"child_added":I_(this._delegate,o,a,{onlyOnce:!0});break;case"child_removed":S_(this._delegate,o,a,{onlyOnce:!0});break;case"child_changed":T_(this._delegate,o,a,{onlyOnce:!0});break;case"child_moved":E_(this._delegate,o,a,{onlyOnce:!0});break;default:throw new Error(ma("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise}limitToFirst(e){return ga("Query.limitToFirst",1,1,arguments.length),new Ov(this.database,q_(this._delegate,function(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new x_(e)}(e)))}limitToLast(e){return ga("Query.limitToLast",1,1,arguments.length),new Ov(this.database,q_(this._delegate,function(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new D_(e)}(e)))}orderByChild(e){return ga("Query.orderByChild",1,1,arguments.length),new Ov(this.database,q_(this._delegate,function(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return wy("orderByChild","path",e,!1),new O_(e)}(e)))}orderByKey(){return ga("Query.orderByKey",0,0,arguments.length),new Ov(this.database,q_(this._delegate,new M_))}orderByPriority(){return ga("Query.orderByPriority",0,0,arguments.length),new Ov(this.database,q_(this._delegate,new L_))}orderByValue(){return ga("Query.orderByValue",0,0,arguments.length),new Ov(this.database,q_(this._delegate,new F_))}startAt(e=null,t){return ga("Query.startAt",0,2,arguments.length),new Ov(this.database,q_(this._delegate,function(e=null,t){return vy("startAt","key",t,!0),new A_(e,t)}(e,t)))}startAfter(e=null,t){return ga("Query.startAfter",0,2,arguments.length),new Ov(this.database,q_(this._delegate,function(e,t){return vy("startAfter","key",t,!0),new P_(e,t)}(e,t)))}endAt(e=null,t){return ga("Query.endAt",0,2,arguments.length),new Ov(this.database,q_(this._delegate,function(e,t){return vy("endAt","key",t,!0),new R_(e,t)}(e,t)))}endBefore(e=null,t){return ga("Query.endBefore",0,2,arguments.length),new Ov(this.database,q_(this._delegate,function(e,t){return vy("endBefore","key",t,!0),new N_(e,t)}(e,t)))}equalTo(e,t){return ga("Query.equalTo",1,2,arguments.length),new Ov(this.database,q_(this._delegate,function(e,t){return vy("equalTo","key",t,!0),new U_(e,t)}(e,t)))}toString(){return ga("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ga("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ga("Query.isEqual",1,1,arguments.length),!(e instanceof Ov)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,n){const r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,ya(e,"cancel",r.cancel,!0),r.context=n,_a(e,"context",r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(ma(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r}get ref(){return new Mv(this.database,new l_(this._delegate._repo,this._delegate._path))}}class Mv extends Ov{constructor(e,t){super(e,new o_(t._repo,t._path,new Av,!1)),this.database=e,this._delegate=t}getKey(){return ga("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ga("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new Mv(this.database,p_(this._delegate,e))}getParent(){ga("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Mv(this.database,e):null}getRoot(){return ga("Reference.root",0,0,arguments.length),new Mv(this.database,this._delegate.root)}set(e,t){ga("Reference.set",1,2,arguments.length),ya("Reference.set","onComplete",t,!0);const n=g_(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}update(e,t){if(ga("Reference.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,cv("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Ev("Reference.update",this._delegate._path),ya("Reference.update","onComplete",t,!0);const n=m_(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){ga("Reference.setWithPriority",2,3,arguments.length),ya("Reference.setWithPriority","onComplete",n,!0);const r=function(e,t,n){if(by("setWithPriority",e._path),gy("setWithPriority",t,e._path,!1),_y("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";const r=new Fo;return Uy(e._repo,e._path,t,n,r.wrapCallback((()=>{}))),r.promise}(this._delegate,e,t);return n&&r.then((()=>n(null)),(e=>n(e))),r}remove(e){ga("Reference.remove",0,1,arguments.length),ya("Reference.remove","onComplete",e,!0);const t=function(e){return by("remove",e._path),g_(e,null)}(this._delegate);return e&&t.then((()=>e(null)),(t=>e(t))),t}transaction(e,t,n){ga("Reference.transaction",1,3,arguments.length),ya("Reference.transaction","transactionUpdate",e,!1),ya("Reference.transaction","onComplete",t,!0),function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(ma(e,t)+"must be a boolean.")}("Reference.transaction","applyLocally",n,!0);const r=G_(this._delegate,e,{applyLocally:n}).then((e=>new xv(e.committed,new Dv(this.database,e.snapshot))));return t&&r.then((e=>t(null,e.committed,e.snapshot)),(e=>t(e,!1,null))),r}setPriority(e,t){ga("Reference.setPriority",1,2,arguments.length),ya("Reference.setPriority","onComplete",t,!0);const n=function(e,t){e=Ia(e),by("setPriority",e._path),_y("setPriority",t,!1);const n=new Fo;return Uy(e._repo,Jf(e._path,".priority"),t,null,n.wrapCallback((()=>{}))),n.promise}(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}push(e,t){ga("Reference.push",0,2,arguments.length),ya("Reference.push","onComplete",t,!0);const n=function(e,t){e=Ia(e),by("push",e._path),gy("push",t,e._path,!0);const n=xy(e._repo),r=jp(n),i=p_(e,r),s=p_(e,r);let o;return o=null!=t?g_(s,t).then((()=>s)):Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}(this._delegate,e),r=n.then((e=>new Mv(this.database,e)));t&&r.then((()=>t(null)),(e=>t(e)));const i=new Mv(this.database,n);return i.then=r.then.bind(r),i.catch=r.catch.bind(r,void 0),i}onDisconnect(){return Ev("Reference.onDisconnect",this._delegate._path),new Pv(new s_(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Lv{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete()}}useEmulator(e,t,n={}){$_(this._delegate,e,t,n)}ref(e){if(ga("database.ref",0,1,arguments.length),e instanceof Mv){const t=f_(this._delegate,e.toString());return new Mv(this,t)}{const t=d_(this._delegate,e);return new Mv(this,t)}}refFromURL(e){ga("database.refFromURL",1,1,arguments.length);const t=f_(this._delegate,e);return new Mv(this,t)}goOffline(){return ga("database.goOffline",0,0,arguments.length),function(e){(e=Ia(e))._checkNotDeleted("goOffline"),By(e._repo)}(this._delegate)}goOnline(){return ga("database.goOnline",0,0,arguments.length),W_(this._delegate)}}Lv.ServerValue={TIMESTAMP:z_,increment:e=>function(e){return{".sv":{increment:e}}}(e)};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Fv=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Uv="websocket",qv="long_polling";function jv(e,t,n){let r;if(No("string"==typeof t,"typeof type must == string"),No("object"==typeof n,"typeof params must == object"),t===Uv)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==qv)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return pv(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Vv{constructor(){this.counters_={}}incrementCounter(e,t=1){ia(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Mo(this.counters_)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Bv={};function $v(e){const t=e.toString();return Bv[t]||(Bv[t]=new Vv),Bv[t]}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Wv{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&_v((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Kv="start";class zv{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ov(e),this.stats_=$v(t),this.urlFn=e=>(this.appCheckToken&&(e.ac=this.appCheckToken),jv(t,qv,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Wv(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new Hv(((...e)=>{const[t,n,r,i,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===Kv)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={start:"t"};e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&Fv.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){zv.forceAllow_=!0}static forceDisallow(){zv.forceDisallow_=!0}static isAvailable(){return!!zv.forceAllow_||!(zv.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=ea(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Do(t),r=fv(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=ea(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Hv{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=tv(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=Hv.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){sv("frame writing exception"),e.stack&&sv(e.stack),sv(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||sv("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{sv("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let Gv="";function Qv(e){Gv=e}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let Yv=null;"undefined"!=typeof MozWebSocket?Yv=MozWebSocket:"undefined"!=typeof WebSocket&&(Yv=WebSocket);class Jv{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ov(this.connId),this.stats_=$v(t),this.connURL=Jv.connectionURL_(t,s,o,r),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r){const i={v:"5"};return"undefined"!=typeof location&&location.hostname&&Fv.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),jv(e,Uv,i)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,X_.set("previous_websocket_failure",!0);try{if(Ko());else{const e={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new Yv(this.connURL,[],e)}}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){Jv.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==Yv&&!Jv.forceDisallow_}static previouslyFailed(){return X_.isInMemoryStorage||!0===X_.get("previous_websocket_failure")}markConnectionHealthy(){X_.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=Zo(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(No(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=ea(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=fv(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Jv.responsesRequiredToBeHealthy=2,Jv.healthyTimeout=3e4;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Xv{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[zv,Jv]}initTransports_(e){const t=Jv&&Jv.isAvailable();let n=t&&!Jv.previouslyFailed();if(e.webSocketOnly&&(t||cv("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Jv];else{const e=this.transports_=[];for(const t of Xv.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Zv{constructor(e,t,n,r,i,s,o,a,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ov("c:"+this.id+":"),this.transportManager_=new Xv(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=vv((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=hv("t",e),n=hv("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=hv("t",e),n=hv("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=hv("t",e);if("d"in e){const n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?av("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):av("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&cv("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),vv((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):vv((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(X_.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class ew{constructor(e){this.allowedEvents_=e,this.listeners_={},No(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){No(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class tw extends ew{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||jo()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new tw}getInitialEvent(e){return No("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class nw extends ew{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new nw}getInitialEvent(e){return No("visible"===e,"Unknown event type: "+e),[this.visible_]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const rw=1e3;class iw extends class{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=iw.nextPersistentConnectionId_++,this.log_=ov("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=rw,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!Ko())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");nw.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&tw.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(ea(i)),No(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new Fo,n={p:e._path.toString(),q:e._queryObject},r={action:"g",request:n,onComplete:e=>{const r=e.d;"ok"===e.s?(this.onDataUpdate_(n.p,r,!1,null),t.resolve(r)):t.reject(r)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_||setTimeout((()=>{const e=this.outstandingGets_[i];void 0!==e&&r===e&&(delete this.outstandingGets_[i],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+i+" timed out on connection"),t.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(i),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),No(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),No(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");const o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const s=i.d,o=i.s;iw.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&ia(e,"w")){const n=sa(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();cv(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||ra(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=na(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),No(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ea(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):av("Unrecognized action received from server: "+ea(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){No(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=rw,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=rw,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=rw),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+iw.nextConnectionId_++,i=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())},c=function(e){No(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:a,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,c]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);s?sv("getToken() completed but was canceled"):(sv("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=c&&c.token,o=new Zv(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{cv(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&cv(e),a())}}}interrupt(e){sv("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){sv("Resuming connection for reason: "+e),delete this.interruptReasons_[e],oa(this.interruptReasons_)&&(this.reconnectDelay_=rw,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>dv(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new wv(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){sv("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){sv("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};e["sdk.js."+Gv.replace(/\./g,"-")]=1,jo()?e["framework.cordova"]=1:$o()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=tw.getInstance().currentlyOnline();return oa(this.interruptReasons_)&&e}}iw.nextPersistentConnectionId_=0,iw.nextConnectionId_=0;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class sw{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&pv(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var ow=Object.freeze({__proto__:null,forceLongPolling:function(){Jv.forceDisallow(),zv.forceAllow()},forceWebSockets:function(){zv.forceDisallow()},isWebSocketsAvailable:function(){return Jv.isAvailable()},setSecurityDebugCallback:function(e,t){e._delegate._repo.persistentConnection_.securityDebugCallback_=t},stats:function(e,t){!function(e,t=!1){if("undefined"==typeof console)return;let n;t?(e.statsListener_||(e.statsListener_=new sw(e.stats_)),n=e.statsListener_.get()):n=e.stats_.get();const r=Object.keys(n).reduce(((e,t)=>Math.max(t.length,e)),0);pv(n,((e,t)=>{let n=e;for(let t=e.length;t<r+2;t++)n+=" ";console.log(n+t)}))}(e._delegate._repo,t)},statsIncrementCounter:function(e,t){!function(e,t){var n,r;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */e.stats_.incrementCounter(t),n=e.statsReporter_,r=t,n.statsToReport_[r]=!0}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e._delegate._repo,t)},dataUpdateCount:function(e){return e._delegate._repo.dataUpdateCount},interceptServerData:function(e,t){return function(e,t){e.interceptServerDataCallback_=t}(e._delegate._repo,t)},initStandalone:function({app:e,url:t,version:n,customAuthImpl:r,namespace:i,nodeAdmin:s=!1}){Qv(n);const o=new Sa("auth-internal",new Ra("database-standalone"));return o.setComponent(new Ta("auth-internal",(()=>r),"PRIVATE")),{instance:new Lv(V_(e,o,void 0,t,s),e),namespace:i}}});
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const aw=iw;iw.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},iw.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};const cw=Zv,uw=
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class{constructor(e,t,n,r,i=!1,s="",o=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=X_.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&X_.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};var lw=Object.freeze({__proto__:null,DataConnection:aw,RealTimeConnection:cw,hijackHash:function(e){const t=iw.prototype.put;return iw.prototype.put=function(n,r,i,s){void 0!==s&&(s=e()),t.call(this,n,r,i,s)},function(){iw.prototype.put=t}},ConnectionTarget:uw,queryIdentifier:function(e){return e._delegate._queryIdentifier},forceRestClient:function(e){}});const hw=Lv.ServerValue;!function(e){Qv(e.SDK_VERSION),e.INTERNAL.registerComponent(new Ta("database-compat",((e,{instanceIdentifier:t})=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("database-exp").getImmediate({identifier:t});return new Lv(r,n)}),"PUBLIC").setServiceProps({Reference:Mv,Query:Ov,Database:Lv,DataSnapshot:Dv,enableLogging:K_,INTERNAL:ow,ServerValue:hw,TEST_ACCESS:lw}).setMultipleInstances(!0)),e.registerVersion("@firebase/database-compat","0.0.900-exp.57f19127c")}(oc);
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
var dw=function(e,t){return(dw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function fw(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var pw,gw="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},mw=mw||{},yw=gw||self;function _w(){}function vw(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function ww(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var bw="closure_uid_"+(1e9*Math.random()>>>0),Iw=0;function Tw(e,t,n){return e.call.apply(e.bind,arguments)}function Ew(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Sw(e,t,n){return(Sw=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Tw:Ew).apply(null,arguments)}function Cw(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function kw(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function Rw(){this.s=this.s,this.o=this.o}Rw.prototype.s=!1,Rw.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0))(function(e){Object.prototype.hasOwnProperty.call(e,bw)&&e[bw]||(e[bw]=++Iw)})(this)},Rw.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Nw=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},Aw=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,s=0;s<r;s++)s in i&&t.call(n,i[s],s,e)};function Pw(e){return Array.prototype.concat.apply([],arguments)}function xw(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function Dw(e){return/^[\s\xa0]*$/.test(e)}var Ow,Mw=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Lw(e,t){return-1!=e.indexOf(t)}function Fw(e,t){return e<t?-1:e>t?1:0}e:{var Uw=yw.navigator;if(Uw){var qw=Uw.userAgent;if(qw){Ow=qw;break e}}Ow=""}function jw(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function Vw(e){var t={};for(var n in e)t[n]=e[n];return t}var Bw="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $w(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var s=0;s<Bw.length;s++)n=Bw[s],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Ww(e){return Ww[" "](e),e}Ww[" "]=_w;var Kw,zw,Hw=Lw(Ow,"Opera"),Gw=Lw(Ow,"Trident")||Lw(Ow,"MSIE"),Qw=Lw(Ow,"Edge"),Yw=Qw||Gw,Jw=Lw(Ow,"Gecko")&&!(Lw(Ow.toLowerCase(),"webkit")&&!Lw(Ow,"Edge"))&&!(Lw(Ow,"Trident")||Lw(Ow,"MSIE"))&&!Lw(Ow,"Edge"),Xw=Lw(Ow.toLowerCase(),"webkit")&&!Lw(Ow,"Edge");function Zw(){var e=yw.document;return e?e.documentMode:void 0}e:{var eb="",tb=(zw=Ow,Jw?/rv:([^\);]+)(\)|;)/.exec(zw):Qw?/Edge\/([\d\.]+)/.exec(zw):Gw?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(zw):Xw?/WebKit\/(\S+)/.exec(zw):Hw?/(?:Version)[ \/]?(\S+)/.exec(zw):void 0);if(tb&&(eb=tb?tb[1]:""),Gw){var nb=Zw();if(null!=nb&&nb>parseFloat(eb)){Kw=String(nb);break e}}Kw=eb}var rb,ib={};function sb(){return function(e){var t=ib;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}((function(){for(var e=0,t=Mw(String(Kw)).split("."),n=Mw("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var s=t[i]||"",o=n[i]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==s[0].length&&0==o[0].length)break;e=Fw(0==s[1].length?0:parseInt(s[1],10),0==o[1].length?0:parseInt(o[1],10))||Fw(0==s[2].length,0==o[2].length)||Fw(s[2],o[2]),s=s[3],o=o[3]}while(0==e)}return 0<=e}))}if(yw.document&&Gw){var ob=Zw();rb=ob||(parseInt(Kw,10)||void 0)}else rb=void 0;var ab=rb,cb=function(){if(!yw.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{yw.addEventListener("test",_w,t),yw.removeEventListener("test",_w,t)}catch(e){}return e}();function ub(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function lb(e,t){if(ub.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Jw){e:{try{Ww(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:hb[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&lb.Z.h.call(this)}}ub.prototype.h=function(){this.defaultPrevented=!0},kw(lb,ub);var hb={2:"touch",3:"pen",4:"mouse"};lb.prototype.h=function(){lb.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var db="closure_listenable_"+(1e6*Math.random()|0),fb=0;function pb(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++fb,this.ca=this.fa=!1}function gb(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function mb(e){this.src=e,this.g={},this.h=0}function yb(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Nw(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(gb(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function _b(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.ca&&s.listener==t&&s.capture==!!n&&s.ia==r)return i}return-1}mb.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=_b(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new pb(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var vb="closure_lm_"+(1e6*Math.random()|0),wb={};function bb(e,t,n,r,i){if(r&&r.once)return Tb(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)bb(e,t[s],n,r,i);return null}return n=Ab(n),e&&e[db]?e.N(t,n,ww(r)?!!r.capture:!!r,i):Ib(e,t,n,!1,r,i)}function Ib(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=ww(i)?!!i.capture:!!i,a=Rb(e);if(a||(e[vb]=a=new mb(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=kb;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)cb||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Cb(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Tb(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)Tb(e,t[s],n,r,i);return null}return n=Ab(n),e&&e[db]?e.O(t,n,ww(r)?!!r.capture:!!r,i):Ib(e,t,n,!0,r,i)}function Eb(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Eb(e,t[s],n,r,i);else r=ww(r)?!!r.capture:!!r,n=Ab(n),e&&e[db]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=_b(s=e.g[t],n,r,i))&&(gb(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Rb(e))&&(t=e.g[t.toString()],e=-1,t&&(e=_b(t,n,r,i)),(n=-1<e?t[e]:null)&&Sb(n))}function Sb(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[db])yb(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Cb(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Rb(t))?(yb(n,e),0==n.h&&(n.src=null,t[vb]=null)):gb(e)}}}function Cb(e){return e in wb?wb[e]:wb[e]="on"+e}function kb(e,t){if(e.ca)e=!0;else{t=new lb(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&Sb(e),e=n.call(r,t)}return e}function Rb(e){return(e=e[vb])instanceof mb?e:null}var Nb="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ab(e){return"function"==typeof e?e:(e[Nb]||(e[Nb]=function(t){return e.handleEvent(t)}),e[Nb])}function Pb(){Rw.call(this),this.i=new mb(this),this.P=this,this.I=null}function xb(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new ub(t,e);else if(t instanceof ub)t.target=t.target||e;else{var i=t;$w(t=new ub(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=Db(o,r,!0,t)&&i}if(i=Db(o=t.g=e,r,!0,t)&&i,i=Db(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=Db(o=t.g=n[s],r,!1,t)&&i}function Db(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&yb(e.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}kw(Pb,Rw),Pb.prototype[db]=!0,Pb.prototype.removeEventListener=function(e,t,n,r){Eb(this,e,t,n,r)},Pb.prototype.M=function(){if(Pb.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)gb(n[r]);delete t.g[e],t.h--}}this.I=null},Pb.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Pb.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Ob=yw.JSON.stringify;function Mb(){var e=$b,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Lb,Fb=function(){function e(){this.h=this.g=null}return e.prototype.add=function(e,t){var n=Ub.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n},e}(),Ub=new(function(){function e(e,t){this.i=e,this.j=t,this.h=0,this.g=null}return e.prototype.get=function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e},e}())((function(){return new qb}),(function(e){return e.reset()})),qb=function(){function e(){this.next=this.g=this.h=null}return e.prototype.set=function(e,t){this.h=e,this.g=t,this.next=null},e.prototype.reset=function(){this.next=this.g=this.h=null},e}();function jb(e){yw.setTimeout((function(){throw e}),0)}function Vb(e,t){Lb||function(){var e=yw.Promise.resolve(void 0);Lb=function(){e.then(Wb)}}(),Bb||(Lb(),Bb=!0),$b.add(e,t)}var Bb=!1,$b=new Fb;function Wb(){for(var e;e=Mb();){try{e.h.call(e.g)}catch(e){jb(e)}var t=Ub;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Bb=!1}function Kb(e,t){Pb.call(this),this.h=e||1,this.g=t||yw,this.j=Sw(this.kb,this),this.l=Date.now()}function zb(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function Hb(e,t,n){if("function"==typeof e)n&&(e=Sw(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Sw(e.handleEvent,e)}return 2147483647<Number(t)?-1:yw.setTimeout(e,t||0)}function Gb(e){e.g=Hb((function(){e.g=null,e.i&&(e.i=!1,Gb(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}kw(Kb,Pb),(pw=Kb.prototype).da=!1,pw.S=null,pw.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),xb(this,"tick"),this.da&&(zb(this),this.start()))}},pw.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},pw.M=function(){Kb.Z.M.call(this),zb(this),delete this.g};var Qb=function(e){function t(t,n){var r=e.call(this)||this;return r.m=t,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(e,t){function n(){this.constructor=e}dw(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.l=function(e){this.h=arguments,this.g?this.i=!0:Gb(this)},t.prototype.M=function(){e.prototype.M.call(this),this.g&&(yw.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},t}(Rw);function Yb(e){Rw.call(this),this.h=e,this.g={}}kw(Yb,Rw);var Jb=[];function Xb(e,t,n,r){Array.isArray(n)||(n&&(Jb[0]=n.toString()),n=Jb);for(var i=0;i<n.length;i++){var s=bb(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Zb(e){jw(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Sb(e)}),e),e.g={}}function eI(){this.g=!0}function tI(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return Ob(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}Yb.prototype.M=function(){Yb.Z.M.call(this),Zb(this)},Yb.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},eI.prototype.Aa=function(){this.g=!1},eI.prototype.info=function(){};var nI={},rI=null;function iI(){return rI=rI||new Pb}function sI(e){ub.call(this,nI.Ma,e)}function oI(e){var t=iI();xb(t,new sI(t,e))}function aI(e,t){ub.call(this,nI.STAT_EVENT,e),this.stat=t}function cI(e){var t=iI();xb(t,new aI(t,e))}function uI(e,t){ub.call(this,nI.Na,e),this.size=t}function lI(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return yw.setTimeout((function(){e()}),t)}nI.Ma="serverreachability",kw(sI,ub),nI.STAT_EVENT="statevent",kw(aI,ub),nI.Na="timingevent",kw(uI,ub);var hI={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},dI={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function fI(){}function pI(e){return e.h||(e.h=e.i())}function gI(){}fI.prototype.h=null;var mI,yI={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function _I(){ub.call(this,"d")}function vI(){ub.call(this,"c")}function wI(){}function bI(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new Yb(this),this.P=TI,e=Yw?125:void 0,this.W=new Kb(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new II}function II(){this.i=null,this.g="",this.h=!1}kw(_I,ub),kw(vI,ub),kw(wI,fI),wI.prototype.g=function(){return new XMLHttpRequest},wI.prototype.i=function(){return{}},mI=new wI;var TI=45e3,EI={},SI={};function CI(e,t,n){e.K=1,e.v=QI($I(t)),e.s=n,e.U=!0,kI(e,null)}function kI(e,t){e.F=Date.now(),PI(e),e.A=$I(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),cT(n.h,"t",r),e.C=0,n=e.l.H,e.h=new II,e.g=uE(e.l,n?t:null,!e.s),0<e.O&&(e.L=new Qb(Sw(e.Ia,e,e.g),e.O)),Xb(e.V,e.g,"readystatechange",e.gb),t=e.H?Vw(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),oI(1),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.X,e.s)}function RI(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Ba)}function NI(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=AI(e,n))==SI){4==t&&(e.o=4,cI(14),i=!1),tI(e.j,e.m,null,"[Incomplete Response]");break}if(r==EI){e.o=4,cI(15),tI(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}tI(e.j,e.m,r,null),LI(e,r)}RI(e)&&r!=SI&&r!=EI&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,cI(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),tE(t),t.L=!0,cI(11))):(tI(e.j,e.m,n,"[Invalid Chunked Response]"),MI(e),OI(e))}function AI(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?SI:(n=Number(t.substring(n,r)),isNaN(n)?EI:(r+=1)+n>t.length?SI:(t=t.substr(r,n),e.C=r+n,t))}function PI(e){e.Y=Date.now()+e.P,xI(e,e.P)}function xI(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=lI(Sw(e.eb,e),t)}function DI(e){e.B&&(yw.clearTimeout(e.B),e.B=null)}function OI(e){0==e.l.G||e.I||iE(e.l,e)}function MI(e){DI(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,zb(e.W),Zb(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function LI(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||gT(n.i,e)))if(n.I=e.N,!e.J&&gT(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(s){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;rE(n),zT(n)}eE(n),cI(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=lI(Sw(n.ab,n),6e3));if(1>=pT(n.i)&&n.ka){try{n.ka()}catch(s){}n.ka=void 0}}else oE(n,11)}else if((e.J||n.g==e)&&rE(n),!Dw(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var s=i[t];if(n.U=s[0],s=s[1],2==n.G)if("c"==s[0]){n.J=s[1],n.la=s[2];var o=s[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var a=s[4];null!=a&&(n.za=a,n.h.info("SVER="+n.za));var c=s[5];null!=c&&"number"==typeof c&&0<c&&(r=1.5*c,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var u=e.g;if(u){var l=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(Lw(l,"spdy")||Lw(l,"quic")||Lw(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(mT(h,h.h),h.h=null))}if(r.D){var d=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;d&&(r.sa=d,GI(r.F,r.D,d))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var f=e;if((r=n).oa=cE(r,r.H?r.la:null,r.W),f.J){yT(r.i,f);var p=f,g=r.K;g&&p.setTimeout(g),p.B&&(DI(p),PI(p)),r.g=f}else ZT(r);0<n.l.length&&QT(n)}else"stop"!=s[0]&&"close"!=s[0]||oE(n,7);else 3==n.G&&("stop"==s[0]||"close"==s[0]?"stop"==s[0]?oE(n,7):KT(n):"noop"!=s[0]&&n.j&&n.j.wa(s),n.A=0)}oI(4)}catch(s){}}function FI(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(vw(e)||"string"==typeof e)Aw(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(vw(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;i=(r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(vw(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}}function UI(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof UI)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function qI(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];jI(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)jI(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function jI(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(pw=bI.prototype).setTimeout=function(e){this.P=e},pw.gb=function(e){e=e.target;var t=this.L;t&&3==jT(e)?t.l():this.Ia(e)},pw.Ia=function(e){try{if(e==this.g)e:{var t=jT(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||Yw||this.g&&(this.h.h||this.g.ga()||VT(this.g)))){this.I||4!=t||7==n||oI(8==n||0>=r?3:2),DI(this);var i=this.g.ba();this.N=i;t:if(RI(this)){var s=VT(this.g);e="";var o=s.length,a=4==jT(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){MI(this),OI(this);var c="";break t}this.h.i=new yw.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(s[n],{stream:a&&n==o-1});s.splice(0,o),this.h.g+=e,this.C=0,c=this.h.g}else c=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var u,l=this.g;if((u=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Dw(u)){var h=u;break t}}h=null}if(!(i=h)){this.i=!1,this.o=3,cI(12),MI(this),OI(this);break e}tI(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,LI(this,i)}this.U?(NI(this,t,c),Yw&&this.i&&3==t&&(Xb(this.V,this.W,"tick",this.fb),this.W.start())):(tI(this.j,this.m,c,null),LI(this,c)),4==t&&MI(this),this.i&&!this.I&&(4==t?iE(this.l,this):(this.i=!1,PI(this)))}else 400==i&&0<c.indexOf("Unknown SID")?(this.o=3,cI(12)):(this.o=0,cI(13)),MI(this),OI(this)}}}catch(t){}},pw.fb=function(){if(this.g){var e=jT(this.g),t=this.g.ga();this.C<t.length&&(DI(this),NI(this,e,t),this.i&&4!=e&&PI(this))}},pw.cancel=function(){this.I=!0,MI(this)},pw.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(oI(3),cI(17)),MI(this),this.o=2,OI(this)):xI(this,this.Y-e)},(pw=UI.prototype).R=function(){qI(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},pw.T=function(){return qI(this),this.g.concat()},pw.get=function(e,t){return jI(this.h,e)?this.h[e]:t},pw.set=function(e,t){jI(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},pw.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],s=this.get(i);e.call(t,s,i,this)}};var VI=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function BI(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof BI){this.g=void 0!==t?t:e.g,WI(this,e.j),this.s=e.s,KI(this,e.i),zI(this,e.m),this.l=e.l,t=e.h;var n=new iT;n.i=t.i,t.g&&(n.g=new UI(t.g),n.h=t.h),HI(this,n),this.o=e.o}else e&&(n=String(e).match(VI))?(this.g=!!t,WI(this,n[1]||"",!0),this.s=YI(n[2]||""),KI(this,n[3]||"",!0),zI(this,n[4]),this.l=YI(n[5]||"",!0),HI(this,n[6]||"",!0),this.o=YI(n[7]||"")):(this.g=!!t,this.h=new iT(null,this.g))}function $I(e){return new BI(e)}function WI(e,t,n){e.j=n?YI(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function KI(e,t,n){e.i=n?YI(t,!0):t}function zI(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function HI(e,t,n){t instanceof iT?(e.h=t,function(e,t){t&&!e.j&&(sT(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(oT(this,t),cT(this,n,e))}),e)),e.j=t}(e.h,e.g)):(n||(t=JI(t,nT)),e.h=new iT(t,e.g))}function GI(e,t,n){e.h.set(t,n)}function QI(e){return GI(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function YI(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function JI(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,XI),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function XI(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}BI.prototype.toString=function(){var e=[],t=this.j;t&&e.push(JI(t,ZI,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(JI(t,ZI,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(JI(n,"/"==n.charAt(0)?tT:eT,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",JI(n,rT)),e.join("")};var ZI=/[#\/\?@]/g,eT=/[#\?:]/g,tT=/[#\?]/g,nT=/[#\?@]/g,rT=/#/g;function iT(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function sT(e){e.g||(e.g=new UI,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function oT(e,t){sT(e),t=uT(e,t),jI(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,jI((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&qI(e)))}function aT(e,t){return sT(e),t=uT(e,t),jI(e.g.h,t)}function cT(e,t,n){oT(e,t),0<n.length&&(e.i=null,e.g.set(uT(e,t),xw(n)),e.h+=n.length)}function uT(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(pw=iT.prototype).add=function(e,t){sT(this),this.i=null,e=uT(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},pw.forEach=function(e,t){sT(this),this.g.forEach((function(n,r){Aw(n,(function(n){e.call(t,n,r,this)}),this)}),this)},pw.T=function(){sT(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],s=0;s<i.length;s++)n.push(t[r]);return n},pw.R=function(e){sT(this);var t=[];if("string"==typeof e)aT(this,e)&&(t=Pw(t,this.g.get(uT(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=Pw(t,e[n])}return t},pw.set=function(e,t){return sT(this),this.i=null,aT(this,e=uT(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},pw.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},pw.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),e.push(o)}}return this.i=e.join("&")};var lT=function(e,t){this.h=e,this.g=t};function hT(e){this.l=e||dT,yw.PerformanceNavigationTiming?e=0<(e=yw.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(yw.g&&yw.g.Ea&&yw.g.Ea()&&yw.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var dT=10;function fT(e){return!!e.h||!!e.g&&e.g.size>=e.j}function pT(e){return e.h?1:e.g?e.g.size:0}function gT(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function mT(e,t){e.g?e.g.add(t):e.h=t}function yT(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function _T(e){var t,n;if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var r=e.i;try{for(var i=fw(e.g.values()),s=i.next();!s.done;s=i.next()){var o=s.value;r=r.concat(o.D)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}return xw(e.i)}function vT(){}function wT(){this.g=new vT}function bT(e,t,n){var r=n||"";try{FI(e,(function(e,n){var i=e;ww(e)&&(i=Ob(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function IT(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function TT(e){this.l=e.$b||null,this.j=e.ib||!1}function ET(e,t){Pb.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=ST,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}hT.prototype.cancel=function(){var e,t;if(this.i=_T(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=fw(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.g.clear()}},vT.prototype.stringify=function(e){return yw.JSON.stringify(e,void 0)},vT.prototype.parse=function(e){return yw.JSON.parse(e,void 0)},kw(TT,fI),TT.prototype.g=function(){return new ET(this.l,this.j)},TT.prototype.i=function(e){return function(){return e}}({}),kw(ET,Pb);var ST=0;function CT(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function kT(e){e.readyState=4,e.l=null,e.j=null,e.A=null,RT(e)}function RT(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(pw=ET.prototype).open=function(e,t){if(this.readyState!=ST)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,RT(this)},pw.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||yw).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},pw.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,kT(this)),this.readyState=ST},pw.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,RT(this)),this.g&&(this.readyState=3,RT(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==yw.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;CT(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},pw.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?kT(this):RT(this),3==this.readyState&&CT(this)}},pw.Ua=function(e){this.g&&(this.response=this.responseText=e,kT(this))},pw.Ta=function(e){this.g&&(this.response=e,kT(this))},pw.ha=function(){this.g&&kT(this)},pw.setRequestHeader=function(e,t){this.v.append(e,t)},pw.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},pw.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(ET.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var NT=yw.JSON.parse;function AT(e){Pb.call(this),this.headers=new UI,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=PT,this.K=this.L=!1}kw(AT,Pb);var PT="",xT=/^https?$/i,DT=["POST","PUT"];function OT(e){return"content-type"==e.toLowerCase()}function MT(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,LT(e),UT(e)}function LT(e){e.D||(e.D=!0,xb(e,"complete"),xb(e,"error"))}function FT(e){if(e.h&&void 0!==mw&&(!e.C[1]||4!=jT(e)||2!=e.ba()))if(e.v&&4==jT(e))Hb(e.Fa,0,e);else if(xb(e,"readystatechange"),4==jT(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var s=String(e.H).match(VI)[1]||null;if(!s&&yw.self&&yw.self.location){var o=yw.self.location.protocol;s=o.substr(0,o.length-1)}i=!xT.test(s?s.toLowerCase():"")}t=i}if(t)xb(e,"complete"),xb(e,"success");else{e.m=6;try{var a=2<jT(e)?e.g.statusText:""}catch(e){a=""}e.j=a+" ["+e.ba()+"]",LT(e)}}finally{UT(e)}}}function UT(e,t){if(e.g){qT(e);var n=e.g,r=e.C[0]?_w:null;e.g=null,e.C=null,t||xb(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function qT(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(yw.clearTimeout(e.A),e.A=null)}function jT(e){return e.g?e.g.readyState:0}function VT(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case PT:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function BT(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return jw(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):GI(e,t,n))}function $T(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function WT(e){this.za=0,this.l=[],this.h=new eI,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=$T("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=$T("baseRetryDelayMs",5e3,e),this.$a=$T("retryDelaySeedMs",1e4,e),this.Ya=$T("forwardChannelMaxRetries",2,e),this.ra=$T("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new hT(e&&e.concurrentRequestLimit),this.Ca=new wT,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function KT(e){if(HT(e),3==e.G){var t=e.V++,n=$I(e.F);GI(n,"SID",e.J),GI(n,"RID",t),GI(n,"TYPE","terminate"),JT(e,n),(t=new bI(e,e.h,t,void 0)).K=2,t.v=QI($I(n)),n=!1,yw.navigator&&yw.navigator.sendBeacon&&(n=yw.navigator.sendBeacon(t.v.toString(),"")),!n&&yw.Image&&((new Image).src=t.v,n=!0),n||(t.g=uE(t.l,null),t.g.ea(t.v)),t.F=Date.now(),PI(t)}aE(e)}function zT(e){e.g&&(tE(e),e.g.cancel(),e.g=null)}function HT(e){zT(e),e.u&&(yw.clearTimeout(e.u),e.u=null),rE(e),e.i.cancel(),e.m&&("number"==typeof e.m&&yw.clearTimeout(e.m),e.m=null)}function GT(e,t){e.l.push(new lT(e.Za++,t)),3==e.G&&QT(e)}function QT(e){fT(e.i)||e.m||(e.m=!0,Vb(e.Ha,e),e.C=0)}function YT(e,t){var n;n=t?t.m:e.V++;var r=$I(e.F);GI(r,"SID",e.J),GI(r,"RID",n),GI(r,"AID",e.U),JT(e,r),e.o&&e.s&&BT(r,e.o,e.s),n=new bI(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=XT(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),mT(e.i,n),CI(n,r,t)}function JT(e,t){e.j&&FI({},(function(e,n){GI(t,n,e)}))}function XT(e,t,n){n=Math.min(e.l.length,n);var r=e.j?Sw(e.j.Oa,e.j,e):null;e:for(var i=e.l,s=-1;;){var o=["count="+n];-1==s?0<n?(s=i[0].h,o.push("ofs="+s)):s=0:o.push("ofs="+s);for(var a=!0,c=0;c<n;c++){var u=i[c].h,l=i[c].g;if(0>(u-=s))s=Math.max(0,i[c].h-100),a=!1;else try{bT(l,o,"req"+u+"_")}catch(e){r&&r(l)}}if(a){r=o.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function ZT(e){e.g||e.u||(e.Y=1,Vb(e.Ga,e),e.A=0)}function eE(e){return!(e.g||e.u||3<=e.A)&&(e.Y++,e.u=lI(Sw(e.Ga,e),sE(e,e.A)),e.A++,!0)}function tE(e){null!=e.B&&(yw.clearTimeout(e.B),e.B=null)}function nE(e){e.g=new bI(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=$I(e.oa);GI(t,"RID","rpc"),GI(t,"SID",e.J),GI(t,"CI",e.N?"0":"1"),GI(t,"AID",e.U),JT(e,t),GI(t,"TYPE","xmlhttp"),e.o&&e.s&&BT(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=QI($I(t)),n.s=null,n.U=!0,kI(n,e)}function rE(e){null!=e.v&&(yw.clearTimeout(e.v),e.v=null)}function iE(e,t){var n=null;if(e.g==t){rE(e),tE(e),e.g=null;var r=2}else{if(!gT(e.i,t))return;n=t.D,yT(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;xb(r=iI(),new uI(r,n,t,i)),QT(e)}else ZT(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(pT(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=lI(Sw(e.Ha,e,t),sE(e,e.C)),e.C++,0)))}(e,t)||2==r&&eE(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:oE(e,5);break;case 4:oE(e,10);break;case 3:oE(e,6);break;default:oE(e,2)}}function sE(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function oE(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=Sw(e.jb,e);n||(n=new BI("//www.google.com/images/cleardot.gif"),yw.location&&"http"==yw.location.protocol||WI(n,"https"),QI(n)),function(e,t){var n=new eI;if(yw.Image){var r=new Image;r.onload=Cw(IT,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Cw(IT,n,r,"TestLoadImage: error",!1,t),r.onabort=Cw(IT,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Cw(IT,n,r,"TestLoadImage: timeout",!1,t),yw.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else cI(2);e.G=0,e.j&&e.j.va(t),aE(e),HT(e)}function aE(e){e.G=0,e.I=-1,e.j&&(0==_T(e.i).length&&0==e.l.length||(e.i.i.length=0,xw(e.l),e.l.length=0),e.j.ua())}function cE(e,t,n){var r=function(e){return e instanceof BI?$I(e):new BI(e,void 0)}(n);if(""!=r.i)t&&KI(r,t+"."+r.i),zI(r,r.m);else{var i=yw.location;r=function(e,t,n,r){var i=new BI(null,void 0);return e&&WI(i,e),t&&KI(i,t),n&&zI(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&jw(e.aa,(function(e,t){GI(r,t,e)})),t=e.D,n=e.sa,t&&n&&GI(r,t,n),GI(r,"VER",e.ma),JT(e,r),r}function uE(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ba&&!e.qa?new AT(new TT({ib:!0})):new AT(e.qa)).L=e.H,t}function lE(){}function hE(){if(Gw&&!(10<=Number(ab)))throw Error("Environmental error: no available transport.")}function dE(e,t){Pb.call(this),this.g=new WT(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!Dw(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Dw(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new gE(this)}function fE(e){_I.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function pE(){vI.call(this),this.status=1}function gE(e){this.g=e}(pw=AT.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():mI.g(),this.C=this.u?pI(this.u):pI(mI),this.g.onreadystatechange=Sw(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(e){return void MT(this,e)}e=n||"";var i=new UI(this.headers);r&&FI(r,(function(e,t){i.set(t,e)})),r=function(e){e:{for(var t=OT,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=yw.FormData&&e instanceof yw.FormData,!(0<=Nw(DT,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(e,t){this.g.setRequestHeader(t,e)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{qT(this),0<this.B&&((this.K=function(e){return Gw&&sb()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Sw(this.pa,this)):this.A=Hb(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){MT(this,e)}},pw.pa=function(){void 0!==mw&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,xb(this,"timeout"),this.abort(8))},pw.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,xb(this,"complete"),xb(this,"abort"),UT(this))},pw.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),UT(this,!0)),AT.Z.M.call(this)},pw.Fa=function(){this.s||(this.F||this.v||this.l?FT(this):this.cb())},pw.cb=function(){FT(this)},pw.ba=function(){try{return 2<jT(this)?this.g.status:-1}catch(e){return-1}},pw.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},pw.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),NT(t)}},pw.Da=function(){return this.m},pw.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(pw=WT.prototype).ma=8,pw.G=1,pw.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(e){}},pw.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new bI(this,this.h,e,void 0),n=this.s;if(this.P&&(n?$w(n=Vw(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var s=this.l[i];if(void 0===(s="__data__"in s.g&&"string"==typeof(s=s.g.__data__)?s.length:void 0))break;if(4096<(r+=s)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=XT(this,t,r),GI(i=$I(this.F),"RID",e),GI(i,"CVER",22),this.D&&GI(i,"X-HTTP-Session-Id",this.D),JT(this,i),this.o&&n&&BT(i,this.o,n),mT(this.i,t),this.Ra&&GI(i,"TYPE","init"),this.ja?(GI(i,"$req",r),GI(i,"SID","null"),t.$=!0,CI(t,i,null)):CI(t,i,r),this.G=2}}else 3==this.G&&(e?YT(this,e):0==this.l.length||fT(this.i)||YT(this))},pw.Ga=function(){if(this.u=null,nE(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=lI(Sw(this.bb,this),e)}},pw.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,cI(10),zT(this),nE(this))},pw.ab=function(){null!=this.v&&(this.v=null,zT(this),eE(this),cI(19))},pw.jb=function(e){e?(this.h.info("Successfully pinged google.com"),cI(2)):(this.h.info("Failed to ping google.com"),cI(1))},(pw=lE.prototype).xa=function(){},pw.wa=function(){},pw.va=function(){},pw.ua=function(){},pw.Oa=function(){},hE.prototype.g=function(e,t){return new dE(e,t)},kw(dE,Pb),dE.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),Vb(Sw(e.hb,e,t))),cI(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=cE(e,null,e.W),QT(e)},dE.prototype.close=function(){KT(this.g)},dE.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,GT(this.g,t)}else this.v?((t={}).__data__=Ob(e),GT(this.g,t)):GT(this.g,e)},dE.prototype.M=function(){this.g.j=null,delete this.j,KT(this.g),delete this.g,dE.Z.M.call(this)},kw(fE,_I),kw(pE,vI),kw(gE,lE),gE.prototype.xa=function(){xb(this.g,"a")},gE.prototype.wa=function(e){xb(this.g,new fE(e))},gE.prototype.va=function(e){xb(this.g,new pE(e))},gE.prototype.ua=function(){xb(this.g,"b")},hE.prototype.createWebChannel=hE.prototype.g,dE.prototype.send=dE.prototype.u,dE.prototype.open=dE.prototype.m,dE.prototype.close=dE.prototype.close,hI.NO_ERROR=0,hI.TIMEOUT=8,hI.HTTP_ERROR=6,dI.COMPLETE="complete",gI.EventType=yI,yI.OPEN="a",yI.CLOSE="b",yI.ERROR="c",yI.MESSAGE="d",Pb.prototype.listen=Pb.prototype.N,AT.prototype.listenOnce=AT.prototype.O,AT.prototype.getLastError=AT.prototype.La,AT.prototype.getLastErrorCode=AT.prototype.Da,AT.prototype.getStatus=AT.prototype.ba,AT.prototype.getResponseJson=AT.prototype.Qa,AT.prototype.getResponseText=AT.prototype.ga,AT.prototype.send=AT.prototype.ea;var mE=hI,yE=dI,_E=nI,vE=10,wE=11,bE=TT,IE=gI,TE=AT;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let EE="8.6.8";
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class SE{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.t(e),this.i=e=>t.writeSequenceNumber(e))}t(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.i&&this.i(e),e}}SE.o=-1;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const CE={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class kE extends Error{constructor(e,t){super(t),this.code=e,this.message=t,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const RE=new Oa("@firebase/firestore");function NE(){return RE.logLevel}function AE(e,...t){if(RE.logLevel<=ka.DEBUG){const n=t.map(DE);RE.debug(`Firestore (${EE}): ${e}`,...n)}}function PE(e,...t){if(RE.logLevel<=ka.ERROR){const n=t.map(DE);RE.error(`Firestore (${EE}): ${e}`,...n)}}function xE(e,...t){if(RE.logLevel<=ka.WARN){const n=t.map(DE);RE.warn(`Firestore (${EE}): ${e}`,...n)}}function DE(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function OE(e="Unexpected state"){const t=`FIRESTORE (${EE}) INTERNAL ASSERTION FAILED: `+e;throw PE(t),new Error(t)}function ME(e,t){e||OE()}function LE(e,t){return e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function FE(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class UE{static u(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const r=FE(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length))}return n}}function qE(e,t){return e<t?-1:e>t?1:0}function jE(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function VE(e){return e+"\0"}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class BE{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new kE(CE.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new kE(CE.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new kE(CE.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new kE(CE.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return BE.fromMillis(Date.now())}static fromDate(e){return BE.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new BE(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?qE(this.nanoseconds,e.nanoseconds):qE(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class $E{constructor(e){this.timestamp=e}static fromTimestamp(e){return new $E(e)}static min(){return new $E(new BE(0,0))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function WE(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function KE(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function zE(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class HE{constructor(e,t,n){void 0===t?t=0:t>e.length&&OE(),void 0===n?n=e.length-t:n>e.length-t&&OE(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===HE.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof HE?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class GE extends HE{construct(e,t,n){return new GE(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new kE(CE.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new GE(t)}static emptyPath(){return new GE([])}}const QE=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class YE extends HE{construct(e,t,n){return new YE(e,t,n)}static isValidIdentifier(e){return QE.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),YE.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new YE(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new kE(CE.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new kE(CE.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new kE(CE.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new kE(CE.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new YE(t)}static emptyPath(){return new YE([])}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class JE{constructor(e){this.fields=e,e.sort(YE.comparator)}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return jE(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class XE{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new XE(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new XE(t)}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qE(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}XE.EMPTY_BYTE_STRING=new XE("");const ZE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function eS(e){if(ME(!!e),"string"==typeof e){let t=0;const n=ZE.exec(e);if(ME(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:tS(e.seconds),nanos:tS(e.nanos)}}function tS(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function nS(e){return"string"==typeof e?XE.fromBase64String(e):XE.fromUint8Array(e)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function rS(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function iS(e){const t=e.mapValue.fields.__previous_value__;return rS(t)?iS(t):t}function sS(e){const t=eS(e.mapValue.fields.__local_write_time__.timestampValue);return new BE(t.seconds,t.nanos)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function oS(e){return null==e}function aS(e){return 0===e&&1/e==-1/0}function cS(e){return"number"==typeof e&&Number.isInteger(e)&&!aS(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class uS{constructor(e){this.path=e}static fromPath(e){return new uS(GE.fromString(e))}static fromName(e){return new uS(GE.fromString(e).popFirst(5))}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}isEqual(e){return null!==e&&0===GE.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return GE.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new uS(new GE(e.slice()))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function lS(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?rS(e)?4:10:OE()}function hS(e,t){const n=lS(e);if(n!==lS(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return sS(e).isEqual(sS(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=eS(e.timestampValue),r=eS(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return nS(e.bytesValue).isEqual(nS(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return tS(e.geoPointValue.latitude)===tS(t.geoPointValue.latitude)&&tS(e.geoPointValue.longitude)===tS(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return tS(e.integerValue)===tS(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=tS(e.doubleValue),r=tS(t.doubleValue);return n===r?aS(n)===aS(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return jE(e.arrayValue.values||[],t.arrayValue.values||[],hS);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(WE(n)!==WE(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!hS(n[e],r[e])))return!1;return!0}(e,t);default:return OE()}}function dS(e,t){return void 0!==(e.values||[]).find((e=>hS(e,t)))}function fS(e,t){const n=lS(e),r=lS(t);if(n!==r)return qE(n,r);switch(n){case 0:return 0;case 1:return qE(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=tS(e.integerValue||e.doubleValue),r=tS(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return pS(e.timestampValue,t.timestampValue);case 4:return pS(sS(e),sS(t));case 5:return qE(e.stringValue,t.stringValue);case 6:return function(e,t){const n=nS(e),r=nS(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=qE(n[e],r[e]);if(0!==t)return t}return qE(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=qE(tS(e.latitude),tS(t.latitude));return 0!==n?n:qE(tS(e.longitude),tS(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=fS(n[e],r[e]);if(t)return t}return qE(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){const t=qE(r[e],s[e]);if(0!==t)return t;const o=fS(n[r[e]],i[s[e]]);if(0!==o)return o}return qE(r.length,s.length)}(e.mapValue,t.mapValue);default:throw OE()}}function pS(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return qE(e,t);const n=eS(e),r=eS(t),i=qE(n.seconds,r.seconds);return 0!==i?i:qE(n.nanos,r.nanos)}function gS(e){return mS(e)}function mS(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=eS(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?nS(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,uS.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=mS(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${mS(e.fields[i])}`;return n+"}"}(e.mapValue):OE();var t,n}function yS(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function _S(e){return!!e&&"integerValue"in e}function vS(e){return!!e&&"arrayValue"in e}function wS(e){return!!e&&"nullValue"in e}function bS(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function IS(e){return!!e&&"mapValue"in e}function TS(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue)return{timestampValue:Object.assign({},eS(e.timestampValue))};if(e.mapValue){const t={mapValue:{fields:{}}};return KE(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=TS(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=TS(e.arrayValue.values[n]);return t}return Object.assign({},e)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ES{constructor(e){this.value=e}static empty(){return new ES({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!IS(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=TS(t)}setAll(e){let t=YE.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=TS(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());IS(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return hS(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];IS(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){KE(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new ES(TS(this.value))}}function SS(e){const t=[];return KE(e.fields,((e,n)=>{const r=new YE([e]);if(IS(n)){const e=SS(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new JE(t)
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}class CS{constructor(e,t,n,r,i){this.key=e,this.documentType=t,this.version=n,this.data=r,this.documentState=i}static newInvalidDocument(e){return new CS(e,0,$E.min(),ES.empty(),0)}static newFoundDocument(e,t,n){return new CS(e,1,t,n,0)}static newNoDocument(e,t){return new CS(e,2,t,ES.empty(),0)}static newUnknownDocument(e,t){return new CS(e,3,t,ES.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ES.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ES.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof CS&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}clone(){return new CS(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class kS{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.h=null}}function RS(e,t=null,n=[],r=[],i=null,s=null,o=null){return new kS(e,t,n,r,i,s,o)}function NS(e){const t=LE(e);if(null===t.h){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>function(e){return e.field.canonicalString()+e.op.toString()+gS(e.value)}(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),oS(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=BS(t.startAt)),t.endAt&&(e+="|ub:",e+=BS(t.endAt)),t.h=e}return t.h}function AS(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!WS(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let i=0;i<e.filters.length;i++)if(n=e.filters[i],r=t.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!hS(n.value,r.value))return!1;var n,r;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!zS(e.startAt,t.startAt)&&zS(e.endAt,t.endAt)}function PS(e){return uS.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class xS extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.l(e,t,n):new DS(e,t,n):"array-contains"===t?new FS(e,n):"in"===t?new US(e,n):"not-in"===t?new qS(e,n):"array-contains-any"===t?new jS(e,n):new xS(e,t,n)}static l(e,t,n){return"in"===t?new OS(e,n):new MS(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.m(fS(t,this.value)):null!==t&&lS(this.value)===lS(t)&&this.m(fS(t,this.value))}m(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return OE()}}g(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class DS extends xS{constructor(e,t,n){super(e,t,n),this.key=uS.fromName(n.referenceValue)}matches(e){const t=uS.comparator(e.key,this.key);return this.m(t)}}class OS extends xS{constructor(e,t){super(e,"in",t),this.keys=LS("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class MS extends xS{constructor(e,t){super(e,"not-in",t),this.keys=LS("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function LS(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>uS.fromName(e.referenceValue)))}class FS extends xS{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return vS(t)&&dS(t.arrayValue,this.value)}}class US extends xS{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&dS(this.value.arrayValue,t)}}class qS extends xS{constructor(e,t){super(e,"not-in",t)}matches(e){if(dS(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!dS(this.value.arrayValue,t)}}class jS extends xS{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!vS(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>dS(this.value.arrayValue,e)))}}class VS{constructor(e,t){this.position=e,this.before=t}}function BS(e){return`${e.before?"b":"a"}:${e.position.map((e=>gS(e))).join(",")}`}class $S{constructor(e,t="asc"){this.field=e,this.dir=t}}function WS(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function KS(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?uS.comparator(uS.fromName(o.referenceValue),n.key):fS(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function zS(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.before!==t.before||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!hS(e.position[n],t.position[n]))return!1;return!0}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class HS{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt}}function GS(e,t,n,r,i,s,o,a){return new HS(e,t,n,r,i,s,o,a)}function QS(e){return new HS(e)}function YS(e){return!oS(e.limit)&&"F"===e.limitType}function JS(e){return!oS(e.limit)&&"L"===e.limitType}function XS(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function ZS(e){for(const t of e.filters)if(t.g())return t.field;return null}function eC(e){return null!==e.collectionGroup}function tC(e){const t=LE(e);if(null===t.p){t.p=[];const e=ZS(t),n=XS(t);if(null!==e&&null===n)e.isKeyField()||t.p.push(new $S(e)),t.p.push(new $S(YE.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.p.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.p.push(new $S(YE.keyField(),e))}}}return t.p}function nC(e){const t=LE(e);if(!t.T)if("F"===t.limitType)t.T=RS(t.path,t.collectionGroup,tC(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const n of tC(t)){const t="desc"===n.dir?"asc":"desc";e.push(new $S(n.field,t))}const n=t.endAt?new VS(t.endAt.position,!t.endAt.before):null,r=t.startAt?new VS(t.startAt.position,!t.startAt.before):null;t.T=RS(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t.T}function rC(e,t,n){return new HS(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function iC(e,t){return AS(nC(e),nC(t))&&e.limitType===t.limitType}function sC(e){return`${NS(nC(e))}|lt:${e.limitType}`}function oC(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>{return`${(t=e).field.canonicalString()} ${t.op} ${gS(t.value)}`;var t})).join(", ")}]`),oS(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: "+BS(e.startAt)),e.endAt&&(t+=", endAt: "+BS(e.endAt)),`Target(${t})`}(nC(e))}; limitType=${e.limitType})`}function aC(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):uS.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of e.explicitOrderBy)if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!KS(e.startAt,tC(e),t))&&(!e.endAt||!KS(e.endAt,tC(e),t))}(e,t)}function cC(e){return(t,n)=>{let r=!1;for(const i of tC(e)){const e=uC(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function uC(e,t,n){const r=e.field.isKeyField()?uS.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?fS(r,i):OE()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return OE()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function lC(e,t){if(e.I){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:aS(t)?"-0":t}}function hC(e){return{integerValue:""+e}}function dC(e,t){return cS(t)?hC(t):lC(e,t)}
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class fC{constructor(){this._=void 0}}function pC(e,t,n){return e instanceof yC?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof _C?vC(e,t):e instanceof wC?bC(e,t):function(e,t){const n=mC(e,t),r=TC(n)+TC(e.A);return _S(n)&&_S(e.A)?hC(r):lC(e.R,r)}(e,t)}function gC(e,t,n){return e instanceof _C?vC(e,t):e instanceof wC?bC(e,t):n}function mC(e,t){return e instanceof IC?_S(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}class yC extends fC{}class _C extends fC{constructor(e){super(),this.elements=e}}function vC(e,t){const n=EC(t);for(const t of e.elements)n.some((e=>hS(e,t)))||n.push(t);return{arrayValue:{values:n}}}class wC extends fC{constructor(e){super(),this.elements=e}}function bC(e,t){let n=EC(t);for(const t of e.elements)n=n.filter((e=>!hS(e,t)));return{arrayValue:{values:n}}}class IC extends fC{constructor(e,t){super(),this.R=e,this.A=t}}function TC(e){return tS(e.integerValue||e.doubleValue)}function EC(e){return vS(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class SC{constructor(e,t){this.field=e,this.transform=t}}class CC{constructor(e,t){this.version=e,this.transformResults=t}}class kC{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new kC}static exists(e){return new kC(void 0,e)}static updateTime(e){return new kC(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function RC(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class NC{}function AC(e,t,n){e instanceof MC?function(e,t,n){const r=e.value.clone(),i=UC(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof LC?function(e,t,n){if(!RC(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=UC(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(FC(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function PC(e,t,n){e instanceof MC?function(e,t,n){if(!RC(e.precondition,t))return;const r=e.value.clone(),i=qC(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument(OC(t),r).setHasLocalMutations()}(e,t,n):e instanceof LC?function(e,t,n){if(!RC(e.precondition,t))return;const r=qC(e.fieldTransforms,n,t),i=t.data;i.setAll(FC(e)),i.setAll(r),t.convertToFoundDocument(OC(t),i).setHasLocalMutations()}(e,t,n):function(e,t){RC(e.precondition,t)&&t.convertToNoDocument($E.min())}(e,t)}function xC(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=mC(r.transform,e||null);null!=i&&(null==n&&(n=ES.empty()),n.set(r.field,i))}return n||null}function DC(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&jE(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof _C&&t instanceof _C||e instanceof wC&&t instanceof wC?jE(e.elements,t.elements,hS):e instanceof IC&&t instanceof IC?hS(e.A,t.A):e instanceof yC&&t instanceof yC}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function OC(e){return e.isFoundDocument()?e.version:$E.min()}class MC extends NC{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}}class LC extends NC{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}}function FC(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function UC(e,t,n){const r=new Map;ME(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,gC(o,a,n[i]))}return r}function qC(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,pC(e,s,t))}return r}class jC extends NC{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}}class VC extends NC{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class BC{constructor(e){this.count=e}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var $C,WC;function KC(e){switch(e){case CE.OK:return OE();case CE.CANCELLED:case CE.UNKNOWN:case CE.DEADLINE_EXCEEDED:case CE.RESOURCE_EXHAUSTED:case CE.INTERNAL:case CE.UNAVAILABLE:case CE.UNAUTHENTICATED:return!1;case CE.INVALID_ARGUMENT:case CE.NOT_FOUND:case CE.ALREADY_EXISTS:case CE.PERMISSION_DENIED:case CE.FAILED_PRECONDITION:case CE.ABORTED:case CE.OUT_OF_RANGE:case CE.UNIMPLEMENTED:case CE.DATA_LOSS:return!0;default:return OE()}}function zC(e){if(void 0===e)return PE("GRPC error has no .code"),CE.UNKNOWN;switch(e){case $C.OK:return CE.OK;case $C.CANCELLED:return CE.CANCELLED;case $C.UNKNOWN:return CE.UNKNOWN;case $C.DEADLINE_EXCEEDED:return CE.DEADLINE_EXCEEDED;case $C.RESOURCE_EXHAUSTED:return CE.RESOURCE_EXHAUSTED;case $C.INTERNAL:return CE.INTERNAL;case $C.UNAVAILABLE:return CE.UNAVAILABLE;case $C.UNAUTHENTICATED:return CE.UNAUTHENTICATED;case $C.INVALID_ARGUMENT:return CE.INVALID_ARGUMENT;case $C.NOT_FOUND:return CE.NOT_FOUND;case $C.ALREADY_EXISTS:return CE.ALREADY_EXISTS;case $C.PERMISSION_DENIED:return CE.PERMISSION_DENIED;case $C.FAILED_PRECONDITION:return CE.FAILED_PRECONDITION;case $C.ABORTED:return CE.ABORTED;case $C.OUT_OF_RANGE:return CE.OUT_OF_RANGE;case $C.UNIMPLEMENTED:return CE.UNIMPLEMENTED;case $C.DATA_LOSS:return CE.DATA_LOSS;default:return OE()}}(WC=$C||($C={}))[WC.OK=0]="OK",WC[WC.CANCELLED=1]="CANCELLED",WC[WC.UNKNOWN=2]="UNKNOWN",WC[WC.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",WC[WC.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",WC[WC.NOT_FOUND=5]="NOT_FOUND",WC[WC.ALREADY_EXISTS=6]="ALREADY_EXISTS",WC[WC.PERMISSION_DENIED=7]="PERMISSION_DENIED",WC[WC.UNAUTHENTICATED=16]="UNAUTHENTICATED",WC[WC.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",WC[WC.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",WC[WC.ABORTED=10]="ABORTED",WC[WC.OUT_OF_RANGE=11]="OUT_OF_RANGE",WC[WC.UNIMPLEMENTED=12]="UNIMPLEMENTED",WC[WC.INTERNAL=13]="INTERNAL",WC[WC.UNAVAILABLE=14]="UNAVAILABLE",WC[WC.DATA_LOSS=15]="DATA_LOSS";
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class HC{constructor(e,t){this.comparator=e,this.root=t||QC.EMPTY}insert(e,t){return new HC(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,QC.BLACK,null,null))}remove(e){return new HC(this.comparator,this.root.remove(e,this.comparator).copy(null,null,QC.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new GC(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new GC(this.root,e,this.comparator,!1)}getReverseIterator(){return new GC(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new GC(this.root,e,this.comparator,!0)}}class GC{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class QC{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:QC.RED,this.left=null!=r?r:QC.EMPTY,this.right=null!=i?i:QC.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new QC(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return QC.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return QC.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,QC.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,QC.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw OE();if(this.right.isRed())throw OE();const e=this.left.check();if(e!==this.right.check())throw OE();return e+(this.isRed()?0:1)}}QC.EMPTY=null,QC.RED=!0,QC.BLACK=!1,QC.EMPTY=new class{constructor(){this.size=0}get key(){throw OE()}get value(){throw OE()}get color(){throw OE()}get left(){throw OE()}get right(){throw OE()}copy(e,t,n,r,i){return this}insert(e,t,n){return new QC(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class YC{constructor(e){this.comparator=e,this.data=new HC(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new JC(this.data.getIterator())}getIteratorFrom(e){return new JC(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof YC))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new YC(this.comparator);return t.data=e,t}}class JC{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const XC=new HC(uS.comparator);function ZC(){return XC}const ek=new HC(uS.comparator);function tk(){return ek}const nk=new HC(uS.comparator);function rk(){return nk}const ik=new YC(uS.comparator);function sk(...e){let t=ik;for(const n of e)t=t.add(n);return t}const ok=new YC(qE);function ak(){return ok}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ck{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t){const n=new Map;return n.set(e,uk.createSynthesizedTargetChangeForCurrentChange(e,t)),new ck($E.min(),n,ak(),ZC(),sk())}}class uk{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t){return new uk(XE.EMPTY_BYTE_STRING,t,sk(),sk(),sk())}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class lk{constructor(e,t,n,r){this.P=e,this.removedTargetIds=t,this.key=n,this.v=r}}class hk{constructor(e,t){this.targetId=e,this.V=t}}class dk{constructor(e,t,n=XE.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class fk{constructor(){this.S=0,this.D=mk(),this.C=XE.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}get current(){return this.N}get resumeToken(){return this.C}get $(){return 0!==this.S}get O(){return this.k}F(e){e.approximateByteSize()>0&&(this.k=!0,this.C=e)}M(){let e=sk(),t=sk(),n=sk();return this.D.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:OE()}})),new uk(this.C,this.N,e,t,n)}L(){this.k=!1,this.D=mk()}B(e,t){this.k=!0,this.D=this.D.insert(e,t)}U(e){this.k=!0,this.D=this.D.remove(e)}q(){this.S+=1}K(){this.S-=1}j(){this.k=!0,this.N=!0}}class pk{constructor(e){this.W=e,this.G=new Map,this.H=ZC(),this.J=gk(),this.Y=new YC(qE)}X(e){for(const t of e.P)e.v&&e.v.isFoundDocument()?this.Z(t,e.v):this.tt(t,e.key,e.v);for(const t of e.removedTargetIds)this.tt(t,e.key,e.v)}et(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.st(t)&&n.F(e.resumeToken);break;case 1:n.K(),n.$||n.L(),n.F(e.resumeToken);break;case 2:n.K(),n.$||this.removeTarget(t);break;case 3:this.st(t)&&(n.j(),n.F(e.resumeToken));break;case 4:this.st(t)&&(this.it(t),n.F(e.resumeToken));break;default:OE()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.G.forEach(((e,n)=>{this.st(n)&&t(n)}))}rt(e){const t=e.targetId,n=e.V.count,r=this.ot(t);if(r){const e=r.target;if(PS(e))if(0===n){const n=new uS(e.path);this.tt(t,n,CS.newNoDocument(n,$E.min()))}else ME(1===n);else this.ct(t)!==n&&(this.it(t),this.Y=this.Y.add(t))}}at(e){const t=new Map;this.G.forEach(((n,r)=>{const i=this.ot(r);if(i){if(n.current&&PS(i.target)){const t=new uS(i.target.path);null!==this.H.get(t)||this.ut(r,t)||this.tt(r,t,CS.newNoDocument(t,e))}n.O&&(t.set(r,n.M()),n.L())}}));let n=sk();this.J.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.ot(e);return!t||2===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))}));const r=new ck(e,t,this.Y,this.H,n);return this.H=ZC(),this.J=gk(),this.Y=new YC(qE),r}Z(e,t){if(!this.st(e))return;const n=this.ut(e,t.key)?2:0;this.nt(e).B(t.key,n),this.H=this.H.insert(t.key,t),this.J=this.J.insert(t.key,this.ht(t.key).add(e))}tt(e,t,n){if(!this.st(e))return;const r=this.nt(e);this.ut(e,t)?r.B(t,1):r.U(t),this.J=this.J.insert(t,this.ht(t).delete(e)),n&&(this.H=this.H.insert(t,n))}removeTarget(e){this.G.delete(e)}ct(e){const t=this.nt(e).M();return this.W.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}q(e){this.nt(e).q()}nt(e){let t=this.G.get(e);return t||(t=new fk,this.G.set(e,t)),t}ht(e){let t=this.J.get(e);return t||(t=new YC(qE),this.J=this.J.insert(e,t)),t}st(e){const t=null!==this.ot(e);return t||AE("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.G.get(e);return t&&t.$?null:this.W.lt(e)}it(e){this.G.set(e,new fk),this.W.getRemoteKeysForTarget(e).forEach((t=>{this.tt(e,t,null)}))}ut(e,t){return this.W.getRemoteKeysForTarget(e).has(t)}}function gk(){return new HC(uS.comparator)}function mk(){return new HC(uS.comparator)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const yk={asc:"ASCENDING",desc:"DESCENDING"},_k={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class vk{constructor(e,t){this.databaseId=e,this.I=t}}function wk(e,t){return e.I?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function bk(e,t){return e.I?t.toBase64():t.toUint8Array()}function Ik(e,t){return wk(e,t.toTimestamp())}function Tk(e){return ME(!!e),$E.fromTimestamp(function(e){const t=eS(e);return new BE(t.seconds,t.nanos)}(e))}function Ek(e,t){return function(e){return new GE(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Sk(e){const t=GE.fromString(e);return ME(Qk(t)),t}function Ck(e,t){return Ek(e.databaseId,t.path)}function kk(e,t){const n=Sk(t);if(n.get(1)!==e.databaseId.projectId)throw new kE(CE.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new kE(CE.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new uS(Pk(n))}function Rk(e,t){return Ek(e.databaseId,t)}function Nk(e){const t=Sk(e);return 4===t.length?GE.emptyPath():Pk(t)}function Ak(e){return new GE(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Pk(e){return ME(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function xk(e,t,n){return{name:Ck(e,t),fields:n.value.mapValue.fields}}function Dk(e,t,n){const r=kk(e,t.name),i=Tk(t.updateTime),s=new ES({mapValue:{fields:t.fields}}),o=CS.newFoundDocument(r,i,s);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function Ok(e,t){let n;if(t instanceof MC)n={update:xk(e,t.key,t.value)};else if(t instanceof jC)n={delete:Ck(e,t.key)};else if(t instanceof LC)n={update:xk(e,t.key,t.data),updateMask:Gk(t.fieldMask)};else{if(!(t instanceof VC))return OE();n={verify:Ck(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof yC)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof _C)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof wC)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof IC)return{fieldPath:t.field.canonicalString(),increment:n.A};throw OE()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Ik(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:OE()}(e,t.precondition)),n}function Mk(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?kC.updateTime(Tk(e.updateTime)):void 0!==e.exists?kC.exists(e.exists):kC.none()}(t.currentDocument):kC.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)ME("REQUEST_TIME"===t.setToServerValue),n=new yC;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new _C(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new wC(e)}else"increment"in t?n=new IC(e,t.increment):OE();const r=YE.fromServerFormat(t.fieldPath);return new SC(r,n)}(e,t))):[];if(t.update){t.update.name;const i=kk(e,t.update.name),s=new ES({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new JE(t.map((e=>YE.fromServerFormat(e))))}(t.updateMask);return new LC(i,s,e,n,r)}return new MC(i,s,n,r)}if(t.delete){const r=kk(e,t.delete);return new jC(r,n)}if(t.verify){const r=kk(e,t.verify);return new VC(r,n)}return OE()}function Lk(e,t){return{documents:[Rk(e,t.path)]}}function Fk(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Rk(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Rk(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0===e.length)return;const t=e.map((e=>function(e){if("=="===e.op){if(bS(e.value))return{unaryFilter:{field:Wk(e.field),op:"IS_NAN"}};if(wS(e.value))return{unaryFilter:{field:Wk(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(bS(e.value))return{unaryFilter:{field:Wk(e.field),op:"IS_NOT_NAN"}};if(wS(e.value))return{unaryFilter:{field:Wk(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wk(e.field),op:$k(e.op),value:e.value}}}(e)));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Wk(e.field),direction:Bk(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(e,t){return e.I||oS(t)?t:{value:t}}(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=jk(t.startAt)),t.endAt&&(n.structuredQuery.endAt=jk(t.endAt)),n}function Uk(e){let t=Nk(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ME(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=qk(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((e=>function(e){return new $S(Kk(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,oS(t)?null:t}(n.limit));let c=null;n.startAt&&(c=Vk(n.startAt));let u=null;return n.endAt&&(u=Vk(n.endAt)),GS(t,i,o,s,a,"F",c,u)}function qk(e){return e?void 0!==e.unaryFilter?[Hk(e)]:void 0!==e.fieldFilter?[zk(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((e=>qk(e))).reduce(((e,t)=>e.concat(t))):OE():[]}function jk(e){return{before:e.before,values:e.position}}function Vk(e){const t=!!e.before,n=e.values||[];return new VS(n,t)}function Bk(e){return yk[e]}function $k(e){return _k[e]}function Wk(e){return{fieldPath:e.canonicalString()}}function Kk(e){return YE.fromServerFormat(e.fieldPath)}function zk(e){return xS.create(Kk(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return OE()}}(e.fieldFilter.op),e.fieldFilter.value)}function Hk(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Kk(e.unaryFilter.field);return xS.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Kk(e.unaryFilter.field);return xS.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Kk(e.unaryFilter.field);return xS.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Kk(e.unaryFilter.field);return xS.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return OE()}}function Gk(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Qk(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Yk(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Xk(t)),t=Jk(e.get(n),t);return Xk(t)}function Jk(e,t){let n=t;const r=e.length;for(let t=0;t<r;t++){const r=e.charAt(t);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function Xk(e){return e+""}function Zk(e){const t=e.length;if(ME(t>=2),2===t)return ME(""===e.charAt(0)&&""===e.charAt(1)),GE.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("",s);switch((t<0||t>n)&&OE(),e.charAt(t+1)){case"":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"":i+=e.substring(s,t),i+="\0";break;case"":i+=e.substring(s,t+1);break;default:OE()}s=t+2}return new GE(r)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class eR{constructor(e,t){this.seconds=e,this.nanoseconds=t}}class tR{constructor(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n}}tR.store="owner",tR.key="owner";class nR{constructor(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n}}nR.store="mutationQueues",nR.keyPath="userId";class rR{constructor(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}}rR.store="mutations",rR.keyPath="batchId",rR.userMutationsIndex="userMutationsIndex",rR.userMutationsKeyPath=["userId","batchId"];class iR{constructor(){}static prefixForUser(e){return[e]}static prefixForPath(e,t){return[e,Yk(t)]}static key(e,t,n){return[e,Yk(t),n]}}iR.store="documentMutations",iR.PLACEHOLDER=new iR;class sR{constructor(e,t){this.path=e,this.readTime=t}}class oR{constructor(e,t){this.path=e,this.version=t}}class aR{constructor(e,t,n,r,i,s){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=s}}aR.store="remoteDocuments",aR.readTimeIndex="readTimeIndex",aR.readTimeIndexPath="readTime",aR.collectionReadTimeIndex="collectionReadTimeIndex",aR.collectionReadTimeIndexPath=["parentPath","readTime"];class cR{constructor(e){this.byteSize=e}}cR.store="remoteDocumentGlobal",cR.key="remoteDocumentGlobalKey";class uR{constructor(e,t,n,r,i,s,o){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=s,this.query=o}}uR.store="targets",uR.keyPath="targetId",uR.queryTargetsIndexName="queryTargetsIndex",uR.queryTargetsKeyPath=["canonicalId","targetId"];class lR{constructor(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n}}lR.store="targetDocuments",lR.keyPath=["targetId","path"],lR.documentTargetsIndex="documentTargetsIndex",lR.documentTargetsKeyPath=["path","targetId"];class hR{constructor(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r}}hR.key="targetGlobalKey",hR.store="targetGlobal";class dR{constructor(e,t){this.collectionId=e,this.parent=t}}dR.store="collectionParents",dR.keyPath=["collectionId","parent"];class fR{constructor(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r}}fR.store="clientMetadata",fR.keyPath="clientId";class pR{constructor(e,t,n){this.bundleId=e,this.createTime=t,this.version=n}}pR.store="bundles",pR.keyPath="bundleId";class gR{constructor(e,t,n){this.name=e,this.readTime=t,this.bundledQuery=n}}gR.store="namedQueries",gR.keyPath="name";const mR=[nR.store,rR.store,iR.store,aR.store,uR.store,tR.store,hR.store,lR.store,fR.store,cR.store,dR.store,pR.store,gR.store],yR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class _R{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class vR{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class wR{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&OE(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new wR(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof wR?t:wR.resolve(t)}catch(e){return wR.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):wR.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):wR.reject(t)}static resolve(e){return new wR(((t,n)=>{t(e)}))}static reject(e){return new wR(((t,n)=>{n(e)}))}static waitFor(e){return new wR(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=wR.resolve(!1);for(const n of e)t=t.next((e=>e?wR.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class bR{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.ft=new vR,this.transaction.oncomplete=()=>{this.ft.resolve()},this.transaction.onabort=()=>{t.error?this.ft.reject(new ER(e,t.error)):this.ft.resolve()},this.transaction.onerror=t=>{const n=NR(t.target.error);this.ft.reject(new ER(e,n))}}static open(e,t,n,r){try{return new bR(t,e.transaction(r,n))}catch(e){throw new ER(t,e)}}get dt(){return this.ft.promise}abort(e){e&&this.ft.reject(e),this.aborted||(AE("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}store(e){const t=this.transaction.objectStore(e);return new CR(t)}}class IR{constructor(e,t,n){this.name=e,this.version=t,this.wt=n,12.2===IR._t(qo())&&PE("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return AE("SimpleDb","Removing database:",e),kR(window.indexedDB.deleteDatabase(e)).toPromise()}static gt(){if("undefined"==typeof indexedDB)return!1;if(IR.yt())return!0;const e=qo(),t=IR._t(e),n=0<t&&t<10,r=IR.Et(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static yt(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.Tt)}static It(e,t){return e.store(t)}static _t(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static Et(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async At(e){return this.db||(AE("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new ER(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new kE(CE.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new ER(e,r))},r.onupgradeneeded=e=>{AE("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.wt.Rt(t,r.transaction,e.oldVersion,this.version).next((()=>{AE("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.Pt&&(this.db.onversionchange=e=>this.Pt(e)),this.db}bt(e){this.Pt=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.At(e);const t=bR.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).catch((e=>(t.abort(e),wR.reject(e)))).toPromise();return s.catch((()=>{})),await t.dt,s}catch(e){const t="FirebaseError"!==e.name&&s<3;if(AE("SimpleDb","Transaction failed with error:",e.message,"Retrying:",t),this.close(),!t)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class TR{constructor(e){this.vt=e,this.Vt=!1,this.St=null}get isDone(){return this.Vt}get Dt(){return this.St}set cursor(e){this.vt=e}done(){this.Vt=!0}Ct(e){this.St=e}delete(){return kR(this.vt.delete())}}class ER extends kE{constructor(e,t){super(CE.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function SR(e){return"IndexedDbTransactionError"===e.name}class CR{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(AE("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(AE("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),kR(n)}add(e){return AE("SimpleDb","ADD",this.store.name,e,e),kR(this.store.add(e))}get(e){return kR(this.store.get(e)).next((t=>(void 0===t&&(t=null),AE("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return AE("SimpleDb","DELETE",this.store.name,e),kR(this.store.delete(e))}count(){return AE("SimpleDb","COUNT",this.store.name),kR(this.store.count())}Nt(e,t){const n=this.cursor(this.options(e,t)),r=[];return this.xt(n,((e,t)=>{r.push(t)})).next((()=>r))}kt(e,t){AE("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.$t=!1;const r=this.cursor(n);return this.xt(r,((e,t,n)=>n.delete()))}Ot(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.xt(r,t)}Ft(e){const t=this.cursor({});return new wR(((n,r)=>{t.onerror=e=>{const t=NR(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}xt(e,t){const n=[];return new wR(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new TR(i),o=t(i.primaryKey,i.value,s);if(o instanceof wR){const e=o.catch((e=>(s.done(),wR.reject(e))));n.push(e)}s.isDone?r():null===s.Dt?i.continue():i.continue(s.Dt)}})).next((()=>wR.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.$t?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function kR(e){return new wR(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=NR(e.target.error);n(t)}}))}let RR=!1;function NR(e){const t=IR._t(qo());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new kE("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return RR||(RR=!0,setTimeout((()=>{throw e}),0)),e}}return e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class AR extends _R{constructor(e,t){super(),this.Mt=e,this.currentSequenceNumber=t}}function PR(e,t){const n=LE(e);return IR.It(n.Mt,t)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class xR{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&AC(r,e,n[t])}}applyToLocalView(e){for(const t of this.baseMutations)t.key.isEqual(e.key)&&PC(t,e,this.localWriteTime);for(const t of this.mutations)t.key.isEqual(e.key)&&PC(t,e,this.localWriteTime)}applyToLocalDocumentSet(e){this.mutations.forEach((t=>{const n=e.get(t.key),r=n;this.applyToLocalView(r),n.isValidDocument()||r.convertToNoDocument($E.min())}))}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),sk())}isEqual(e){return this.batchId===e.batchId&&jE(this.mutations,e.mutations,((e,t)=>DC(e,t)))&&jE(this.baseMutations,e.baseMutations,((e,t)=>DC(e,t)))}}class DR{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){ME(e.mutations.length===n.length);let r=rk();const i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new DR(e,t,n,r)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class OR{constructor(e,t,n,r,i=$E.min(),s=$E.min(),o=XE.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(e){return new OR(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new OR(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new OR(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class MR{constructor(e){this.Lt=e}}function LR(e,t){if(t.document)return Dk(e.Lt,t.document,!!t.hasCommittedMutations);if(t.noDocument){const e=uS.fromSegments(t.noDocument.path),n=VR(t.noDocument.readTime),r=CS.newNoDocument(e,n);return t.hasCommittedMutations?r.setHasCommittedMutations():r}if(t.unknownDocument){const e=uS.fromSegments(t.unknownDocument.path),n=VR(t.unknownDocument.version);return CS.newUnknownDocument(e,n)}return OE()}function FR(e,t,n){const r=UR(n),i=t.key.path.popLast().toArray();if(t.isFoundDocument()){const n=function(e,t){return{name:Ck(e,t.key),fields:t.data.value.mapValue.fields,updateTime:wk(e,t.version.toTimestamp())}}(e.Lt,t),s=t.hasCommittedMutations;return new aR(null,null,n,s,r,i)}if(t.isNoDocument()){const e=t.key.path.toArray(),n=jR(t.version),s=t.hasCommittedMutations;return new aR(null,new sR(e,n),null,s,r,i)}if(t.isUnknownDocument()){const e=t.key.path.toArray(),n=jR(t.version);return new aR(new oR(e,n),null,null,!0,r,i)}return OE()}function UR(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function qR(e){const t=new BE(e[0],e[1]);return $E.fromTimestamp(t)}function jR(e){const t=e.toTimestamp();return new eR(t.seconds,t.nanoseconds)}function VR(e){const t=new BE(e.seconds,e.nanoseconds);return $E.fromTimestamp(t)}function BR(e,t){const n=(t.baseMutations||[]).map((t=>Mk(e.Lt,t)));for(let e=0;e<t.mutations.length-1;++e){const n=t.mutations[e];if(e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform){const r=t.mutations[e+1];n.updateTransforms=r.transform.fieldTransforms,t.mutations.splice(e+1,1),++e}}const r=t.mutations.map((t=>Mk(e.Lt,t))),i=BE.fromMillis(t.localWriteTimeMs);return new xR(t.batchId,i,n,r)}function $R(e){const t=VR(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?VR(e.lastLimboFreeSnapshotVersion):$E.min();let r;var i;return void 0!==e.query.documents?(ME(1===(i=e.query).documents.length),r=nC(QS(Nk(i.documents[0])))):r=function(e){return nC(Uk(e))}(e.query),new OR(r,e.targetId,0,e.lastListenSequenceNumber,t,n,XE.fromBase64String(e.resumeToken))}function WR(e,t){const n=jR(t.snapshotVersion),r=jR(t.lastLimboFreeSnapshotVersion);let i;i=PS(t.target)?Lk(e.Lt,t.target):Fk(e.Lt,t.target);const s=t.resumeToken.toBase64();return new uR(t.targetId,NS(t.target),n,s,t.sequenceNumber,r,i)}function KR(e){const t=Uk({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?rC(t,t.limit,"L"):t}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class zR{getBundleMetadata(e,t){return HR(e).get(t).next((e=>{if(e)return{id:(t=e).bundleId,createTime:VR(t.createTime),version:t.version};var t}))}saveBundleMetadata(e,t){return HR(e).put({bundleId:(n=t).id,createTime:jR(Tk(n.createTime)),version:n.version});var n}getNamedQuery(e,t){return GR(e).get(t).next((e=>{if(e)return{name:(t=e).name,query:KR(t.bundledQuery),readTime:VR(t.readTime)};var t}))}saveNamedQuery(e,t){return GR(e).put(function(e){return{name:e.name,readTime:jR(Tk(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function HR(e){return PR(e,pR.store)}function GR(e){return PR(e,gR.store)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class QR{constructor(){this.Bt=new YR}addToCollectionParentIndex(e,t){return this.Bt.add(t),wR.resolve()}getCollectionParents(e,t){return wR.resolve(this.Bt.getEntries(t))}}class YR{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new YC(GE.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new YC(GE.comparator)).toArray()}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class JR{constructor(){this.Ut=new YR}addToCollectionParentIndex(e,t){if(!this.Ut.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.Ut.add(t)}));const i={collectionId:n,parent:Yk(r)};return XR(e).put(i)}return wR.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[VE(t),""],!1,!0);return XR(e).Nt(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(Zk(r.parent))}return n}))}}function XR(e){return PR(e,dR.store)}
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const ZR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class eN{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new eN(e,eN.DEFAULT_COLLECTION_PERCENTILE,eN.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function tN(e,t,n){const r=e.store(rR.store),i=e.store(iR.store),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.Ot({range:o},((e,t,n)=>(a++,n.delete())));s.push(c.next((()=>{ME(1===a)})));const u=[];for(const e of n.mutations){const r=iR.key(t,e.key.path,n.batchId);s.push(i.delete(r)),u.push(e.key)}return wR.waitFor(s).next((()=>u))}function nN(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw OE();t=e.noDocument}return JSON.stringify(t).length}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */eN.DEFAULT_COLLECTION_PERCENTILE=10,eN.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,eN.DEFAULT=new eN(41943040,eN.DEFAULT_COLLECTION_PERCENTILE,eN.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),eN.DISABLED=new eN(-1,0,0);class rN{constructor(e,t,n,r){this.userId=e,this.R=t,this.qt=n,this.referenceDelegate=r,this.Kt={}}static Qt(e,t,n,r){ME(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new rN(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return sN(e).Ot({index:rR.userMutationsIndex,range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=oN(e),s=sN(e);return s.add({}).next((o=>{ME("number"==typeof o);const a=new xR(o,t,n,r),c=function(e,t,n){const r=n.baseMutations.map((t=>Ok(e.Lt,t))),i=n.mutations.map((t=>Ok(e.Lt,t)));return new rR(t,n.batchId,n.localWriteTime.toMillis(),r,i)}(this.R,this.userId,a),u=[];let l=new YC(((e,t)=>qE(e.canonicalString(),t.canonicalString())));for(const e of r){const t=iR.key(this.userId,e.key.path,o);l=l.add(e.key.path.popLast()),u.push(s.put(c)),u.push(i.put(t,iR.PLACEHOLDER))}return l.forEach((t=>{u.push(this.qt.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Kt[o]=a.keys()})),wR.waitFor(u).next((()=>a))}))}lookupMutationBatch(e,t){return sN(e).get(t).next((e=>e?(ME(e.userId===this.userId),BR(this.R,e)):null))}jt(e,t){return this.Kt[t]?wR.resolve(this.Kt[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Kt[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return sN(e).Ot({index:rR.userMutationsIndex,range:r},((e,t,r)=>{t.userId===this.userId&&(ME(t.batchId>=n),i=BR(this.R,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return sN(e).Ot({index:rR.userMutationsIndex,range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return sN(e).Nt(rR.userMutationsIndex,t).next((e=>e.map((e=>BR(this.R,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=iR.prefixForPath(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return oN(e).Ot({range:r},((n,r,s)=>{const[o,a,c]=n,u=Zk(a);if(o===this.userId&&t.path.isEqual(u))return sN(e).get(c).next((e=>{if(!e)throw OE();ME(e.userId===this.userId),i.push(BR(this.R,e))}));s.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new YC(qE);const r=[];return t.forEach((t=>{const i=iR.prefixForPath(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=oN(e).Ot({range:s},((e,r,i)=>{const[s,o,a]=e,c=Zk(o);s===this.userId&&t.path.isEqual(c)?n=n.add(a):i.done()}));r.push(o)})),wR.waitFor(r).next((()=>this.Wt(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=iR.prefixForPath(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new YC(qE);return oN(e).Ot({range:s},((e,t,i)=>{const[s,a,c]=e,u=Zk(a);s===this.userId&&n.isPrefixOf(u)?u.length===r&&(o=o.add(c)):i.done()})).next((()=>this.Wt(e,o)))}Wt(e,t){const n=[],r=[];return t.forEach((t=>{r.push(sN(e).get(t).next((e=>{if(null===e)throw OE();ME(e.userId===this.userId),n.push(BR(this.R,e))})))})),wR.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return tN(e.Mt,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.Gt(t.batchId)})),wR.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}Gt(e){delete this.Kt[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return wR.resolve();const n=IDBKeyRange.lowerBound(iR.prefixForUser(this.userId)),r=[];return oN(e).Ot({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=Zk(e[1]);r.push(t)}else n.done()})).next((()=>{ME(0===r.length)}))}))}containsKey(e,t){return iN(e,this.userId,t)}zt(e){return aN(e).get(this.userId).next((e=>e||new nR(this.userId,-1,"")))}}function iN(e,t,n){const r=iR.prefixForPath(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return oN(e).Ot({range:s,$t:!0},((e,n,r)=>{const[s,a,c]=e;s===t&&a===i&&(o=!0),r.done()})).next((()=>o))}function sN(e){return PR(e,rR.store)}function oN(e){return PR(e,iR.store)}function aN(e){return PR(e,nR.store)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class cN{constructor(e){this.Ht=e}next(){return this.Ht+=2,this.Ht}static Jt(){return new cN(0)}static Yt(){return new cN(-1)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class uN{constructor(e,t){this.referenceDelegate=e,this.R=t}allocateTargetId(e){return this.Xt(e).next((t=>{const n=new cN(t.highestTargetId);return t.highestTargetId=n.next(),this.Zt(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.Xt(e).next((e=>$E.fromTimestamp(new BE(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.Xt(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.Xt(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Zt(e,r))))}addTargetData(e,t){return this.te(e,t).next((()=>this.Xt(e).next((n=>(n.targetCount+=1,this.ee(t,n),this.Zt(e,n))))))}updateTargetData(e,t){return this.te(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>lN(e).delete(t.targetId))).next((()=>this.Xt(e))).next((t=>(ME(t.targetCount>0),t.targetCount-=1,this.Zt(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return lN(e).Ot(((s,o)=>{const a=$R(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))})).next((()=>wR.waitFor(i))).next((()=>r))}forEachTarget(e,t){return lN(e).Ot(((e,n)=>{const r=$R(n);t(r)}))}Xt(e){return hN(e).get(hR.key).next((e=>(ME(null!==e),e)))}Zt(e,t){return hN(e).put(hR.key,t)}te(e,t){return lN(e).put(WR(this.R,t))}ee(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Xt(e).next((e=>e.targetCount))}getTargetData(e,t){const n=NS(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return lN(e).Ot({range:r,index:uR.queryTargetsIndexName},((e,n,r)=>{const s=$R(n);AS(t,s.target)&&(i=s,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=dN(e);return t.forEach((t=>{const s=Yk(t.path);r.push(i.put(new lR(n,s))),r.push(this.referenceDelegate.addReference(e,n,t))})),wR.waitFor(r)}removeMatchingKeys(e,t,n){const r=dN(e);return wR.forEach(t,(t=>{const i=Yk(t.path);return wR.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=dN(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=dN(e);let i=sk();return r.Ot({range:n,$t:!0},((e,t,n)=>{const r=Zk(e[1]),s=new uS(r);i=i.add(s)})).next((()=>i))}containsKey(e,t){const n=Yk(t.path),r=IDBKeyRange.bound([n],[VE(n)],!1,!0);let i=0;return dN(e).Ot({index:lR.documentTargetsIndex,$t:!0,range:r},(([e,t],n,r)=>{0!==e&&(i++,r.done())})).next((()=>i>0))}lt(e,t){return lN(e).get(t).next((e=>e?$R(e):null))}}function lN(e){return PR(e,uR.store)}function hN(e){return PR(e,hR.store)}function dN(e){return PR(e,lR.store)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function fN(e){if(e.code!==CE.FAILED_PRECONDITION||e.message!==yR)throw e;AE("LocalStore","Unexpectedly lost primary lease")}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function pN([e,t],[n,r]){const i=qE(e,n);return 0===i?qE(t,r):i}class gN{constructor(e){this.ne=e,this.buffer=new YC(pN),this.se=0}ie(){return++this.se}re(e){const t=[e,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();pN(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class mN{constructor(e,t){this.garbageCollector=e,this.asyncQueue=t,this.oe=!1,this.ce=null}start(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ae(e)}stop(){this.ce&&(this.ce.cancel(),this.ce=null)}get started(){return null!==this.ce}ae(e){const t=this.oe?3e5:6e4;AE("LruGarbageCollector",`Garbage collection scheduled in ${t}ms`),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.ce=null,this.oe=!0;try{await e.collectGarbage(this.garbageCollector)}catch(e){SR(e)?AE("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await fN(e)}await this.ae(e)}))}}class yN{constructor(e,t){this.ue=e,this.params=t}calculateTargetCount(e,t){return this.ue.he(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return wR.resolve(SE.o);const n=new gN(t);return this.ue.forEachTarget(e,(e=>n.re(e.sequenceNumber))).next((()=>this.ue.le(e,(e=>n.re(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.ue.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.ue.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(AE("LruGarbageCollector","Garbage collection skipped; disabled"),wR.resolve(ZR)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(AE("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ZR):this.fe(e,t)))}getCacheSize(e){return this.ue.getCacheSize(e)}fe(e,t){let n,r,i,s,o,a,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(AE("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,o=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(c=Date.now(),NE()<=ka.DEBUG&&AE("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-u}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(a-o)+"ms\n"+`\tRemoved ${e} documents in `+(c-a)+"ms\n"+`Total Duration: ${c-u}ms`),wR.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class _N{constructor(e,t){this.db=e,this.garbageCollector=function(e,t){return new yN(e,t)}(this,t)}he(e){const t=this.de(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}de(e){let t=0;return this.le(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}le(e,t){return this.we(e,((e,n)=>t(n)))}addReference(e,t,n){return vN(e,n)}removeReference(e,t,n){return vN(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return vN(e,t)}_e(e,t){return function(e,t){let n=!1;return aN(e).Ft((r=>iN(e,r,t).next((e=>(e&&(n=!0),wR.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.we(e,((s,o)=>{if(o<=t){const t=this._e(e,s).next((t=>{if(!t)return i++,n.getEntry(e,s).next((()=>(n.removeEntry(s),dN(e).delete([0,Yk(s.path)]))))}));r.push(t)}})).next((()=>wR.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return vN(e,t)}we(e,t){const n=dN(e);let r,i=SE.o;return n.Ot({index:lR.documentTargetsIndex},(([e,n],{path:s,sequenceNumber:o})=>{0===e?(i!==SE.o&&t(new uS(Zk(r)),i),i=o,r=s):i=SE.o})).next((()=>{i!==SE.o&&t(new uS(Zk(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function vN(e,t){return dN(e).put(function(e,t){return new lR(0,Yk(e.path),t)}(t,e.currentSequenceNumber))}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class wN{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1}forEach(e){KE(this.inner,((t,n)=>{for(const[t,r]of n)e(t,r)}))}isEmpty(){return zE(this.inner)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class bN{constructor(){this.changes=new wN((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}getReadTime(e){const t=this.changes.get(e);return t?t.readTime:$E.min()}addEntry(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})}removeEntry(e,t=null){this.assertNotApplied(),this.changes.set(e,{document:CS.newInvalidDocument(e),readTime:t})}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?wR.resolve(n.document):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class IN{constructor(e,t){this.R=e,this.qt=t}addEntry(e,t,n){return SN(e).put(CN(t),n)}removeEntry(e,t){const n=SN(e),r=CN(t);return n.delete(r)}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.me(e,n))))}getEntry(e,t){return SN(e).get(CN(t)).next((e=>this.ge(t,e)))}ye(e,t){return SN(e).get(CN(t)).next((e=>({document:this.ge(t,e),size:nN(e)})))}getEntries(e,t){let n=ZC();return this.pe(e,t,((e,t)=>{const r=this.ge(e,t);n=n.insert(e,r)})).next((()=>n))}Ee(e,t){let n=ZC(),r=new HC(uS.comparator);return this.pe(e,t,((e,t)=>{const i=this.ge(e,t);n=n.insert(e,i),r=r.insert(e,nN(t))})).next((()=>({documents:n,Te:r})))}pe(e,t,n){if(t.isEmpty())return wR.resolve();const r=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),i=t.getIterator();let s=i.getNext();return SN(e).Ot({range:r},((e,t,r)=>{const o=uS.fromSegments(e);for(;s&&uS.comparator(s,o)<0;)n(s,null),s=i.getNext();s&&s.isEqual(o)&&(n(s,t),s=i.hasNext()?i.getNext():null),s?r.Ct(s.path.toArray()):r.done()})).next((()=>{for(;s;)n(s,null),s=i.hasNext()?i.getNext():null}))}getDocumentsMatchingQuery(e,t,n){let r=ZC();const i=t.path.length+1,s={};if(n.isEqual($E.min())){const e=t.path.toArray();s.range=IDBKeyRange.lowerBound(e)}else{const e=t.path.toArray(),r=UR(n);s.range=IDBKeyRange.lowerBound([e,r],!0),s.index=aR.collectionReadTimeIndex}return SN(e).Ot(s,((e,n,s)=>{if(e.length!==i)return;const o=LR(this.R,n);t.path.isPrefixOf(o.key.path)?aC(t,o)&&(r=r.insert(o.key,o)):s.done()})).next((()=>r))}newChangeBuffer(e){return new TN(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return EN(e).get(cR.key).next((e=>(ME(!!e),e)))}me(e,t){return EN(e).put(cR.key,t)}ge(e,t){if(t){const e=LR(this.R,t);if(!e.isNoDocument()||!e.version.isEqual($E.min()))return e}return CS.newInvalidDocument(e)}}class TN extends bN{constructor(e,t){super(),this.Ie=e,this.trackRemovals=t,this.Ae=new wN((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new YC(((e,t)=>qE(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,s)=>{const o=this.Ae.get(i);if(s.document.isValidDocument()){const a=FR(this.Ie.R,s.document,this.getReadTime(i));r=r.add(i.path.popLast());const c=nN(a);n+=c-o,t.push(this.Ie.addEntry(e,i,a))}else if(n-=o,this.trackRemovals){const n=FR(this.Ie.R,CS.newNoDocument(i,$E.min()),this.getReadTime(i));t.push(this.Ie.addEntry(e,i,n))}else t.push(this.Ie.removeEntry(e,i))})),r.forEach((n=>{t.push(this.Ie.qt.addToCollectionParentIndex(e,n))})),t.push(this.Ie.updateMetadata(e,n)),wR.waitFor(t)}getFromCache(e,t){return this.Ie.ye(e,t).next((e=>(this.Ae.set(t,e.size),e.document)))}getAllFromCache(e,t){return this.Ie.Ee(e,t).next((({documents:e,Te:t})=>(t.forEach(((e,t)=>{this.Ae.set(e,t)})),e)))}}function EN(e){return PR(e,cR.store)}function SN(e){return PR(e,aR.store)}function CN(e){return e.path.toArray()}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class kN{constructor(e){this.R=e}Rt(e,t,n,r){ME(n<r&&n>=0&&r<=11);const i=new bR("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(tR.store)}(e),function(e){e.createObjectStore(nR.store,{keyPath:nR.keyPath}),e.createObjectStore(rR.store,{keyPath:rR.keyPath,autoIncrement:!0}).createIndex(rR.userMutationsIndex,rR.userMutationsKeyPath,{unique:!0}),e.createObjectStore(iR.store)}(e),RN(e),function(e){e.createObjectStore(aR.store)}(e));let s=wR.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(lR.store),e.deleteObjectStore(uR.store),e.deleteObjectStore(hR.store)}(e),RN(e)),s=s.next((()=>function(e){const t=e.store(hR.store),n=new hR(0,0,$E.min().toTimestamp(),0);return t.put(hR.key,n)}(i)))),n<4&&r>=4&&(0!==n&&(s=s.next((()=>function(e,t){return t.store(rR.store).Nt().next((n=>{e.deleteObjectStore(rR.store),e.createObjectStore(rR.store,{keyPath:rR.keyPath,autoIncrement:!0}).createIndex(rR.userMutationsIndex,rR.userMutationsKeyPath,{unique:!0});const r=t.store(rR.store),i=n.map((e=>r.put(e)));return wR.waitFor(i)}))}(e,i)))),s=s.next((()=>{!function(e){e.createObjectStore(fR.store,{keyPath:fR.keyPath})}(e)}))),n<5&&r>=5&&(s=s.next((()=>this.Re(i)))),n<6&&r>=6&&(s=s.next((()=>(function(e){e.createObjectStore(cR.store)}(e),this.Pe(i))))),n<7&&r>=7&&(s=s.next((()=>this.be(i)))),n<8&&r>=8&&(s=s.next((()=>this.ve(e,i)))),n<9&&r>=9&&(s=s.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e),function(e){const t=e.objectStore(aR.store);t.createIndex(aR.readTimeIndex,aR.readTimeIndexPath,{unique:!1}),t.createIndex(aR.collectionReadTimeIndex,aR.collectionReadTimeIndexPath,{unique:!1})}(t)}))),n<10&&r>=10&&(s=s.next((()=>this.Ve(i)))),n<11&&r>=11&&(s=s.next((()=>{!function(e){e.createObjectStore(pR.store,{keyPath:pR.keyPath})}(e),function(e){e.createObjectStore(gR.store,{keyPath:gR.keyPath})}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e)}))),s}Pe(e){let t=0;return e.store(aR.store).Ot(((e,n)=>{t+=nN(n)})).next((()=>{const n=new cR(t);return e.store(cR.store).put(cR.key,n)}))}Re(e){const t=e.store(nR.store),n=e.store(rR.store);return t.Nt().next((t=>wR.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.Nt(rR.userMutationsIndex,r).next((n=>wR.forEach(n,(n=>{ME(n.userId===t.userId);const r=BR(this.R,n);return tN(e,t.userId,r).next((()=>{}))}))))}))))}be(e){const t=e.store(lR.store),n=e.store(aR.store);return e.store(hR.store).get(hR.key).next((e=>{const r=[];return n.Ot(((n,i)=>{const s=new GE(n),o=function(e){return[0,Yk(e)]}(s);r.push(t.get(o).next((n=>n?wR.resolve():(n=>t.put(new lR(0,Yk(n),e.highestListenSequenceNumber)))(s))))})).next((()=>wR.waitFor(r)))}))}ve(e,t){e.createObjectStore(dR.store,{keyPath:dR.keyPath});const n=t.store(dR.store),r=new YR,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:Yk(r)})}};return t.store(aR.store).Ot({$t:!0},((e,t)=>{const n=new GE(e);return i(n.popLast())})).next((()=>t.store(iR.store).Ot({$t:!0},(([e,t,n],r)=>{const s=Zk(t);return i(s.popLast())}))))}Ve(e){const t=e.store(uR.store);return t.Ot(((e,n)=>{const r=$R(n),i=WR(this.R,r);return t.put(i)}))}}function RN(e){e.createObjectStore(lR.store,{keyPath:lR.keyPath}).createIndex(lR.documentTargetsIndex,lR.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(uR.store,{keyPath:uR.keyPath}).createIndex(uR.queryTargetsIndexName,uR.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(hR.store)}const NN="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class AN{constructor(e,t,n,r,i,s,o,a,c,u){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Se=i,this.window=s,this.document=o,this.De=c,this.Ce=u,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.$e=null,this.Oe=null,this.Fe=Number.NEGATIVE_INFINITY,this.Me=e=>Promise.resolve(),!AN.gt())throw new kE(CE.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new _N(this,r),this.Le=t+"main",this.R=new MR(a),this.Be=new IR(this.Le,11,new kN(this.R)),this.Ue=new uN(this.referenceDelegate,this.R),this.qt=new JR,this.qe=function(e,t){return new IN(e,t)}(this.R,this.qt),this.Ke=new zR,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===u&&PE("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.je().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new kE(CE.FAILED_PRECONDITION,NN);return this.We(),this.Ge(),this.ze(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Ue.getHighestSequenceNumber(e)))})).then((e=>{this.Ne=new SE(e,this.De)})).then((()=>{this.xe=!0})).catch((e=>(this.Be&&this.Be.close(),Promise.reject(e))))}He(e){return this.Me=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Be.bt((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Se.enqueueAndForget((async()=>{this.started&&await this.je()})))}je(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>xN(e).put(new fR(this.clientId,Date.now(),this.networkEnabled,this.inForeground)).next((()=>{if(this.isPrimary)return this.Je(e).next((e=>{e||(this.isPrimary=!1,this.Se.enqueueRetryable((()=>this.Me(!1))))}))})).next((()=>this.Ye(e))).next((t=>this.isPrimary&&!t?this.Xe(e).next((()=>!1)):!!t&&this.Ze(e).next((()=>!0)))))).catch((e=>{if(SR(e))return AE("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return AE("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Se.enqueueRetryable((()=>this.Me(e))),this.isPrimary=e}))}Je(e){return PN(e).get(tR.key).next((e=>wR.resolve(this.tn(e))))}en(e){return xN(e).delete(this.clientId)}async nn(){if(this.isPrimary&&!this.sn(this.Fe,18e5)){this.Fe=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=PR(e,fR.store);return t.Nt().next((e=>{const n=this.rn(e,18e5),r=e.filter((e=>-1===n.indexOf(e)));return wR.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.Qe)for(const t of e)this.Qe.removeItem(this.on(t.clientId))}}ze(){this.Oe=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.je().then((()=>this.nn())).then((()=>this.ze()))))}tn(e){return!!e&&e.ownerId===this.clientId}Ye(e){return this.Ce?wR.resolve(!0):PN(e).get(tR.key).next((t=>{if(null!==t&&this.sn(t.leaseTimestampMs,5e3)&&!this.cn(t.ownerId)){if(this.tn(t)&&this.networkEnabled)return!0;if(!this.tn(t)){if(!t.allowTabSynchronization)throw new kE(CE.FAILED_PRECONDITION,NN);return!1}}return!(!this.networkEnabled||!this.inForeground)||xN(e).Nt().next((e=>void 0===this.rn(e,5e3).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&AE("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.xe=!1,this.an(),this.Oe&&(this.Oe.cancel(),this.Oe=null),this.un(),this.hn(),await this.Be.runTransaction("shutdown","readwrite",[tR.store,fR.store],(e=>{const t=new AR(e,SE.o);return this.Xe(t).next((()=>this.en(t)))})),this.Be.close(),this.ln()}rn(e,t){return e.filter((e=>this.sn(e.updateTimeMs,t)&&!this.cn(e.clientId)))}fn(){return this.runTransaction("getActiveClients","readonly",(e=>xN(e).Nt().next((e=>this.rn(e,18e5).map((e=>e.clientId))))))}get started(){return this.xe}getMutationQueue(e){return rN.Qt(e,this.R,this.qt,this.referenceDelegate)}getTargetCache(){return this.Ue}getRemoteDocumentCache(){return this.qe}getIndexManager(){return this.qt}getBundleCache(){return this.Ke}runTransaction(e,t,n){AE("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite";let i;return this.Be.runTransaction(e,r,mR,(r=>(i=new AR(r,this.Ne?this.Ne.next():SE.o),"readwrite-primary"===t?this.Je(i).next((e=>!!e||this.Ye(i))).next((t=>{if(!t)throw PE(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Se.enqueueRetryable((()=>this.Me(!1))),new kE(CE.FAILED_PRECONDITION,yR);return n(i)})).next((e=>this.Ze(i).next((()=>e)))):this.dn(i).next((()=>n(i)))))).then((e=>(i.raiseOnCommittedEvent(),e)))}dn(e){return PN(e).get(tR.key).next((e=>{if(null!==e&&this.sn(e.leaseTimestampMs,5e3)&&!this.cn(e.ownerId)&&!this.tn(e)&&!(this.Ce||this.allowTabSynchronization&&e.allowTabSynchronization))throw new kE(CE.FAILED_PRECONDITION,NN)}))}Ze(e){const t=new tR(this.clientId,this.allowTabSynchronization,Date.now());return PN(e).put(tR.key,t)}static gt(){return IR.gt()}Xe(e){const t=PN(e);return t.get(tR.key).next((e=>this.tn(e)?(AE("IndexedDbPersistence","Releasing primary lease."),t.delete(tR.key)):wR.resolve()))}sn(e,t){const n=Date.now();return!(e<n-t||e>n&&(PE(`Detected an update time that is in the future: ${e} > ${n}`),1))}We(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.$e=()=>{this.Se.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.je())))},this.document.addEventListener("visibilitychange",this.$e),this.inForeground="visible"===this.document.visibilityState)}un(){this.$e&&(this.document.removeEventListener("visibilitychange",this.$e),this.$e=null)}Ge(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ke=()=>{this.an(),this.Se.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.ke))}hn(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)}cn(e){var t;try{const n=null!==(null===(t=this.Qe)||void 0===t?void 0:t.getItem(this.on(e)));return AE("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return PE("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}an(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(e){PE("Failed to set zombie client id.",e)}}ln(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(e){}}on(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function PN(e){return PR(e,tR.store)}function xN(e){return PR(e,fR.store)}function DN(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}class ON{constructor(e,t){this.progress=e,this.wn=t}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class MN{constructor(e,t,n){this.qe=e,this._n=t,this.qt=n}mn(e,t){return this._n.getAllMutationBatchesAffectingDocumentKey(e,t).next((n=>this.gn(e,t,n)))}gn(e,t,n){return this.qe.getEntry(e,t).next((e=>{for(const t of n)t.applyToLocalView(e);return e}))}yn(e,t){e.forEach(((e,n)=>{for(const e of t)e.applyToLocalView(n)}))}pn(e,t){return this.qe.getEntries(e,t).next((t=>this.En(e,t).next((()=>t))))}En(e,t){return this._n.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>this.yn(t,e)))}getDocumentsMatchingQuery(e,t,n){return function(e){return uS.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.Tn(e,t.path):eC(t)?this.In(e,t,n):this.An(e,t,n)}Tn(e,t){return this.mn(e,new uS(t)).next((e=>{let t=tk();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}In(e,t,n){const r=t.collectionGroup;let i=tk();return this.qt.getCollectionParents(e,r).next((s=>wR.forEach(s,(s=>{const o=function(e,t){return new HS(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(r));return this.An(e,o,n).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}An(e,t,n){let r,i;return this.qe.getDocumentsMatchingQuery(e,t,n).next((n=>(r=n,this._n.getAllMutationBatchesAffectingQuery(e,t)))).next((t=>(i=t,this.Rn(e,i,r).next((e=>{r=e;for(const e of i)for(const t of e.mutations){const n=t.key;let i=r.get(n);null==i&&(i=CS.newInvalidDocument(n),r=r.insert(n,i)),PC(t,i,e.localWriteTime),i.isFoundDocument()||(r=r.remove(n))}}))))).next((()=>(r.forEach(((e,n)=>{aC(t,n)||(r=r.remove(e))})),r)))}Rn(e,t,n){let r=sk();for(const e of t)for(const t of e.mutations)t instanceof LC&&null===n.get(t.key)&&(r=r.add(t.key));let i=n;return this.qe.getEntries(e,r).next((e=>(e.forEach(((e,t)=>{t.isFoundDocument()&&(i=i.insert(e,t))})),i)))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class LN{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Pn=n,this.bn=r}static vn(e,t){let n=sk(),r=sk();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new LN(e,t.fromCache,n,r)}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class FN{Vn(e){this.Sn=e}getDocumentsMatchingQuery(e,t,n,r){return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||n.isEqual($E.min())?this.Dn(e,t):this.Sn.pn(e,r).next((i=>{const s=this.Cn(t,i);return(YS(t)||JS(t))&&this.Nn(t.limitType,s,r,n)?this.Dn(e,t):(NE()<=ka.DEBUG&&AE("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),oC(t)),this.Sn.getDocumentsMatchingQuery(e,t,n).next((e=>(s.forEach((t=>{e=e.insert(t.key,t)})),e))))}))}Cn(e,t){let n=new YC(cC(e));return t.forEach(((t,r)=>{aC(e,r)&&(n=n.add(r))})),n}Nn(e,t,n,r){if(n.size!==t.size)return!0;const i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Dn(e,t){return NE()<=ka.DEBUG&&AE("QueryEngine","Using full collection scan to execute query:",oC(t)),this.Sn.getDocumentsMatchingQuery(e,t,$E.min())}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class UN{constructor(e,t,n,r){this.persistence=e,this.xn=t,this.R=r,this.kn=new HC(qE),this.$n=new wN((e=>NS(e)),AS),this.On=$E.min(),this._n=e.getMutationQueue(n),this.Fn=e.getRemoteDocumentCache(),this.Ue=e.getTargetCache(),this.Mn=new MN(this.Fn,this._n,this.persistence.getIndexManager()),this.Ke=e.getBundleCache(),this.xn.Vn(this.Mn)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.kn)))}}function qN(e,t,n,r){return new UN(e,t,n,r)}async function jN(e,t){const n=LE(e);let r=n._n,i=n.Mn;const s=await n.persistence.runTransaction("Handle user change","readonly",(e=>{let s;return n._n.getAllMutationBatches(e).next((o=>(s=o,r=n.persistence.getMutationQueue(t),i=new MN(n.Fn,r,n.persistence.getIndexManager()),r.getAllMutationBatches(e)))).next((t=>{const n=[],r=[];let o=sk();for(const e of s){n.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return i.pn(e,o).next((e=>({Ln:e,removedBatchIds:n,addedBatchIds:r})))}))}));return n._n=r,n.Mn=i,n.xn.Vn(n.Mn),s}function VN(e){const t=LE(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Ue.getLastRemoteSnapshotVersion(e)))}function BN(e,t,n,r,i){let s=sk();return n.forEach((e=>s=s.add(e))),t.getEntries(e,s).next((e=>{let s=ZC();return n.forEach(((n,o)=>{const a=e.get(n),c=(null==i?void 0:i.get(n))||r;o.isNoDocument()&&o.version.isEqual($E.min())?(t.removeEntry(n,c),s=s.insert(n,o)):!a.isValidDocument()||o.version.compareTo(a.version)>0||0===o.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(o,c),s=s.insert(n,o)):AE("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",o.version)})),s}))}function $N(e,t){const n=LE(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n._n.getNextMutationBatchAfterBatchId(e,t))))}function WN(e,t){const n=LE(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Ue.getTargetData(e,t).next((i=>i?(r=i,wR.resolve(r)):n.Ue.allocateTargetId(e).next((i=>(r=new OR(t,i,0,e.currentSequenceNumber),n.Ue.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.kn.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.kn=n.kn.insert(e.targetId,e),n.$n.set(t,e.targetId)),e}))}async function KN(e,t,n){const r=LE(e),i=r.kn.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!SR(e))throw e;AE("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.kn=r.kn.remove(t),r.$n.delete(i.target)}function zN(e,t,n){const r=LE(e);let i=$E.min(),s=sk();return r.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const r=LE(e),i=r.$n.get(n);return void 0!==i?wR.resolve(r.kn.get(i)):r.Ue.getTargetData(t,n)}(r,e,nC(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ue.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.xn.getDocumentsMatchingQuery(e,t,n?i:$E.min(),n?s:sk()))).next((e=>({documents:e,Bn:s})))))}function HN(e,t){const n=LE(e),r=LE(n.Ue),i=n.kn.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(e=>r.lt(e,t).next((e=>e?e.target:null))))}function GN(e){const t=LE(e);return t.persistence.runTransaction("Get new document changes","readonly",(e=>function(e,t,n){const r=LE(e);let i=ZC(),s=UR(n);const o=SN(t),a=IDBKeyRange.lowerBound(s,!0);return o.Ot({index:aR.readTimeIndex,range:a},((e,t)=>{const n=LR(r.R,t);i=i.insert(n.key,n),s=t.readTime})).next((()=>({wn:i,readTime:qR(s)})))}(t.Fn,e,t.On))).then((({wn:e,readTime:n})=>(t.On=n,e)))}async function QN(e,t,n=sk()){const r=await WN(e,nC(KR(t.bundledQuery))),i=LE(e);return i.persistence.runTransaction("Save named query","readwrite",(e=>{const s=Tk(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.Ke.saveNamedQuery(e,t);const o=r.withResumeToken(XE.EMPTY_BYTE_STRING,s);return i.kn=i.kn.insert(o.targetId,o),i.Ue.updateTargetData(e,o).next((()=>i.Ue.removeMatchingKeysForTargetId(e,r.targetId))).next((()=>i.Ue.addMatchingKeys(e,n,r.targetId))).next((()=>i.Ke.saveNamedQuery(e,t)))}))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class YN{constructor(e){this.R=e,this.Qn=new Map,this.jn=new Map}getBundleMetadata(e,t){return wR.resolve(this.Qn.get(t))}saveBundleMetadata(e,t){var n;return this.Qn.set(t.id,{id:(n=t).id,version:n.version,createTime:Tk(n.createTime)}),wR.resolve()}getNamedQuery(e,t){return wR.resolve(this.jn.get(t))}saveNamedQuery(e,t){return this.jn.set(t.name,function(e){return{name:e.name,query:KR(e.bundledQuery),readTime:Tk(e.readTime)}}(t)),wR.resolve()}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class JN{constructor(){this.Wn=new YC(XN.Gn),this.zn=new YC(XN.Hn)}isEmpty(){return this.Wn.isEmpty()}addReference(e,t){const n=new XN(e,t);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)}Jn(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Yn(new XN(e,t))}Xn(e,t){e.forEach((e=>this.removeReference(e,t)))}Zn(e){const t=new uS(new GE([])),n=new XN(t,e),r=new XN(t,e+1),i=[];return this.zn.forEachInRange([n,r],(e=>{this.Yn(e),i.push(e.key)})),i}ts(){this.Wn.forEach((e=>this.Yn(e)))}Yn(e){this.Wn=this.Wn.delete(e),this.zn=this.zn.delete(e)}es(e){const t=new uS(new GE([])),n=new XN(t,e),r=new XN(t,e+1);let i=sk();return this.zn.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new XN(e,0),n=this.Wn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class XN{constructor(e,t){this.key=e,this.ns=t}static Gn(e,t){return uS.comparator(e.key,t.key)||qE(e.ns,t.ns)}static Hn(e,t){return qE(e.ns,t.ns)||uS.comparator(e.key,t.key)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ZN{constructor(e,t){this.qt=e,this.referenceDelegate=t,this._n=[],this.ss=1,this.rs=new YC(XN.Gn)}checkEmpty(e){return wR.resolve(0===this._n.length)}addMutationBatch(e,t,n,r){const i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];const s=new xR(i,t,n,r);this._n.push(s);for(const t of r)this.rs=this.rs.add(new XN(t.key,i)),this.qt.addToCollectionParentIndex(e,t.key.path.popLast());return wR.resolve(s)}lookupMutationBatch(e,t){return wR.resolve(this.os(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.cs(n),i=r<0?0:r;return wR.resolve(this._n.length>i?this._n[i]:null)}getHighestUnacknowledgedBatchId(){return wR.resolve(0===this._n.length?-1:this.ss-1)}getAllMutationBatches(e){return wR.resolve(this._n.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new XN(t,0),r=new XN(t,Number.POSITIVE_INFINITY),i=[];return this.rs.forEachInRange([n,r],(e=>{const t=this.os(e.ns);i.push(t)})),wR.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new YC(qE);return t.forEach((e=>{const t=new XN(e,0),r=new XN(e,Number.POSITIVE_INFINITY);this.rs.forEachInRange([t,r],(e=>{n=n.add(e.ns)}))})),wR.resolve(this.us(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;uS.isDocumentKey(i)||(i=i.child(""));const s=new XN(new uS(i),0);let o=new YC(qE);return this.rs.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ns)),!0)}),s),wR.resolve(this.us(o))}us(e){const t=[];return e.forEach((e=>{const n=this.os(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){ME(0===this.hs(t.batchId,"removed")),this._n.shift();let n=this.rs;return wR.forEach(t.mutations,(r=>{const i=new XN(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.rs=n}))}Gt(e){}containsKey(e,t){const n=new XN(t,0),r=this.rs.firstAfterOrEqual(n);return wR.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this._n.length,wR.resolve()}hs(e,t){return this.cs(e)}cs(e){return 0===this._n.length?0:e-this._n[0].batchId}os(e){const t=this.cs(e);return t<0||t>=this._n.length?null:this._n[t]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class eA{constructor(e,t){this.qt=e,this.ls=t,this.docs=new HC(uS.comparator),this.size=0}addEntry(e,t,n){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ls(t);return this.docs=this.docs.insert(r,{document:t.clone(),size:o,readTime:n}),this.size+=o-s,this.qt.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return wR.resolve(n?n.document.clone():CS.newInvalidDocument(t))}getEntries(e,t){let n=ZC();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.clone():CS.newInvalidDocument(e))})),wR.resolve(n)}getDocumentsMatchingQuery(e,t,n){let r=ZC();const i=new uS(t.path.child("")),s=this.docs.getIteratorFrom(i);for(;s.hasNext();){const{key:e,value:{document:i,readTime:o}}=s.getNext();if(!t.path.isPrefixOf(e.path))break;o.compareTo(n)<=0||aC(t,i)&&(r=r.insert(i.key,i.clone()))}return wR.resolve(r)}fs(e,t){return wR.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new tA(this)}getSize(e){return wR.resolve(this.size)}}class tA extends bN{constructor(e){super(),this.Ie=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.document.isValidDocument()?t.push(this.Ie.addEntry(e,r.document,this.getReadTime(n))):this.Ie.removeEntry(n)})),wR.waitFor(t)}getFromCache(e,t){return this.Ie.getEntry(e,t)}getAllFromCache(e,t){return this.Ie.getEntries(e,t)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class nA{constructor(e){this.persistence=e,this.ds=new wN((e=>NS(e)),AS),this.lastRemoteSnapshotVersion=$E.min(),this.highestTargetId=0,this.ws=0,this._s=new JN,this.targetCount=0,this.gs=cN.Jt()}forEachTarget(e,t){return this.ds.forEach(((e,n)=>t(n))),wR.resolve()}getLastRemoteSnapshotVersion(e){return wR.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return wR.resolve(this.ws)}allocateTargetId(e){return this.highestTargetId=this.gs.next(),wR.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ws&&(this.ws=t),wR.resolve()}te(e){this.ds.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.gs=new cN(t),this.highestTargetId=t),e.sequenceNumber>this.ws&&(this.ws=e.sequenceNumber)}addTargetData(e,t){return this.te(t),this.targetCount+=1,wR.resolve()}updateTargetData(e,t){return this.te(t),wR.resolve()}removeTargetData(e,t){return this.ds.delete(t.target),this._s.Zn(t.targetId),this.targetCount-=1,wR.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.ds.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.ds.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),wR.waitFor(i).next((()=>r))}getTargetCount(e){return wR.resolve(this.targetCount)}getTargetData(e,t){const n=this.ds.get(t)||null;return wR.resolve(n)}addMatchingKeys(e,t,n){return this._s.Jn(t,n),wR.resolve()}removeMatchingKeys(e,t,n){this._s.Xn(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),wR.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._s.Zn(t),wR.resolve()}getMatchingKeysForTargetId(e,t){const n=this._s.es(t);return wR.resolve(n)}containsKey(e,t){return wR.resolve(this._s.containsKey(t))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class rA{constructor(e,t){this.ys={},this.Ne=new SE(0),this.xe=!1,this.xe=!0,this.referenceDelegate=e(this),this.Ue=new nA(this),this.qt=new QR,this.qe=function(e,t){return new eA(e,t)}(this.qt,(e=>this.referenceDelegate.ps(e))),this.R=new MR(t),this.Ke=new YN(this.R)}start(){return Promise.resolve()}shutdown(){return this.xe=!1,Promise.resolve()}get started(){return this.xe}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.qt}getMutationQueue(e){let t=this.ys[e.toKey()];return t||(t=new ZN(this.qt,this.referenceDelegate),this.ys[e.toKey()]=t),t}getTargetCache(){return this.Ue}getRemoteDocumentCache(){return this.qe}getBundleCache(){return this.Ke}runTransaction(e,t,n){AE("MemoryPersistence","Starting transaction:",e);const r=new iA(this.Ne.next());return this.referenceDelegate.Es(),n(r).next((e=>this.referenceDelegate.Ts(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Is(e,t){return wR.or(Object.values(this.ys).map((n=>()=>n.containsKey(e,t))))}}class iA extends _R{constructor(e){super(),this.currentSequenceNumber=e}}class sA{constructor(e){this.persistence=e,this.As=new JN,this.Rs=null}static Ps(e){return new sA(e)}get bs(){if(this.Rs)return this.Rs;throw OE()}addReference(e,t,n){return this.As.addReference(n,t),this.bs.delete(n.toString()),wR.resolve()}removeReference(e,t,n){return this.As.removeReference(n,t),this.bs.add(n.toString()),wR.resolve()}markPotentiallyOrphaned(e,t){return this.bs.add(t.toString()),wR.resolve()}removeTarget(e,t){this.As.Zn(t.targetId).forEach((e=>this.bs.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.bs.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Es(){this.Rs=new Set}Ts(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return wR.forEach(this.bs,(n=>{const r=uS.fromPath(n);return this.vs(e,r).next((e=>{e||t.removeEntry(r)}))})).next((()=>(this.Rs=null,t.apply(e))))}updateLimboDocument(e,t){return this.vs(e,t).next((e=>{e?this.bs.delete(t.toString()):this.bs.add(t.toString())}))}ps(e){return 0}vs(e,t){return wR.or([()=>wR.resolve(this.As.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Is(e,t)])}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class oA{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}function aA(e,t){return`firestore_clients_${e}_${t}`}function cA(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function uA(e,t){return`firestore_targets_${e}_${t}`}oA.UNAUTHENTICATED=new oA(null),oA.GOOGLE_CREDENTIALS=new oA("google-credentials-uid"),oA.FIRST_PARTY=new oA("first-party-uid");class lA{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Vs(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new kE(r.error.code,r.error.message))),s?new lA(e,t,r.state,i):(PE("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Ss(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class hA{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Vs(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new kE(n.error.code,n.error.message))),i?new hA(e,n.state,r):(PE("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Ss(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class dA{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Vs(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=ak();for(let e=0;r&&e<n.activeTargetIds.length;++e)r=cS(n.activeTargetIds[e]),i=i.add(n.activeTargetIds[e]);return r?new dA(e,i):(PE("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class fA{constructor(e,t){this.clientId=e,this.onlineState=t}static Vs(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new fA(t.clientId,t.onlineState):(PE("SharedClientState",`Failed to parse online state: ${e}`),null)}}class pA{constructor(){this.activeTargetIds=ak()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}Cs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ss(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gA{constructor(e,t,n,r,i){this.window=e,this.Se=t,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.$s=new HC(qE),this.started=!1,this.Os=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Fs=aA(this.persistenceKey,this.Ns),this.Ms=function(e){return`firestore_sequence_number_${e}`}
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(this.persistenceKey),this.$s=this.$s.insert(this.Ns,new pA),this.Ls=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Bs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Us=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.qs=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.Ks=function(e){return`firestore_bundle_loaded_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}static gt(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.fn();for(const t of e){if(t===this.Ns)continue;const e=this.getItem(aA(this.persistenceKey,t));if(e){const n=dA.Vs(t,e);n&&(this.$s=this.$s.insert(n.clientId,n))}}this.Qs();const t=this.storage.getItem(this.qs);if(t){const e=this.js(t);e&&this.Ws(e)}for(const e of this.Os)this.ks(e);this.Os=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ms,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Gs(this.$s)}isActiveQueryTarget(e){let t=!1;return this.$s.forEach(((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.zs(e,"pending")}updateMutationState(e,t,n){this.zs(e,t,n),this.Hs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(uA(this.persistenceKey,e));if(n){const r=hA.Vs(e,n);r&&(t=r.state)}}return this.Js.Ds(e),this.Qs(),t}removeLocalQueryTarget(e){this.Js.Cs(e),this.Qs()}isLocalQueryTarget(e){return this.Js.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(uA(this.persistenceKey,e))}updateQueryState(e,t,n){this.Ys(e,t,n)}handleUserChange(e,t,n){t.forEach((e=>{this.Hs(e)})),this.currentUser=e,n.forEach((e=>{this.addPendingMutation(e)}))}setOnlineState(e){this.Xs(e)}notifyBundleLoaded(){this.Zs()}shutdown(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Fs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return AE("SharedClientState","READ",e,t),t}setItem(e,t){AE("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){AE("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ks(e){const t=e;if(t.storageArea===this.storage){if(AE("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Fs)return void PE("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((async()=>{if(this.started){if(null!==t.key)if(this.Ls.test(t.key)){if(null==t.newValue){const e=this.ti(t.key);return this.ei(e,null)}{const e=this.ni(t.key,t.newValue);if(e)return this.ei(e.clientId,e)}}else if(this.Bs.test(t.key)){if(null!==t.newValue){const e=this.si(t.key,t.newValue);if(e)return this.ii(e)}}else if(this.Us.test(t.key)){if(null!==t.newValue){const e=this.ri(t.key,t.newValue);if(e)return this.oi(e)}}else if(t.key===this.qs){if(null!==t.newValue){const e=this.js(t.newValue);if(e)return this.Ws(e)}}else if(t.key===this.Ms){const e=function(e){let t=SE.o;if(null!=e)try{const n=JSON.parse(e);ME("number"==typeof n),t=n}catch(e){PE("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==SE.o&&this.sequenceNumberHandler(e)}else if(t.key===this.Ks)return this.syncEngine.ci()}else this.Os.push(t)}))}}get Js(){return this.$s.get(this.Ns)}Qs(){this.setItem(this.Fs,this.Js.Ss())}zs(e,t,n){const r=new lA(this.currentUser,e,t,n),i=cA(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Ss())}Hs(e){const t=cA(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Xs(e){const t={clientId:this.Ns,onlineState:e};this.storage.setItem(this.qs,JSON.stringify(t))}Ys(e,t,n){const r=uA(this.persistenceKey,e),i=new hA(e,t,n);this.setItem(r,i.Ss())}Zs(){this.setItem(this.Ks,"value-not-used")}ti(e){const t=this.Ls.exec(e);return t?t[1]:null}ni(e,t){const n=this.ti(e);return dA.Vs(n,t)}si(e,t){const n=this.Bs.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return lA.Vs(new oA(i),r,t)}ri(e,t){const n=this.Us.exec(e),r=Number(n[1]);return hA.Vs(r,t)}js(e){return fA.Vs(e)}async ii(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.ai(e.batchId,e.state,e.error);AE("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}oi(e){return this.syncEngine.ui(e.targetId,e.state,e.error)}ei(e,t){const n=t?this.$s.insert(e,t):this.$s.remove(e),r=this.Gs(this.$s),i=this.Gs(n),s=[],o=[];return i.forEach((e=>{r.has(e)||s.push(e)})),r.forEach((e=>{i.has(e)||o.push(e)})),this.syncEngine.hi(s,o).then((()=>{this.$s=n}))}Ws(e){this.$s.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Gs(e){let t=ak();return e.forEach(((e,n)=>{t=t.unionWith(n.activeTargetIds)})),t}}class mA{constructor(){this.li=new pA,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.li.Ds(e),this.fi[e]||"not-current"}updateQueryState(e,t,n){this.fi[e]=t}removeLocalQueryTarget(e){this.li.Cs(e)}isLocalQueryTarget(e){return this.li.activeTargetIds.has(e)}clearQueryState(e){delete this.fi[e]}getAllActiveQueryTargets(){return this.li.activeTargetIds}isActiveQueryTarget(e){return this.li.activeTargetIds.has(e)}start(){return this.li=new pA,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(){}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class yA{di(e){}shutdown(){}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class _A{constructor(){this.wi=()=>this._i(),this.mi=()=>this.gi(),this.yi=[],this.pi()}di(e){this.yi.push(e)}shutdown(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)}pi(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)}_i(){AE("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.yi)e(0)}gi(){AE("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.yi)e(1)}static gt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const vA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class wA{constructor(e){this.Ei=e.Ei,this.Ti=e.Ti}Ii(e){this.Ai=e}Ri(e){this.Pi=e}onMessage(e){this.bi=e}close(){this.Ti()}send(e){this.Ei(e)}vi(){this.Ai()}Vi(e){this.Pi(e)}Si(e){this.bi(e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class bA extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.Di=t+"://"+e.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Ni(e,t,n,r){const i=this.xi(e,t);AE("RestConnection","Sending: ",i,n);const s={};return this.ki(s,r),this.$i(e,i,s,n).then((e=>(AE("RestConnection","Received: ",e),e)),(t=>{throw xE("RestConnection",`${e} failed with error: `,t,"url: ",i,"request:",n),t}))}Oi(e,t,n,r){return this.Ni(e,t,n,r)}ki(e,t){if(e["X-Goog-Api-Client"]="gl-js/ fire/"+EE,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t)for(const n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n])}xi(e,t){const n=vA[e];return`${this.Di}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}$i(e,t,n,r){return new Promise(((i,s)=>{const o=new TE;o.listenOnce(yE.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case mE.NO_ERROR:const t=o.getResponseJson();AE("Connection","XHR received:",JSON.stringify(t)),i(t);break;case mE.TIMEOUT:AE("Connection",'RPC "'+e+'" timed out'),s(new kE(CE.DEADLINE_EXCEEDED,"Request time out"));break;case mE.HTTP_ERROR:const n=o.getStatus();if(AE("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const e=o.getResponseJson().error;if(e&&e.status&&e.message){const t=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(CE).indexOf(t)>=0?t:CE.UNKNOWN}(e.status);s(new kE(t,e.message))}else s(new kE(CE.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new kE(CE.UNAVAILABLE,"Connection failed."));break;default:OE()}}finally{AE("Connection",'RPC "'+e+'" completed.')}}));const a=JSON.stringify(r);o.send(t,"POST",a,n,15)}))}Fi(e,t){const n=[this.Di,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=new hE,i=iI(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new bE({})),this.ki(s.initMessageHeaders,t),jo()||$o()||qo().indexOf("Electron/")>=0||Wo()||qo().indexOf("MSAppHost/")>=0||Bo()||(s.httpHeadersOverwriteParam="$httpHeaders");const o=n.join("");AE("Connection","Creating WebChannel: "+o,s);const a=r.createWebChannel(o,s);let c=!1,u=!1;const l=new wA({Ei:e=>{u?AE("Connection","Not sending because WebChannel is closed:",e):(c||(AE("Connection","Opening WebChannel transport."),a.open(),c=!0),AE("Connection","WebChannel sending:",e),a.send(e))},Ti:()=>a.close()}),h=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return h(a,IE.EventType.OPEN,(()=>{u||AE("Connection","WebChannel transport opened.")})),h(a,IE.EventType.CLOSE,(()=>{u||(u=!0,AE("Connection","WebChannel transport closed"),l.Vi())})),h(a,IE.EventType.ERROR,(e=>{u||(u=!0,xE("Connection","WebChannel transport errored:",e),l.Vi(new kE(CE.UNAVAILABLE,"The operation could not be completed")))})),h(a,IE.EventType.MESSAGE,(e=>{var t;if(!u){const n=e.data[0];ME(!!n);const r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){AE("Connection","WebChannel received error:",i);const e=i.status;let t=function(e){const t=$C[e];if(void 0!==t)return zC(t)}(e),n=i.message;void 0===t&&(t=CE.INTERNAL,n="Unknown error status: "+e+" with message "+i.message),u=!0,l.Vi(new kE(t,n)),a.close()}else AE("Connection","WebChannel received:",n),l.Si(n)}})),h(i,_E.STAT_EVENT,(e=>{e.stat===vE?AE("Connection","Detected buffering proxy"):e.stat===wE&&AE("Connection","Detected no buffering proxy")})),setTimeout((()=>{l.vi()}),0),l}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function IA(){return"undefined"!=typeof window?window:null}function TA(){return"undefined"!=typeof document?document:null}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function EA(e){return new vk(e,!0)}class SA{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Se=e,this.timerId=t,this.Mi=n,this.Li=r,this.Bi=i,this.Ui=0,this.qi=null,this.Ki=Date.now(),this.reset()}reset(){this.Ui=0}Qi(){this.Ui=this.Bi}ji(e){this.cancel();const t=Math.floor(this.Ui+this.Wi()),n=Math.max(0,Date.now()-this.Ki),r=Math.max(0,t-n);r>0&&AE("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ui} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.qi=this.Se.enqueueAfterDelay(this.timerId,r,(()=>(this.Ki=Date.now(),e()))),this.Ui*=this.Li,this.Ui<this.Mi&&(this.Ui=this.Mi),this.Ui>this.Bi&&(this.Ui=this.Bi)}Gi(){null!==this.qi&&(this.qi.skipDelay(),this.qi=null)}cancel(){null!==this.qi&&(this.qi.cancel(),this.qi=null)}Wi(){return(Math.random()-.5)*this.Ui}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class CA{constructor(e,t,n,r,i,s){this.Se=e,this.zi=n,this.Hi=r,this.Ji=i,this.listener=s,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new SA(e,t)}tr(){return 1===this.state||2===this.state||4===this.state}er(){return 2===this.state}start(){3!==this.state?this.auth():this.nr()}async stop(){this.tr()&&await this.close(0)}sr(){this.state=0,this.Zi.reset()}ir(){this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(()=>this.rr())))}cr(e){this.ar(),this.stream.send(e)}async rr(){if(this.er())return this.close(0)}ar(){this.Xi&&(this.Xi.cancel(),this.Xi=null)}async close(e,t){this.ar(),this.Zi.cancel(),this.Yi++,3!==e?this.Zi.reset():t&&t.code===CE.RESOURCE_EXHAUSTED?(PE(t.toString()),PE("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):t&&t.code===CE.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ur(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Ri(t)}ur(){}auth(){this.state=1;const e=this.hr(this.Yi),t=this.Yi;this.Ji.getToken().then((e=>{this.Yi===t&&this.lr(e)}),(t=>{e((()=>{const e=new kE(CE.UNKNOWN,"Fetching auth token failed: "+t.message);return this.dr(e)}))}))}lr(e){const t=this.hr(this.Yi);this.stream=this.wr(e),this.stream.Ii((()=>{t((()=>(this.state=2,this.listener.Ii())))})),this.stream.Ri((e=>{t((()=>this.dr(e)))})),this.stream.onMessage((e=>{t((()=>this.onMessage(e)))}))}nr(){this.state=4,this.Zi.ji((async()=>{this.state=0,this.start()}))}dr(e){return AE("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(3,e)}hr(e){return t=>{this.Se.enqueueAndForget((()=>this.Yi===e?t():(AE("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class kA extends CA{constructor(e,t,n,r,i){super(e,"listen_stream_connection_backoff","listen_stream_idle",t,n,i),this.R=r}wr(e){return this.Hi.Fi("Listen",e)}onMessage(e){this.Zi.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:OE()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.I?(ME(void 0===t||"string"==typeof t),XE.fromBase64String(t||"")):(ME(void 0===t||t instanceof Uint8Array),XE.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?CE.UNKNOWN:zC(e.code);return new kE(t,e.message||"")}(o);n=new dk(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=kk(e,r.document.name),s=Tk(r.document.updateTime),o=new ES({mapValue:{fields:r.document.fields}}),a=CS.newFoundDocument(i,s,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new lk(c,u,a.key,a)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=kk(e,r.document),s=r.readTime?Tk(r.readTime):$E.min(),o=CS.newNoDocument(i,s),a=r.removedTargetIds||[];n=new lk([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=kk(e,r.document),s=r.removedTargetIds||[];n=new lk([],s,i,null)}else{if(!("filter"in t))return OE();{t.filter;const e=t.filter;e.targetId;const r=e.count||0,i=new BC(r),s=e.targetId;n=new hk(s,i)}}return n}(this.R,e),n=function(e){if(!("targetChange"in e))return $E.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?$E.min():t.readTime?Tk(t.readTime):$E.min()}(e);return this.listener._r(t,n)}mr(e){const t={};t.database=Ak(this.R),t.addTarget=function(e,t){let n;const r=t.target;return n=PS(r)?{documents:Lk(e,r)}:{query:Fk(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=bk(e,t.resumeToken):t.snapshotVersion.compareTo($E.min())>0&&(n.readTime=wk(e,t.snapshotVersion.toTimestamp())),n}(this.R,e);const n=function(e,t){const n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return OE()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,e);n&&(t.labels=n),this.cr(t)}gr(e){const t={};t.database=Ak(this.R),t.removeTarget=e,this.cr(t)}}class RA extends CA{constructor(e,t,n,r,i){super(e,"write_stream_connection_backoff","write_stream_idle",t,n,i),this.R=r,this.yr=!1}get pr(){return this.yr}start(){this.yr=!1,this.lastStreamToken=void 0,super.start()}ur(){this.yr&&this.Er([])}wr(e){return this.Hi.Fi("Write",e)}onMessage(e){if(ME(!!e.streamToken),this.lastStreamToken=e.streamToken,this.yr){this.Zi.reset();const t=function(e,t){return e&&e.length>0?(ME(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?Tk(e.updateTime):Tk(t);return n.isEqual($E.min())&&(n=Tk(t)),new CC(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Tk(e.commitTime);return this.listener.Tr(n,t)}return ME(!e.writeResults||0===e.writeResults.length),this.yr=!0,this.listener.Ir()}Ar(){const e={};e.database=Ak(this.R),this.cr(e)}Er(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Ok(this.R,e)))};this.cr(t)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class NA extends class{}{constructor(e,t,n){super(),this.credentials=e,this.Hi=t,this.R=n,this.Rr=!1}Pr(){if(this.Rr)throw new kE(CE.FAILED_PRECONDITION,"The client has already been terminated.")}Ni(e,t,n){return this.Pr(),this.credentials.getToken().then((r=>this.Hi.Ni(e,t,n,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===CE.UNAUTHENTICATED&&this.credentials.invalidateToken(),e):new kE(CE.UNKNOWN,e.toString())}))}Oi(e,t,n){return this.Pr(),this.credentials.getToken().then((r=>this.Hi.Oi(e,t,n,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===CE.UNAUTHENTICATED&&this.credentials.invalidateToken(),e):new kE(CE.UNKNOWN,e.toString())}))}terminate(){this.Rr=!0}}class AA{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.br=0,this.vr=null,this.Vr=!0}Sr(){0===this.br&&(this.Dr("Unknown"),this.vr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.vr=null,this.Cr("Backend didn't respond within 10 seconds."),this.Dr("Offline"),Promise.resolve()))))}Nr(e){"Online"===this.state?this.Dr("Unknown"):(this.br++,this.br>=1&&(this.kr(),this.Cr(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.Dr("Offline")))}set(e){this.kr(),this.br=0,"Online"===e&&(this.Vr=!1),this.Dr(e)}Dr(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}Cr(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Vr?(PE(t),this.Vr=!1):AE("OnlineStateTracker",t)}kr(){null!==this.vr&&(this.vr.cancel(),this.vr=null)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class PA{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.$r=[],this.Or=new Map,this.Fr=new Set,this.Mr=[],this.Lr=i,this.Lr.di((e=>{n.enqueueAndForget((async()=>{jA(this)&&(AE("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=LE(e);t.Fr.add(4),await DA(t),t.Br.set("Unknown"),t.Fr.delete(4),await xA(t)}(this))}))})),this.Br=new AA(n,r)}}async function xA(e){if(jA(e))for(const t of e.Mr)await t(!0)}async function DA(e){for(const t of e.Mr)await t(!1)}function OA(e,t){const n=LE(e);n.Or.has(t.targetId)||(n.Or.set(t.targetId,t),qA(n)?UA(n):rP(n).er()&&LA(n,t))}function MA(e,t){const n=LE(e),r=rP(n);n.Or.delete(t),r.er()&&FA(n,t),0===n.Or.size&&(r.er()?r.ir():jA(n)&&n.Br.set("Unknown"))}function LA(e,t){e.Ur.q(t.targetId),rP(e).mr(t)}function FA(e,t){e.Ur.q(t),rP(e).gr(t)}function UA(e){e.Ur=new pk({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),lt:t=>e.Or.get(t)||null}),rP(e).start(),e.Br.Sr()}function qA(e){return jA(e)&&!rP(e).tr()&&e.Or.size>0}function jA(e){return 0===LE(e).Fr.size}function VA(e){e.Ur=void 0}async function BA(e){e.Or.forEach(((t,n)=>{LA(e,t)}))}async function $A(e,t){VA(e),qA(e)?(e.Br.Nr(t),UA(e)):e.Br.set("Unknown")}async function WA(e,t,n){if(e.Br.set("Online"),t instanceof dk&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Or.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Or.delete(r),e.Ur.removeTarget(r))}(e,t)}catch(n){AE("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await KA(e,n)}else if(t instanceof lk?e.Ur.X(t):t instanceof hk?e.Ur.rt(t):e.Ur.et(t),!n.isEqual($E.min()))try{const t=await VN(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Ur.at(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Or.get(r);i&&e.Or.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((t=>{const n=e.Or.get(t);if(!n)return;e.Or.set(t,n.withResumeToken(XE.EMPTY_BYTE_STRING,n.snapshotVersion)),FA(e,t);const r=new OR(n.target,t,1,n.sequenceNumber);LA(e,r)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){AE("RemoteStore","Failed to raise snapshot:",t),await KA(e,t)}}async function KA(e,t,n){if(!SR(t))throw t;e.Fr.add(1),await DA(e),e.Br.set("Offline"),n||(n=()=>VN(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{AE("RemoteStore","Retrying IndexedDB access"),await n(),e.Fr.delete(1),await xA(e)}))}function zA(e,t){return t().catch((n=>KA(e,n,t)))}async function HA(e){const t=LE(e),n=iP(t);let r=t.$r.length>0?t.$r[t.$r.length-1].batchId:-1;for(;GA(t);)try{const e=await $N(t.localStore,r);if(null===e){0===t.$r.length&&n.ir();break}r=e.batchId,QA(t,e)}catch(e){await KA(t,e)}YA(t)&&JA(t)}function GA(e){return jA(e)&&e.$r.length<10}function QA(e,t){e.$r.push(t);const n=iP(e);n.er()&&n.pr&&n.Er(t.mutations)}function YA(e){return jA(e)&&!iP(e).tr()&&e.$r.length>0}function JA(e){iP(e).start()}async function XA(e){iP(e).Ar()}async function ZA(e){const t=iP(e);for(const n of e.$r)t.Er(n.mutations)}async function eP(e,t,n){const r=e.$r.shift(),i=DR.from(r,t,n);await zA(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await HA(e)}async function tP(e,t){t&&iP(e).pr&&await async function(e,t){if(KC(n=t.code)&&n!==CE.ABORTED){const n=e.$r.shift();iP(e).sr(),await zA(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await HA(e)}var n}(e,t),YA(e)&&JA(e)}async function nP(e,t){const n=LE(e);t?(n.Fr.delete(2),await xA(n)):t||(n.Fr.add(2),await DA(n),n.Br.set("Unknown"))}function rP(e){return e.qr||(e.qr=function(e,t,n){const r=LE(e);return r.Pr(),new kA(t,r.Hi,r.credentials,r.R,n)
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}(e.datastore,e.asyncQueue,{Ii:BA.bind(null,e),Ri:$A.bind(null,e),_r:WA.bind(null,e)}),e.Mr.push((async t=>{t?(e.qr.sr(),qA(e)?UA(e):e.Br.set("Unknown")):(await e.qr.stop(),VA(e))}))),e.qr}function iP(e){return e.Kr||(e.Kr=function(e,t,n){const r=LE(e);return r.Pr(),new RA(t,r.Hi,r.credentials,r.R,n)}(e.datastore,e.asyncQueue,{Ii:XA.bind(null,e),Ri:tP.bind(null,e),Ir:ZA.bind(null,e),Tr:eP.bind(null,e)}),e.Mr.push((async t=>{t?(e.Kr.sr(),await HA(e)):(await e.Kr.stop(),e.$r.length>0&&(AE("RemoteStore",`Stopping write stream with ${e.$r.length} pending writes`),e.$r=[]))}))),e.Kr
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}class sP{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new vR,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new sP(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new kE(CE.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function oP(e,t){if(PE("AsyncQueue",`${t}: ${e}`),SR(e))return new kE(CE.UNAVAILABLE,`${t}: ${e}`);throw e}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class aP{constructor(e){this.comparator=e?(t,n)=>e(t,n)||uS.comparator(t.key,n.key):(e,t)=>uS.comparator(e.key,t.key),this.keyedMap=tk(),this.sortedSet=new HC(this.comparator)}static emptySet(e){return new aP(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof aP))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new aP;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class cP{constructor(){this.Qr=new HC(uS.comparator)}track(e){const t=e.doc.key,n=this.Qr.get(t);n?0!==e.type&&3===n.type?this.Qr=this.Qr.insert(t,e):3===e.type&&1!==n.type?this.Qr=this.Qr.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Qr=this.Qr.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Qr=this.Qr.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Qr=this.Qr.remove(t):1===e.type&&2===n.type?this.Qr=this.Qr.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Qr=this.Qr.insert(t,{type:2,doc:e.doc}):OE():this.Qr=this.Qr.insert(t,e)}jr(){const e=[];return this.Qr.inorderTraversal(((t,n)=>{e.push(n)})),e}}class uP{constructor(e,t,n,r,i,s,o,a){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(e,t,n,r){const i=[];return t.forEach((e=>{i.push({type:0,doc:e})})),new uP(e,t,aP.emptySet(t),i,n,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&iC(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class lP{constructor(){this.Wr=void 0,this.listeners=[]}}class hP{constructor(){this.queries=new wN((e=>sC(e)),iC),this.onlineState="Unknown",this.Gr=new Set}}async function dP(e,t){const n=LE(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new lP),i)try{s.Wr=await n.onListen(r)}catch(e){const n=oP(e,`Initialization of query '${oC(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,s),s.listeners.push(t),t.zr(n.onlineState),s.Wr&&t.Hr(s.Wr)&&mP(n)}async function fP(e,t){const n=LE(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function pP(e,t){const n=LE(e);let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.listeners)t.Hr(e)&&(r=!0);i.Wr=e}}r&&mP(n)}function gP(e,t,n){const r=LE(e),i=r.queries.get(t);if(i)for(const e of i.listeners)e.onError(n);r.queries.delete(t)}function mP(e){e.Gr.forEach((e=>{e.next()}))}class yP{constructor(e,t,n){this.query=e,this.Jr=t,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}Hr(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new uP(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.Yr?this.Zr(e)&&(this.Jr.next(e),t=!0):this.eo(e,this.onlineState)&&(this.no(e),t=!0),this.Xr=e,t}onError(e){this.Jr.error(e)}zr(e){this.onlineState=e;let t=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,e)&&(this.no(this.Xr),t=!0),t}eo(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return!(this.options.so&&n||e.docs.isEmpty()&&"Offline"!==t)}Zr(e){if(e.docChanges.length>0)return!0;const t=this.Xr&&this.Xr.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}no(e){e=uP.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Yr=!0,this.Jr.next(e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class _P{constructor(e,t){this.payload=e,this.byteLength=t}io(){return"metadata"in this.payload}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class vP{constructor(e){this.R=e}Un(e){return kk(this.R,e)}qn(e){return e.metadata.exists?Dk(this.R,e.document,!1):CS.newNoDocument(this.Un(e.metadata.name),this.Kn(e.metadata.readTime))}Kn(e){return Tk(e)}}class wP{constructor(e,t,n){this.ro=e,this.localStore=t,this.R=n,this.queries=[],this.documents=[],this.progress=bP(e)}oo(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;return e.payload.namedQuery?this.queries.push(e.payload.namedQuery):e.payload.documentMetadata?(this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t):e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t),t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}co(e){const t=new Map,n=new vP(this.R);for(const r of e)if(r.metadata.queries){const e=n.Un(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||sk()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=LE(e);let s=sk(),o=ZC(),a=rk();for(const e of n){const n=t.Un(e.metadata.name);e.document&&(s=s.add(n)),o=o.insert(n,t.qn(e)),a=a.insert(n,t.Kn(e.metadata.readTime))}const c=i.Fn.newChangeBuffer({trackRemovals:!0}),u=await WN(i,function(e){return nC(QS(GE.fromString(`__bundle__/docs/${e}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(e=>BN(e,c,o,$E.min(),a).next((t=>(c.apply(e),t))).next((t=>i.Ue.removeMatchingKeysForTargetId(e,u.targetId).next((()=>i.Ue.addMatchingKeys(e,s,u.targetId))).next((()=>i.Mn.En(e,t))).next((()=>t))))))}(this.localStore,new vP(this.R),this.documents,this.ro.id),t=this.co(this.documents);for(const e of this.queries)await QN(this.localStore,e,t.get(e.name));return this.progress.taskState="Success",new ON(Object.assign({},this.progress),e)}}function bP(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class IP{constructor(e){this.key=e}}class TP{constructor(e){this.key=e}}class EP{constructor(e,t){this.query=e,this.ao=t,this.uo=null,this.current=!1,this.ho=sk(),this.mutatedKeys=sk(),this.lo=cC(e),this.fo=new aP(this.lo)}get wo(){return this.ao}_o(e,t){const n=t?t.mo:new cP,r=t?t.fo:this.fo;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a=YS(this.query)&&r.size===this.query.limit?r.last():null,c=JS(this.query)&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),l=aC(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.yo(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.lo(l,a)>0||c&&this.lo(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(s=s.add(l),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),YS(this.query)||JS(this.query))for(;s.size>this.query.limit;){const e=YS(this.query)?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{fo:s,mo:n,Nn:o,mutatedKeys:i}}yo(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.fo;this.fo=e.fo,this.mutatedKeys=e.mutatedKeys;const i=e.mo.jr();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return OE()}};return n(e)-n(t)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e.type,t.type)||this.lo(e.doc,t.doc))),this.po(n);const s=t?this.Eo():[],o=0===this.ho.size&&this.current?1:0,a=o!==this.uo;return this.uo=o,0!==i.length||a?{snapshot:new uP(this.query,e.fo,r,i,e.mutatedKeys,0===o,a,!1),To:s}:{To:s}}zr(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({fo:this.fo,mo:new cP,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}}Io(e){return!this.ao.has(e)&&!!this.fo.has(e)&&!this.fo.get(e).hasLocalMutations}po(e){e&&(e.addedDocuments.forEach((e=>this.ao=this.ao.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.ao=this.ao.delete(e))),this.current=e.current)}Eo(){if(!this.current)return[];const e=this.ho;this.ho=sk(),this.fo.forEach((e=>{this.Io(e.key)&&(this.ho=this.ho.add(e.key))}));const t=[];return e.forEach((e=>{this.ho.has(e)||t.push(new TP(e))})),this.ho.forEach((n=>{e.has(n)||t.push(new IP(n))})),t}Ao(e){this.ao=e.Bn,this.ho=sk();const t=this._o(e.documents);return this.applyChanges(t,!0)}Ro(){return uP.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.uo)}}class SP{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class CP{constructor(e){this.key=e,this.Po=!1}}class kP{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.bo={},this.vo=new wN((e=>sC(e)),iC),this.Vo=new Map,this.So=new Set,this.Do=new HC(uS.comparator),this.Co=new Map,this.No=new JN,this.xo={},this.ko=new Map,this.$o=cN.Yt(),this.onlineState="Unknown",this.Oo=void 0}get isPrimaryClient(){return!0===this.Oo}}async function RP(e,t){const n=ex(e);let r,i;const s=n.vo.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Ro();else{const e=await WN(n.localStore,nC(t)),s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await NP(n,t,r,"current"===s),n.isPrimaryClient&&OA(n.remoteStore,e)}return i}async function NP(e,t,n,r){e.Fo=(t,n,r)=>async function(e,t,n,r){let i=t.view._o(n);i.Nn&&(i=await zN(e.localStore,t.query,!1).then((({documents:e})=>t.view._o(e,i))));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return jP(e,t.targetId,o.To),o.snapshot}(e,t,n,r);const i=await zN(e.localStore,t,!0),s=new EP(t,i.Bn),o=s._o(i.documents),a=uk.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState),c=s.applyChanges(o,e.isPrimaryClient,a);jP(e,n,c.To);const u=new SP(t,n,s);return e.vo.set(t,u),e.Vo.has(n)?e.Vo.get(n).push(t):e.Vo.set(n,[t]),c.snapshot}async function AP(e,t){const n=LE(e),r=n.vo.get(t),i=n.Vo.get(r.targetId);if(i.length>1)return n.Vo.set(r.targetId,i.filter((e=>!iC(e,t)))),void n.vo.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await KN(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),MA(n.remoteStore,r.targetId),UP(n,r.targetId)})).catch(fN)):(UP(n,r.targetId),await KN(n.localStore,r.targetId,!0))}async function PP(e,t){const n=LE(e);try{const e=await function(e,t){const n=LE(e),r=t.snapshotVersion;let i=n.kn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.Fn.newChangeBuffer({trackRemovals:!0});i=n.kn;const o=[];t.targetChanges.forEach(((t,s)=>{const a=i.get(s);if(!a)return;o.push(n.Ue.removeMatchingKeys(e,t.removedDocuments,s).next((()=>n.Ue.addMatchingKeys(e,t.addedDocuments,s))));const c=t.resumeToken;if(c.approximateByteSize()>0){const u=a.withResumeToken(c,r).withSequenceNumber(e.currentSequenceNumber);i=i.insert(s,u),function(e,t,n){return ME(t.resumeToken.approximateByteSize()>0),0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,u,t)&&o.push(n.Ue.updateTargetData(e,u))}}));let a=ZC();if(t.documentUpdates.forEach(((r,i)=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(BN(e,s,t.documentUpdates,r,void 0).next((e=>{a=e}))),!r.isEqual($E.min())){const t=n.Ue.getLastRemoteSnapshotVersion(e).next((t=>n.Ue.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return wR.waitFor(o).next((()=>s.apply(e))).next((()=>n.Mn.En(e,a))).next((()=>a))})).then((e=>(n.kn=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Co.get(t);r&&(ME(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Po=!0:e.modifiedDocuments.size>0?ME(r.Po):e.removedDocuments.size>0&&(ME(r.Po),r.Po=!1))})),await $P(n,e,t)}catch(e){await fN(e)}}function xP(e,t,n){const r=LE(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.vo.forEach(((n,r)=>{const i=r.view.zr(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=LE(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.zr(t)&&(r=!0)})),r&&mP(n)}(r.eventManager,t),e.length&&r.bo._r(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function DP(e,t,n){const r=LE(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Co.get(t),s=i&&i.key;if(s){let e=new HC(uS.comparator);e=e.insert(s,CS.newNoDocument(s,$E.min()));const n=sk().add(s),i=new ck($E.min(),new Map,new YC(qE),e,n);await PP(r,i),r.Do=r.Do.remove(s),r.Co.delete(t),BP(r)}else await KN(r.localStore,t,!1).then((()=>UP(r,t,n))).catch(fN)}async function OP(e,t){const n=LE(e),r=t.batch.batchId;try{const e=await function(e,t){const n=LE(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.Fn.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=wR.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);ME(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&r.addEntry(t,n.commitVersion))}))})),o.next((()=>e._n.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n._n.performConsistencyCheck(e))).next((()=>n.Mn.pn(e,r)))}))}(n.localStore,t);FP(n,r,null),LP(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await $P(n,e)}catch(e){await fN(e)}}async function MP(e,t,n){const r=LE(e);try{const e=await function(e,t){const n=LE(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n._n.lookupMutationBatch(e,t).next((t=>(ME(null!==t),r=t.keys(),n._n.removeMutationBatch(e,t)))).next((()=>n._n.performConsistencyCheck(e))).next((()=>n.Mn.pn(e,r)))}))}(r.localStore,t);FP(r,t,n),LP(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await $P(r,e)}catch(n){await fN(n)}}function LP(e,t){(e.ko.get(t)||[]).forEach((e=>{e.resolve()})),e.ko.delete(t)}function FP(e,t,n){const r=LE(e);let i=r.xo[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.xo[r.currentUser.toKey()]=i}}function UP(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Vo.get(t))e.vo.delete(r),n&&e.bo.Mo(r,n);e.Vo.delete(t),e.isPrimaryClient&&e.No.Zn(t).forEach((t=>{e.No.containsKey(t)||qP(e,t)}))}function qP(e,t){e.So.delete(t.path.canonicalString());const n=e.Do.get(t);null!==n&&(MA(e.remoteStore,n),e.Do=e.Do.remove(t),e.Co.delete(n),BP(e))}function jP(e,t,n){for(const r of n)r instanceof IP?(e.No.addReference(r.key,t),VP(e,r)):r instanceof TP?(AE("SyncEngine","Document no longer in limbo: "+r.key),e.No.removeReference(r.key,t),e.No.containsKey(r.key)||qP(e,r.key)):OE()}function VP(e,t){const n=t.key,r=n.path.canonicalString();e.Do.get(n)||e.So.has(r)||(AE("SyncEngine","New document in limbo: "+n),e.So.add(r),BP(e))}function BP(e){for(;e.So.size>0&&e.Do.size<e.maxConcurrentLimboResolutions;){const t=e.So.values().next().value;e.So.delete(t);const n=new uS(GE.fromString(t)),r=e.$o.next();e.Co.set(r,new CP(n)),e.Do=e.Do.insert(n,r),OA(e.remoteStore,new OR(nC(QS(n.path)),r,2,SE.o))}}async function $P(e,t,n){const r=LE(e),i=[],s=[],o=[];r.vo.isEmpty()||(r.vo.forEach(((e,a)=>{o.push(r.Fo(a,t,n).then((e=>{if(e){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,e.fromCache?"not-current":"current"),i.push(e);const t=LN.vn(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.bo._r(i),await async function(e,t){const n=LE(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>wR.forEach(t,(t=>wR.forEach(t.Pn,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>wR.forEach(t.bn,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!SR(e))throw e;AE("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.kn.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.kn=n.kn.insert(t,i)}}}(r.localStore,s))}async function WP(e,t){const n=LE(e);if(!n.currentUser.isEqual(t)){AE("SyncEngine","User change. New user:",t.toKey());const e=await jN(n.localStore,t);n.currentUser=t,function(e,t){e.ko.forEach((e=>{e.forEach((e=>{e.reject(new kE(CE.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.ko.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await $P(n,e.Ln)}}function KP(e,t){const n=LE(e),r=n.Co.get(t);if(r&&r.Po)return sk().add(r.key);{let e=sk();const r=n.Vo.get(t);if(!r)return e;for(const t of r){const r=n.vo.get(t);e=e.unionWith(r.view.wo)}return e}}async function zP(e,t){const n=LE(e),r=await zN(n.localStore,t.query,!0),i=t.view.Ao(r);return n.isPrimaryClient&&jP(n,t.targetId,i.To),i}async function HP(e){const t=LE(e);return GN(t.localStore).then((e=>$P(t,e)))}async function GP(e,t,n,r){const i=LE(e),s=await function(e,t){const n=LE(e),r=LE(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(e=>r.jt(e,t).next((t=>t?n.Mn.pn(e,t):wR.resolve(null)))))}(i.localStore,t);null!==s?("pending"===n?await HA(i.remoteStore):"acknowledged"===n||"rejected"===n?(FP(i,t,r||null),LP(i,t),function(e,t){LE(LE(e)._n).Gt(t)}(i.localStore,t)):OE(),await $P(i,s)):AE("SyncEngine","Cannot apply mutation batch with id: "+t)}async function QP(e,t,n){const r=LE(e),i=[],s=[];for(const e of t){let t;const n=r.Vo.get(e);if(n&&0!==n.length){t=await WN(r.localStore,nC(n[0]));for(const e of n){const t=r.vo.get(e),n=await zP(r,t);n.snapshot&&s.push(n.snapshot)}}else{const n=await HN(r.localStore,e);t=await WN(r.localStore,n),await NP(r,YP(n),e,!1)}i.push(t)}return r.bo._r(s),i}function YP(e){return GS(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function JP(e){const t=LE(e);return LE(LE(t.localStore).persistence).fn()}async function XP(e,t,n,r){const i=LE(e);if(i.Oo)AE("SyncEngine","Ignoring unexpected query state notification.");else if(i.Vo.has(t))switch(n){case"current":case"not-current":{const e=await GN(i.localStore),r=ck.createSynthesizedRemoteEventForCurrentChange(t,"current"===n);await $P(i,e,r);break}case"rejected":await KN(i.localStore,t,!0),UP(i,t,r);break;default:OE()}}async function ZP(e,t,n){const r=ex(e);if(r.Oo){for(const e of t){if(r.Vo.has(e)){AE("SyncEngine","Adding an already active target "+e);continue}const t=await HN(r.localStore,e),n=await WN(r.localStore,t);await NP(r,YP(t),n.targetId,!1),OA(r.remoteStore,n)}for(const e of n)r.Vo.has(e)&&await KN(r.localStore,e,!1).then((()=>{MA(r.remoteStore,e),UP(r,e)})).catch(fN)}}function ex(e){const t=LE(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=PP.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=KP.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=DP.bind(null,t),t.bo._r=pP.bind(null,t.eventManager),t.bo.Mo=gP.bind(null,t.eventManager),t}function tx(e){const t=LE(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=OP.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=MP.bind(null,t),t}class nx{constructor(){this.synchronizeTabs=!1}async initialize(e){this.R=EA(e.databaseInfo.databaseId),this.sharedClientState=this.Bo(e),this.persistence=this.Uo(e),await this.persistence.start(),this.gcScheduler=this.qo(e),this.localStore=this.Ko(e)}qo(e){return null}Ko(e){return qN(this.persistence,new FN,e.initialUser,this.R)}Uo(e){return new rA(sA.Ps,this.R)}Bo(e){return new mA}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class rx extends nx{constructor(e,t,n){super(),this.Qo=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await async function(e){const t=LE(e);return t.persistence.runTransaction("Synchronize last document change read time","readonly",(e=>function(e){const t=SN(e);let n=$E.min();return t.Ot({index:aR.readTimeIndex,reverse:!0},((e,t,r)=>{t.readTime&&(n=qR(t.readTime)),r.done()})).next((()=>n))}(e))).then((e=>{t.On=e}))}(this.localStore),await this.Qo.initialize(this,e),await tx(this.Qo.syncEngine),await HA(this.Qo.remoteStore)}Ko(e){return qN(this.persistence,new FN,e.initialUser,this.R)}qo(e){const t=this.persistence.referenceDelegate.garbageCollector;return new mN(t,e.asyncQueue)}Uo(e){const t=DN(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?eN.withCacheSize(this.cacheSizeBytes):eN.DEFAULT;return new AN(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,IA(),TA(),this.R,this.sharedClientState,!!this.forceOwnership)}Bo(e){return new mA}}class ix extends rx{constructor(e,t){super(e,t,!1),this.Qo=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Qo.syncEngine;this.sharedClientState instanceof gA&&(this.sharedClientState.syncEngine={ai:GP.bind(null,t),ui:XP.bind(null,t),hi:ZP.bind(null,t),fn:JP.bind(null,t),ci:HP.bind(null,t)},await this.sharedClientState.start()),await this.persistence.He((async e=>{await async function(e,t){const n=LE(e);if(ex(n),tx(n),!0===t&&!0!==n.Oo){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await QP(n,e.toArray());n.Oo=!0,await nP(n.remoteStore,!0);for(const e of t)OA(n.remoteStore,e)}else if(!1===t&&!1!==n.Oo){const e=[];let t=Promise.resolve();n.Vo.forEach(((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then((()=>(UP(n,i),KN(n.localStore,i,!0)))),MA(n.remoteStore,i)})),await t,await QP(n,e),function(e){const t=LE(e);t.Co.forEach(((e,n)=>{MA(t.remoteStore,n)})),t.No.ts(),t.Co=new Map,t.Do=new HC(uS.comparator)}(n),n.Oo=!1,await nP(n.remoteStore,!1)}}(this.Qo.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):e||this.gcScheduler.stop())}))}Bo(e){const t=IA();if(!gA.gt(t))throw new kE(CE.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=DN(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new gA(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class sx{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>xP(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=WP.bind(null,this.syncEngine),await nP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new hP}createDatastore(e){const t=EA(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new bA(r));var r;return function(e,t,n){return new NA(e,t,n)}(e.credentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>xP(this.syncEngine,e,0),s=_A.gt()?new _A:new yA,new PA(t,n,r,i,s);var t,n,r,i,s}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new kP(e,t,n,r,i,s);return o&&(a.Oo=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=LE(e);AE("RemoteStore","RemoteStore shutting down."),t.Fr.add(5),await DA(t),t.Lr.shutdown(),t.Br.set("Unknown")}(this.remoteStore)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function ox(e,t=10240){let n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ax{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.jo(this.observer.next,e)}error(e){this.observer.error?this.jo(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Wo(){this.muted=!0}jo(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class cx{constructor(e,t){this.Go=e,this.R=t,this.metadata=new vR,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then((e=>{e&&e.io()?this.metadata.resolve(e.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.payload)}`))}),(e=>this.metadata.reject(e)))}close(){return this.Go.cancel()}async getMetadata(){return this.metadata.promise}async Lo(){return await this.getMetadata(),this.Ho()}async Ho(){const e=await this.Jo();if(null===e)return null;const t=this.zo.decode(e),n=Number(t);isNaN(n)&&this.Yo(`length string (${t}) is not valid number`);const r=await this.Xo(n);return new _P(JSON.parse(r),e.length+n)}Zo(){return this.buffer.findIndex((e=>e==="{".charCodeAt(0)))}async Jo(){for(;this.Zo()<0&&!await this.tc(););if(0===this.buffer.length)return null;const e=this.Zo();e<0&&this.Yo("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Xo(e){for(;this.buffer.length<e;)await this.tc()&&this.Yo("Reached the end of bundle when more is expected.");const t=this.zo.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Yo(e){throw this.Go.cancel(),new Error(`Invalid bundle format: ${e}`)}async tc(){const e=await this.Go.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class ux{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new kE(CE.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(e,t){const n=LE(e),r=Ak(n.R)+"/documents",i={documents:t.map((e=>Ck(n.R,e)))},s=await n.Oi("BatchGetDocuments",r,i),o=new Map;s.forEach((e=>{const t=function(e,t){return"found"in t?function(e,t){ME(!!t.found),t.found.name,t.found.updateTime;const n=kk(e,t.found.name),r=Tk(t.found.updateTime),i=new ES({mapValue:{fields:t.found.fields}});return CS.newFoundDocument(n,r,i)}(e,t):"missing"in t?function(e,t){ME(!!t.missing),ME(!!t.readTime);const n=kk(e,t.missing),r=Tk(t.readTime);return CS.newNoDocument(n,r)}(e,t):OE()}(n.R,e);o.set(t.key.toString(),t)}));const a=[];return t.forEach((e=>{const t=o.get(e.toString());ME(!!t),a.push(t)})),a}(this.datastore,e);return t.forEach((e=>this.recordVersion(e))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new jC(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((e,t)=>{const n=uS.fromPath(t);this.mutations.push(new VC(n,this.precondition(n)))})),await async function(e,t){const n=LE(e),r=Ak(n.R)+"/documents",i={writes:t.map((e=>Ok(n.R,e)))};await n.Ni("Commit",r,i)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw OE();t=$E.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new kE(CE.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?kC.updateTime(t):kC.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual($E.min()))throw new kE(CE.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return kC.updateTime(t)}return kC.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class lx{constructor(e,t,n,r){this.asyncQueue=e,this.datastore=t,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new SA(this.asyncQueue,"transaction_retry")}run(){this.nc()}nc(){this.Zi.ji((async()=>{const e=new ux(this.datastore),t=this.sc(e);t&&t.then((t=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(t)})).catch((e=>{this.ic(e)}))))})).catch((e=>{this.ic(e)}))}))}sc(e){try{const t=this.updateFunction(e);return!oS(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}ic(e){this.ec>0&&this.rc(e)?(this.ec-=1,this.asyncQueue.enqueueAndForget((()=>(this.nc(),Promise.resolve())))):this.deferred.reject(e)}rc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!KC(t)}return!1}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class hx{constructor(e,t,n){this.credentials=e,this.asyncQueue=t,this.databaseInfo=n,this.user=oA.UNAUTHENTICATED,this.clientId=UE.u(),this.credentialListener=()=>Promise.resolve(),this.credentials.setChangeListener(t,(async e=>{AE("FirestoreClient","Received user=",e.uid),await this.credentialListener(e),this.user=e}))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.credentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new kE(CE.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new vR;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.credentials.removeChangeListener(),e.resolve()}catch(t){const n=oP(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function dx(e,t){e.asyncQueue.verifyOperationInProgress(),AE("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await jN(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e.offlineComponents=t}async function fx(e,t){e.asyncQueue.verifyOperationInProgress();const n=await px(e);AE("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener((e=>async function(e,t){const n=LE(e);n.asyncQueue.verifyOperationInProgress(),AE("RemoteStore","RemoteStore received new credentials");const r=jA(n);n.Fr.add(3),await DA(n),r&&n.Br.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Fr.delete(3),await xA(n)}(t.remoteStore,e))),e.onlineComponents=t}async function px(e){return e.offlineComponents||(AE("FirestoreClient","Using default OfflineComponentProvider"),await dx(e,new nx)),e.offlineComponents}async function gx(e){return e.onlineComponents||(AE("FirestoreClient","Using default OnlineComponentProvider"),await fx(e,new sx)),e.onlineComponents}function mx(e){return px(e).then((e=>e.persistence))}function yx(e){return px(e).then((e=>e.localStore))}function _x(e){return gx(e).then((e=>e.remoteStore))}function vx(e){return gx(e).then((e=>e.syncEngine))}async function wx(e){const t=await gx(e),n=t.eventManager;return n.onListen=RP.bind(null,t.syncEngine),n.onUnlisten=AP.bind(null,t.syncEngine),n}function bx(e,t,n={}){const r=new vR;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new ax({next:s=>{t.enqueueAndForget((()=>fP(e,o)));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new kE(CE.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new kE(CE.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new yP(QS(n.path),s,{includeMetadataChanges:!0,so:!0});return dP(e,o)}(await wx(e),e.asyncQueue,t,n,r))),r.promise}function Ix(e,t,n={}){const r=new vR;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new ax({next:n=>{t.enqueueAndForget((()=>fP(e,o))),n.fromCache&&"server"===r.source?i.reject(new kE(CE.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new yP(n,s,{includeMetadataChanges:!0,so:!0});return dP(e,o)}(await wx(e),e.asyncQueue,t,n,r))),r.promise}function Tx(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?(new TextEncoder).encode(e):e,function(e,t){return new cx(e,t)}(function(e,t){if(e instanceof Uint8Array)return ox(e,t);if(e instanceof ArrayBuffer)return ox(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(n,EA(t));e.asyncQueue.enqueueAndForget((async()=>{!function(e,t,n){const r=LE(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=LE(e),r=Tk(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(e=>n.Ke.getBundleMetadata(e,t.id))).then((e=>!!e&&e.createTime.compareTo(r)>=0))}(e.localStore,r))return await t.close(),void n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r));n._updateProgress(bP(r));const i=new wP(r,e.localStore,t.R);let s=await t.Lo();for(;s;){const e=await i.oo(s);e&&n._updateProgress(e),s=await t.Lo()}const o=await i.complete();await $P(e,o.wn,void 0),await function(e,t){const n=LE(e);return n.persistence.runTransaction("Save bundle","readwrite",(e=>n.Ke.saveBundleMetadata(e,t)))}(e.localStore,r),n._completeWith(o.progress)}catch(e){xE("SyncEngine",`Loading bundle failed with ${e}`),n._failWith(e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */)(r,t,n).then((()=>{r.sharedClientState.notifyBundleLoaded()}))}(await vx(e),i,r)}))}class Ex{constructor(e,t,n,r,i,s,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class Sx{constructor(e,t){this.projectId=e,this.database=t||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Sx&&e.projectId===this.projectId&&e.database===this.database}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const Cx=new Map;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class kx{constructor(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization=`Bearer ${e}`}}class Rx{constructor(){this.changeListener=null}getToken(){return Promise.resolve(null)}invalidateToken(){}setChangeListener(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(oA.UNAUTHENTICATED)))}removeChangeListener(){this.changeListener=null}}class Nx{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}setChangeListener(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}removeChangeListener(){this.changeListener=null}}class Ax{constructor(e){this.currentUser=oA.UNAUTHENTICATED,this.oc=new vR,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.ac=()=>{this.cc++,this.currentUser=this.uc(),this.oc.resolve(),this.changeListener&&this.asyncQueue.enqueueRetryable((()=>this.changeListener(this.currentUser)))};const t=e=>{AE("FirebaseCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.ac)};e.onInit((e=>t(e))),setTimeout((()=>{if(!this.auth){const n=e.getImmediate({optional:!0});n?t(n):(AE("FirebaseCredentialsProvider","Auth not yet detected"),this.oc.resolve())}}),0)}getToken(){const e=this.cc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.cc!==e?(AE("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(ME("string"==typeof t.accessToken),new kx(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}setChangeListener(e,t){this.asyncQueue=e,this.asyncQueue.enqueueRetryable((async()=>{await this.oc.promise,await t(this.currentUser),this.changeListener=t}))}removeChangeListener(){this.auth&&this.auth.removeAuthTokenListener(this.ac),this.changeListener=()=>Promise.resolve()}uc(){const e=this.auth&&this.auth.getUid();return ME(null===e||"string"==typeof e),new oA(e)}}class Px{constructor(e,t,n){this.hc=e,this.lc=t,this.fc=n,this.type="FirstParty",this.user=oA.FIRST_PARTY}get authHeaders(){const e={"X-Goog-AuthUser":this.lc},t=this.hc.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),this.fc&&(e["X-Goog-Iam-Authorization-Token"]=this.fc),e}}class xx{constructor(e,t,n){this.hc=e,this.lc=t,this.fc=n}getToken(){return Promise.resolve(new Px(this.hc,this.lc,this.fc))}setChangeListener(e,t){e.enqueueRetryable((()=>t(oA.FIRST_PARTY)))}removeChangeListener(){}invalidateToken(){}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Dx(e,t,n){if(!n)throw new kE(CE.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Ox(e){if(!uS.isDocumentKey(e))throw new kE(CE.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Mx(e){if(uS.isDocumentKey(e))throw new kE(CE.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Lx(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){if(e.constructor){const t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":OE()}function Fx(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new kE(CE.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Lx(e);throw new kE(CE.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Ux(e,t){if(t<=0)throw new kE(CE.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class qx{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new kE(CE.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new kE(CE.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new kE(CE.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class jx{constructor(e,t){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qx({}),this._settingsFrozen=!1,e instanceof Sx?(this._databaseId=e,this._credentials=new Rx):(this._app=e,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new kE(CE.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Sx(e.options.projectId)}(e),this._credentials=new Ax(t))}get app(){if(!this._app)throw new kE(CE.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new kE(CE.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qx(e),void 0!==e.credentials&&(this._credentials=function(e){if(!e)return new Rx;switch(e.type){case"gapi":const t=e.client;return ME(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new xx(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new kE(CE.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Cx.get(e);t&&(AE("ComponentProvider","Removing Datastore"),Cx.delete(e),t.terminate())}(this),Promise.resolve()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Vx{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $x(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vx(this.firestore,e,this._key)}}class Bx{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Bx(this.firestore,e,this._query)}}class $x extends Bx{constructor(e,t,n){super(e,t,QS(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vx(this.firestore,null,new uS(e))}withConverter(e){return new $x(this.firestore,e,this._path)}}function Wx(e,t,...n){if(e=Ia(e),Dx("collection","path",t),e instanceof jx){const r=GE.fromString(t,...n);return Mx(r),new $x(e,null,r)}{if(!(e instanceof Vx||e instanceof $x))throw new kE(CE.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=GE.fromString(e.path,...n).child(GE.fromString(t));return Mx(r),new $x(e.firestore,null,r)}}function Kx(e,t,...n){if(e=Ia(e),1===arguments.length&&(t=UE.u()),Dx("doc","path",t),e instanceof jx){const r=GE.fromString(t,...n);return Ox(r),new Vx(e,null,new uS(r))}{if(!(e instanceof Vx||e instanceof $x))throw new kE(CE.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(GE.fromString(t,...n));return Ox(r),new Vx(e.firestore,e instanceof $x?e.converter:null,new uS(r))}}function zx(e,t){return e=Ia(e),t=Ia(t),(e instanceof Vx||e instanceof $x)&&(t instanceof Vx||t instanceof $x)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function Hx(e,t){return e=Ia(e),t=Ia(t),e instanceof Bx&&t instanceof Bx&&e.firestore===t.firestore&&iC(e._query,t._query)&&e.converter===t.converter
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}class Gx{constructor(){this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.gc=null,this.yc=!1,this.Ec=[],this.Zi=new SA(this,"async_queue_retry"),this.Tc=()=>{const e=TA();e&&AE("AsyncQueue","Visibility state changed to "+e.visibilityState),this.Zi.Gi()};const e=TA();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Tc)}get isShuttingDown(){return this._c}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ic(),this.Ac(e)}enterRestrictedMode(){if(!this._c){this._c=!0;const e=TA();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Tc)}}enqueue(e){return this.Ic(),this._c?new Promise((e=>{})):this.Ac(e)}enqueueRetryable(e){this.enqueueAndForget((()=>(this.wc.push(e),this.Rc())))}async Rc(){if(0!==this.wc.length){try{await this.wc[0](),this.wc.shift(),this.Zi.reset()}catch(e){if(!SR(e))throw e;AE("AsyncQueue","Operation failed with retryable error: "+e)}this.wc.length>0&&this.Zi.ji((()=>this.Rc()))}}Ac(e){const t=this.dc.then((()=>(this.yc=!0,e().catch((e=>{throw this.gc=e,this.yc=!1,PE("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e)),e})).then((e=>(this.yc=!1,e))))));return this.dc=t,t}enqueueAfterDelay(e,t,n){this.Ic(),this.Ec.indexOf(e)>-1&&(t=0);const r=sP.createAndSchedule(this,e,t,n,(e=>this.Pc(e)));return this.mc.push(r),r}Ic(){this.gc&&OE()}verifyOperationInProgress(){}async bc(){let e;do{e=this.dc,await e}while(e!==this.dc)}vc(e){for(const t of this.mc)if(t.timerId===e)return!0;return!1}Vc(e){return this.bc().then((()=>{this.mc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.mc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.bc()}))}Sc(e){this.Ec.push(e)}Pc(e){const t=this.mc.indexOf(e);this.mc.splice(t,1)}}function Qx(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of["next","error","complete"])if(e in n&&"function"==typeof n[e])return!0;return!1}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e)}class Yx{constructor(){this._progressObserver={},this._taskCompletionResolver=new vR,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Jx extends jx{constructor(e,t){super(e,t),this.type="firestore",this._queue=new Gx,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Zx(this),this._firestoreClient.terminate()}}function Xx(e){return e._firestoreClient||Zx(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Zx(e){var t;const n=e._freezeSettings(),r=function(e,t,n,r){return new Ex(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new hx(e._credentials,e._queue,r)}function eD(e,t,n){const r=new vR;return e.asyncQueue.enqueue((async()=>{try{await dx(e,n),await fx(e,t),r.resolve()}catch(e){if(!function(e){return"FirebaseError"===e.name?e.code===CE.FAILED_PRECONDITION||e.code===CE.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||(22===e.code||20===e.code||11===e.code)}(e))throw e;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),r.reject(e)}})).then((()=>r.promise))}function tD(e){return function(e){const t=new vR;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=LE(e);jA(n.remoteStore)||AE("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=LE(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(e=>t._n.getHighestUnacknowledgedBatchId(e)))}(n.localStore);if(-1===e)return void t.resolve();const r=n.ko.get(e)||[];r.push(t),n.ko.set(e,r)}catch(e){const n=oP(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await vx(e),t))),t.promise}(Xx(e=Fx(e,Jx)))}function nD(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await mx(e),n=await _x(e);return t.setNetworkEnabled(!0),function(e){const t=LE(e);return t.Fr.delete(0),xA(t)}(n)}))}(Xx(e=Fx(e,Jx)))}function rD(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await mx(e),n=await _x(e);return t.setNetworkEnabled(!1),async function(e){const t=LE(e);t.Fr.add(0),await DA(t),t.Br.set("Offline")}(n)}))}(Xx(e=Fx(e,Jx)))}function iD(e,t){return function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){const n=LE(e);return n.persistence.runTransaction("Get named query","readonly",(e=>n.Ke.getNamedQuery(e,t)))}(await yx(e),t)))}(Xx(e=Fx(e,Jx)),t).then((t=>t?new Bx(e,null,t.query):null))}function sD(e){if(e._initialized||e._terminated)throw new kE(CE.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class oD{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new kE(CE.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new YE(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class aD{constructor(e){this._byteString=e}static fromBase64String(e){try{return new aD(XE.fromBase64String(e))}catch(e){throw new kE(CE.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new aD(XE.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class cD{constructor(e){this._methodName=e}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class uD{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new kE(CE.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new kE(CE.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return qE(this._lat,e._lat)||qE(this._long,e._long)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const lD=/^__.*__$/;class hD{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new LC(e,this.data,this.fieldMask,t,this.fieldTransforms):new MC(e,this.data,t,this.fieldTransforms)}}class dD{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new LC(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function fD(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw OE()}}class pD{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Dc(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cc(){return this.settings.Cc}Nc(e){return new pD(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}xc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Nc({path:n,kc:!1});return r.$c(e),r}Oc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Nc({path:n,kc:!1});return r.Dc(),r}Fc(e){return this.Nc({path:void 0,kc:!0})}Mc(e){return OD(e,this.settings.methodName,this.settings.Lc||!1,this.path,this.settings.Bc)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Dc(){if(this.path)for(let e=0;e<this.path.length;e++)this.$c(this.path.get(e))}$c(e){if(0===e.length)throw this.Mc("Document fields must not be empty");if(fD(this.Cc)&&lD.test(e))throw this.Mc('Document fields cannot begin and end with "__"')}}class gD{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.R=n||EA(e)}Uc(e,t,n,r=!1){return new pD({Cc:e,methodName:t,Bc:n,path:YE.emptyPath(),kc:!1,Lc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)}}function mD(e){const t=e._freezeSettings(),n=EA(e._databaseId);return new gD(e._databaseId,!!t.ignoreUndefinedProperties,n)}function yD(e,t,n,r,i,s={}){const o=e.Uc(s.merge||s.mergeFields?2:0,t,n,i);AD("Data must be an object, but it was:",o,r);const a=RD(r,o);let c,u;if(s.merge)c=new JE(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=PD(t,r,n);if(!o.contains(i))throw new kE(CE.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);MD(e,i)||e.push(i)}c=new JE(e),u=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,u=o.fieldTransforms;return new hD(new ES(a),c,u)}class _D extends cD{_toFieldTransform(e){if(2!==e.Cc)throw 1===e.Cc?e.Mc(`${this._methodName}() can only appear at the top level of your update data`):e.Mc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _D}}function vD(e,t,n){return new pD({Cc:3,Bc:t.settings.Bc,methodName:e._methodName,kc:n},t.databaseId,t.R,t.ignoreUndefinedProperties)}class wD extends cD{_toFieldTransform(e){return new SC(e.path,new yC)}isEqual(e){return e instanceof wD}}class bD extends cD{constructor(e,t){super(e),this.qc=t}_toFieldTransform(e){const t=vD(this,e,!0),n=this.qc.map((e=>kD(e,t))),r=new _C(n);return new SC(e.path,r)}isEqual(e){return this===e}}class ID extends cD{constructor(e,t){super(e),this.qc=t}_toFieldTransform(e){const t=vD(this,e,!0),n=this.qc.map((e=>kD(e,t))),r=new wC(n);return new SC(e.path,r)}isEqual(e){return this===e}}class TD extends cD{constructor(e,t){super(e),this.Kc=t}_toFieldTransform(e){const t=new IC(e.R,dC(e.R,this.Kc));return new SC(e.path,t)}isEqual(e){return this===e}}function ED(e,t,n,r){const i=e.Uc(1,t,n);AD("Data must be an object, but it was:",i,r);const s=[],o=ES.empty();KE(r,((e,r)=>{const a=DD(t,e,n);r=Ia(r);const c=i.Oc(a);if(r instanceof _D)s.push(a);else{const e=kD(r,c);null!=e&&(s.push(a),o.set(a,e))}}));const a=new JE(s);return new dD(o,a,i.fieldTransforms)}function SD(e,t,n,r,i,s){const o=e.Uc(1,t,n),a=[PD(t,r,n)],c=[i];if(s.length%2!=0)throw new kE(CE.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)a.push(PD(t,s[e])),c.push(s[e+1]);const u=[],l=ES.empty();for(let e=a.length-1;e>=0;--e)if(!MD(u,a[e])){const t=a[e];let n=c[e];n=Ia(n);const r=o.Oc(t);if(n instanceof _D)u.push(t);else{const e=kD(n,r);null!=e&&(u.push(t),l.set(t,e))}}const h=new JE(u);return new dD(l,h,o.fieldTransforms)}function CD(e,t,n,r=!1){return kD(n,e.Uc(r?4:3,t))}function kD(e,t){if(ND(e=Ia(e)))return AD("Unsupported field value:",t,e),RD(e,t);if(e instanceof cD)return function(e,t){if(!fD(t.Cc))throw t.Mc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Mc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.kc&&4!==t.Cc)throw t.Mc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=kD(i,t.Fc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Ia(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return dC(t.R,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=BE.fromDate(e);return{timestampValue:wk(t.R,n)}}if(e instanceof BE){const n=new BE(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:wk(t.R,n)}}if(e instanceof uD)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof aD)return{bytesValue:bk(t.R,e._byteString)};if(e instanceof Vx){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Mc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Ek(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Mc(`Unsupported field value: ${Lx(e)}`)}(e,t)}function RD(e,t){const n={};return zE(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):KE(e,((e,r)=>{const i=kD(r,t.xc(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function ND(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof BE||e instanceof uD||e instanceof aD||e instanceof Vx||e instanceof cD)}function AD(e,t,n){if(!ND(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Lx(n);throw"an object"===r?t.Mc(e+" a custom object"):t.Mc(e+" "+r)}}function PD(e,t,n){if((t=Ia(t))instanceof oD)return t._internalPath;if("string"==typeof t)return DD(e,t);throw OD("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}const xD=new RegExp("[~\\*/\\[\\]]");function DD(e,t,n){if(t.search(xD)>=0)throw OD(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new oD(...t.split("."))._internalPath}catch(r){throw OD(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function OD(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new kE(CE.INVALID_ARGUMENT,a+e+c)}function MD(e,t){return e.some((e=>e.isEqual(t)))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class LD{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Vx(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new FD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(UD("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class FD extends LD{data(){return super.data()}}function UD(e,t){return"string"==typeof t?DD(e,t):t instanceof oD?t._internalPath:t._delegate._internalPath}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class qD{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class jD extends LD{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new VD(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(UD("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class VD extends jD{data(e={}){return super.data(e)}}class BD{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new qD(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new VD(this._firestore,this._userDataWriter,n.key,n,new qD(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new kE(CE.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t,n=0;return e._snapshot.docChanges.map((r=>{const i=new VD(e._firestore,e._userDataWriter,r.doc.key,r.doc,new qD(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter);return t=r.doc,{type:"added",doc:i,oldIndex:-1,newIndex:n++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new VD(e._firestore,e._userDataWriter,t.doc.key,t.doc,new qD(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:$D(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function $D(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return OE()}}function WD(e,t){return e instanceof jD&&t instanceof jD?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof BD&&t instanceof BD&&e._firestore===t._firestore&&Hx(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function KD(e){if(JS(e)&&0===e.explicitOrderBy.length)throw new kE(CE.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class zD{}function HD(e,...t){for(const n of t)e=n._apply(e);return e}class GD extends zD{constructor(e,t,n){super(),this.Qc=e,this.jc=t,this.Wc=n,this.type="where"}_apply(e){const t=mD(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new kE(CE.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on FieldPath.documentId().`);if("in"===s||"not-in"===s){tO(o,s);const t=[];for(const n of o)t.push(eO(r,e,n));a={arrayValue:{values:t}}}else a=eO(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||tO(o,s),a=CD(n,"where",o,"in"===s||"not-in"===s);const c=xS.create(i,s,a);return function(e,t){if(t.g()){const n=ZS(e);if(null!==n&&!n.isEqual(t.field))throw new kE(CE.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${t.field.toString()}'`);const r=XS(e);null!==r&&nO(e,t.field,r)}const n=function(e,t){for(const n of e.filters)if(t.indexOf(n.op)>=0)return n.op;return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new kE(CE.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new kE(CE.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}(e,c),c}(e._query,0,t,e.firestore._databaseId,this.Qc,this.jc,this.Wc);return new Bx(e.firestore,e.converter,function(e,t){const n=e.filters.concat([t]);return new HS(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))}}class QD extends zD{constructor(e,t){super(),this.Qc=e,this.Gc=t,this.type="orderBy"}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new kE(CE.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new kE(CE.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new $S(t,n);return function(e,t){if(null===XS(e)){const n=ZS(e);null!==n&&nO(e,n,t.field)}}(e,r),r}(e._query,this.Qc,this.Gc);return new Bx(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new HS(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class YD extends zD{constructor(e,t,n){super(),this.type=e,this.zc=t,this.Hc=n}_apply(e){return new Bx(e.firestore,e.converter,rC(e._query,this.zc,this.Hc))}}class JD extends zD{constructor(e,t,n){super(),this.type=e,this.Jc=t,this.Yc=n}_apply(e){const t=ZD(e,this.type,this.Jc,this.Yc);return new Bx(e.firestore,e.converter,function(e,t){return new HS(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}class XD extends zD{constructor(e,t,n){super(),this.type=e,this.Jc=t,this.Yc=n}_apply(e){const t=ZD(e,this.type,this.Jc,this.Yc);return new Bx(e.firestore,e.converter,function(e,t){return new HS(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function ZD(e,t,n,r){if(n[0]=Ia(n[0]),n[0]instanceof LD)return function(e,t,n,r,i){if(!r)throw new kE(CE.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const n of tC(e))if(n.field.isKeyField())s.push(yS(t,r.key));else{const e=r.data.field(n.field);if(rS(e))throw new kE(CE.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=n.field.canonicalString();throw new kE(CE.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new VS(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=mD(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new kE(CE.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let s=0;s<i.length;s++){const c=i[s];if(o[s].field.isKeyField()){if("string"!=typeof c)throw new kE(CE.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof c}`);if(!eC(e)&&-1!==c.indexOf("/"))throw new kE(CE.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${r}() must be a plain document ID, but '${c}' contains a slash.`);const n=e.path.child(GE.fromString(c));if(!uS.isDocumentKey(n))throw new kE(CE.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new uS(n);a.push(yS(t,i))}else{const e=CD(n,r,c);a.push(e)}}return new VS(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function eO(e,t,n){if("string"==typeof(n=Ia(n))){if(""===n)throw new kE(CE.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!eC(t)&&-1!==n.indexOf("/"))throw new kE(CE.INVALID_ARGUMENT,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(GE.fromString(n));if(!uS.isDocumentKey(r))throw new kE(CE.INVALID_ARGUMENT,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return yS(e,new uS(r))}if(n instanceof Vx)return yS(e,n._key);throw new kE(CE.INVALID_ARGUMENT,`Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: ${Lx(n)}.`)}function tO(e,t){if(!Array.isArray(e)||0===e.length)throw new kE(CE.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(e.length>10)throw new kE(CE.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function nO(e,t,n){if(!n.isEqual(t))throw new kE(CE.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class rO{convertValue(e,t="none"){switch(lS(e)){case 0:return null;case 1:return e.booleanValue;case 2:return tS(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(nS(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw OE()}}convertObject(e,t){const n={};return KE(e.fields,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new uD(tS(e.latitude),tS(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=iS(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(sS(e));default:return null}}convertTimestamp(e){const t=eS(e);return new BE(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=GE.fromString(e);ME(Qk(n));const r=new Sx(n.get(1),n.get(3)),i=new uS(n.popFirst(5));return r.isEqual(t)||PE(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function iO(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class sO extends rO{constructor(e){super(),this.firestore=e}convertBytes(e){return new aD(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Vx(this.firestore,null,t)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class oO{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=mD(e)}set(e,t,n){this._verifyNotCommitted();const r=aO(e,this._firestore),i=iO(r.converter,t,n),s=yD(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,kC.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=aO(e,this._firestore);let s;return s="string"==typeof(t=Ia(t))||t instanceof oD?SD(this._dataReader,"WriteBatch.update",i._key,t,n,r):ED(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(s.toMutation(i._key,kC.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=aO(e,this._firestore);return this._mutations=this._mutations.concat(new jC(t._key,kC.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new kE(CE.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function aO(e,t){if((e=Ia(e)).firestore!==t)throw new kE(CE.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class cO extends rO{constructor(e){super(),this.firestore=e}convertBytes(e){return new aD(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Vx(this.firestore,null,t)}}function uO(e){e=Fx(e,Vx);const t=Fx(e.firestore,Jx),n=Xx(t),r=new cO(t);return function(e,t){const n=new vR;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await function(e,t){const n=LE(e);return n.persistence.runTransaction("read document","readonly",(e=>n.Mn.mn(e,t)))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new kE(CE.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=oP(e,`Failed to get document '${t} from cache`);n.reject(r)}}(await yx(e),t,n))),n.promise}(n,e._key).then((n=>new jD(t,r,e._key,n,new qD(null!==n&&n.hasLocalMutations,!0),e.converter)))}function lO(e){e=Fx(e,Bx);const t=Fx(e.firestore,Jx),n=Xx(t),r=new cO(t);return function(e,t){const n=new vR;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await zN(e,t,!0),i=new EP(t,r.Bn),s=i._o(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(e){const r=oP(e,`Failed to execute query '${t} against cache`);n.reject(r)}}(await yx(e),t,n))),n.promise}(n,e._query).then((n=>new BD(t,r,e,n)))}function hO(e,t,n,...r){e=Fx(e,Vx);const i=Fx(e.firestore,Jx),s=mD(i);let o;return o="string"==typeof(t=Ia(t))||t instanceof oD?SD(s,"updateDoc",e._key,t,n,r):ED(s,"updateDoc",e._key,t),pO(i,[o.toMutation(e._key,kC.exists(!0))])}function dO(e,...t){var n,r,i;e=Ia(e);let s={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||Qx(t[o])||(s=t[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(Qx(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[o+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let c,u,l;if(e instanceof Vx)u=Fx(e.firestore,Jx),l=QS(e._key.path),c={next:n=>{t[o]&&t[o](gO(u,e,n))},error:t[o+1],complete:t[o+2]};else{const n=Fx(e,Bx);u=Fx(n.firestore,Jx),l=n._query;const r=new cO(u);c={next:e=>{t[o]&&t[o](new BD(u,r,n,e))},error:t[o+1],complete:t[o+2]},KD(e._query)}return function(e,t,n,r){const i=new ax(r),s=new yP(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>dP(await wx(e),s))),()=>{i.Wo(),e.asyncQueue.enqueueAndForget((async()=>fP(await wx(e),s)))}}(Xx(u),l,a,c)}function fO(e,t){return function(e,t){const n=new ax(t);return e.asyncQueue.enqueueAndForget((async()=>function(e,t){LE(e).Gr.add(t),t.next()}(await wx(e),n))),()=>{n.Wo(),e.asyncQueue.enqueueAndForget((async()=>function(e,t){LE(e).Gr.delete(t)}(await wx(e),n)))}}(Xx(e=Fx(e,Jx)),Qx(t)?t:{next:t})}function pO(e,t){return function(e,t){const n=new vR;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=tx(e);try{const e=await function(e,t){const n=LE(e),r=BE.now(),i=t.reduce(((e,t)=>e.add(t.key)),sk());let s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>n.Mn.pn(e,i).next((i=>{s=i;const o=[];for(const e of t){const t=xC(e,s.get(e.key));null!=t&&o.push(new LC(e.key,t,SS(t.value.mapValue),kC.exists(!0)))}return n._n.addMutationBatch(e,r,o,t)})))).then((e=>(e.applyToLocalDocumentSet(s),{batchId:e.batchId,changes:s})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.xo[e.currentUser.toKey()];r||(r=new HC(qE)),r=r.insert(t,n),e.xo[e.currentUser.toKey()]=r}(r,e.batchId,n),await $P(r,e.changes),await HA(r.remoteStore)}catch(e){const t=oP(e,"Failed to persist write");n.reject(t)}}(await vx(e),t,n))),n.promise}(Xx(e),t)}function gO(e,t,n){const r=n.docs.get(t._key),i=new cO(e);return new jD(e,i,t._key,r,new qD(n.hasPendingWrites,n.fromCache),t.converter)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class mO extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=mD(e)}get(e){const t=aO(e,this._firestore),n=new sO(this._firestore);return this._transaction.lookup([t._key]).then((e=>{if(!e||1!==e.length)return OE();const r=e[0];if(r.isFoundDocument())return new LD(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new LD(this._firestore,n,t._key,null,t.converter);throw OE()}))}set(e,t,n){const r=aO(e,this._firestore),i=iO(r.converter,t,n),s=yD(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n,...r){const i=aO(e,this._firestore);let s;return s="string"==typeof(t=Ia(t))||t instanceof oD?SD(this._dataReader,"Transaction.update",i._key,t,n,r):ED(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,s),this}delete(e){const t=aO(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=aO(e,this._firestore),n=new cO(this._firestore);return super.get(e).then((e=>new jD(this._firestore,n,t._key,e._document,new qD(!1,!1),t.converter)))}}function yO(e,t){return function(e,t){const n=new vR;return e.asyncQueue.enqueueAndForget((async()=>{const r=await function(e){return gx(e).then((e=>e.datastore))}(e);new lx(e.asyncQueue,r,t,n).run()})),n.promise}(Xx(e),(n=>t(new mO(e,n))))}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */EE="9.0.0-beta.5",Wa(new Ta("firestore-exp",((e,{options:t})=>{const n=e.getProvider("app-exp").getImmediate(),r=new Jx(n,e.getProvider("auth-internal"));return t=Object.assign({useFetchStreams:!1},t),r._setSettings(t),r}),"PUBLIC")),Ja("@firebase/firestore","0.0.900-exp.57f19127c",undefined);
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const _O="(default)";class vO{constructor(e,t){this.projectId=e,this.database=t||_O}get isDefaultDatabase(){return this.database===_O}isEqual(e){return e instanceof vO&&e.projectId===this.projectId&&e.database===this.database}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let wO="8.6.8";
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const bO=new Oa("@firebase/firestore");function IO(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
var t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function TO(e="Unexpected state"){const t=`FIRESTORE (${wO}) INTERNAL ASSERTION FAILED: `+e;throw function(e,...t){if(bO.logLevel<=ka.ERROR){const n=t.map(IO);bO.error(`Firestore (${wO}): ${e}`,...n)}}(t),new Error(t)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const EO="invalid-argument",SO="failed-precondition",CO="unimplemented";class kO extends Error{constructor(e,t){super(t),this.code=e,this.message=t,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const RO="__name__";class NO{constructor(e,t,n){void 0===t?t=0:t>e.length&&TO(),void 0===n?n=e.length-t:n>e.length-t&&TO(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===NO.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof NO?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class AO extends NO{construct(e,t,n){return new AO(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new kO(EO,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new AO(t)}static emptyPath(){return new AO([])}}const PO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xO extends NO{construct(e,t,n){return new xO(e,t,n)}static isValidIdentifier(e){return PO.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xO.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===RO}static keyField(){return new xO([RO])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new kO(EO,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new kO(EO,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new kO(EO,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new kO(EO,"Unterminated ` in path: "+e);return new xO(t)}static emptyPath(){return new xO([])}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class DO{constructor(e){this.path=e}static fromPath(e){return new DO(AO.fromString(e))}static fromName(e){return new DO(AO.fromString(e).popFirst(5))}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}isEqual(e){return null!==e&&0===AO.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return AO.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new DO(new AO(e.slice()))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function OO(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new kO(EO,`Invalid options passed to function ${e}(): You cannot specify both "merge" and "mergeFields".`);return t}function MO(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new kO(EO,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=function(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){if(e.constructor){const t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":TO()}(e);throw new kO(EO,`Expected type '${t.name}', but it was: ${n}`)}}return e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function LO(){if("undefined"==typeof Uint8Array)throw new kO(CO,"Uint8Arrays are not available in this environment.")}function FO(){if("undefined"==typeof atob)throw new kO(CO,"Blobs are unavailable in Firestore in this environment.")}class UO{constructor(e){this._delegate=e}static fromBase64String(e){return FO(),new UO(aD.fromBase64String(e))}static fromUint8Array(e){return LO(),new UO(aD.fromUint8Array(e))}toBase64(){return FO(),this._delegate.toBase64()}toUint8Array(){return LO(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function qO(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of t)if(e in n&&"function"==typeof n[e])return!0;return!1}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,["next","error","complete"])}class jO{enableIndexedDbPersistence(e,t){return function(e,t){sD(e=Fx(e,Jx));const n=Xx(e),r=e._freezeSettings(),i=new sx;return eD(n,i,new rx(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function(e){sD(e=Fx(e,Jx));const t=Xx(e),n=e._freezeSettings(),r=new sx;return eD(t,r,new ix(r,n.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function(e){if(e._initialized&&!e._terminated)throw new kE(CE.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new vR;return e._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await async function(e){if(!IR.gt())return Promise.resolve();const t=e+"main";await IR.delete(t)}(DN(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}})),t.promise}(e._delegate)}}class VO{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof vO||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();e.merge||t.host===e.host||function(e,...t){if(bO.logLevel<=ka.WARN){const n=t.map(IO);bO.warn(`Firestore (${wO}): ${e}`,...n)}}("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,n={}){!function(e,t,n,r={}){const i=(e=Fx(e,jx))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==t&&xE("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},i),{host:`${t}:${n}`,ssl:!1})),r.mockUserToken){const t=Uo(r.mockUserToken),n=r.mockUserToken.sub||r.mockUserToken.user_id;if(!n)throw new kE(CE.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");e._credentials=new Nx(new kx(t,new oA(n)))}}(this._delegate,e,t,n)}enableNetwork(){return nD(this._delegate)}disableNetwork(){return rD(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,function(e,t,n,r){if(!0===t&&!0===r)throw new kO(EO,`${e} and ${n} cannot be used together.`)}("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore"),this._appCompat._removeServiceInstance("firestore-exp")),this._delegate._delete()}waitForPendingWrites(){return tD(this._delegate)}onSnapshotsInSync(e){return fO(this._delegate,e)}get app(){if(!this._appCompat)throw new kO(SO,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new tM(this,Wx(this._delegate,e))}catch(e){throw HO(e,"collection()","Firestore.collection()")}}doc(e){try{return new zO(this,Kx(this._delegate,e))}catch(e){throw HO(e,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new XO(this,function(e,t){if(e=Fx(e,jx),Dx("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new kE(CE.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Bx(e,null,function(e){return new HS(GE.emptyPath(),e)}(t))}(this._delegate,e))}catch(e){throw HO(e,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return yO(this._delegate,(t=>e(new $O(this,t))))}batch(){return Xx(this._delegate),new WO(new oO(this._delegate,(e=>pO(this._delegate,e))))}loadBundle(e){throw new kO(SO,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')}namedQuery(e){throw new kO(SO,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')}}class BO extends rO{constructor(e){super(),this.firestore=e}convertBytes(e){return new UO(new aD(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return zO.forKey(t,this.firestore,null)}}class $O{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new BO(e)}get(e){const t=nM(e);return this._delegate.get(t).then((e=>new YO(this._firestore,new jD(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,t.converter))))}set(e,t,n){const r=nM(e);return n?(OO("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const i=nM(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){const t=nM(e);return this._delegate.delete(t),this}}class WO{constructor(e){this._delegate=e}set(e,t,n){const r=nM(e);return n?(OO("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const i=nM(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){const t=nM(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class KO{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new VD(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new JO(this._firestore,n),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=KO.INSTANCES;let r=n.get(e);r||(r=new WeakMap,n.set(e,r));let i=r.get(t);return i||(i=new KO(e,new BO(e),t),r.set(t,i)),i}}KO.INSTANCES=new WeakMap;class zO{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new BO(e)}static forPath(e,t,n){if(e.length%2!=0)throw new kO(EO,`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new zO(t,new Vx(t._delegate,n,new DO(e)))}static forKey(e,t,n){return new zO(t,new Vx(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new tM(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new tM(this.firestore,Wx(this._delegate,e))}catch(e){throw HO(e,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=Ia(e))instanceof Vx&&zx(this._delegate,e)}set(e,t){t=OO("DocumentReference.set",t);try{return function(e,t,n){e=Fx(e,Vx);const r=Fx(e.firestore,Jx),i=iO(e.converter,t,n);return pO(r,[yD(mD(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,kC.none())])}(this._delegate,e,t)}catch(e){throw HO(e,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return 1===arguments.length?hO(this._delegate,e):hO(this._delegate,e,t,...n)}catch(e){throw HO(e,"updateDoc()","DocumentReference.update()")}}delete(){return function(e){return pO(Fx(e.firestore,Jx),[new jC(e._key,kC.none())])}(this._delegate)}onSnapshot(...e){const t=GO(e),n=QO(e,(e=>new YO(this.firestore,new jD(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))));return dO(this._delegate,t,n)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?uO(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=Fx(e,Vx);const t=Fx(e.firestore,Jx);return bx(Xx(t),e._key,{source:"server"}).then((n=>gO(t,e,n)))}(this._delegate):function(e){e=Fx(e,Vx);const t=Fx(e.firestore,Jx);return bx(Xx(t),e._key).then((n=>gO(t,e,n)))}(this._delegate),t.then((e=>new YO(this.firestore,new jD(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))))}withConverter(e){return new zO(this.firestore,e?this._delegate.withConverter(KO.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function HO(e,t,n){return e.message=e.message.replace(t,n),e}function GO(e){for(const t of e)if("object"==typeof t&&!qO(t))return t;return{}}function QO(e,t){var n,r;let i;return i=qO(e[0])?e[0]:qO(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]},{next:e=>{i.next&&i.next(t(e))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class YO{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new zO(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return WD(this._delegate,e._delegate)}}class JO extends YO{data(e){return this._delegate.data(e)}}class XO{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new BO(e)}where(e,t,n){try{return new XO(this.firestore,HD(this._delegate,function(e,t,n){const r=t,i=UD("where",e);return new GD(i,r,n)}(e,t,n)))}catch(e){throw HO(e,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new XO(this.firestore,HD(this._delegate,function(e,t="asc"){const n=t,r=UD("orderBy",e);return new QD(r,n)}(e,t)))}catch(e){throw HO(e,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new XO(this.firestore,HD(this._delegate,function(e){return Ux("limit",e),new YD("limit",e,"F")}(e)))}catch(e){throw HO(e,"limit()","Query.limit()")}}limitToLast(e){try{return new XO(this.firestore,HD(this._delegate,function(e){return Ux("limitToLast",e),new YD("limitToLast",e,"L")}(e)))}catch(e){throw HO(e,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new XO(this.firestore,HD(this._delegate,function(...e){return new JD("startAt",e,!0)}(...e)))}catch(e){throw HO(e,"startAt()","Query.startAt()")}}startAfter(...e){try{return new XO(this.firestore,HD(this._delegate,function(...e){return new JD("startAfter",e,!1)}(...e)))}catch(e){throw HO(e,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new XO(this.firestore,HD(this._delegate,function(...e){return new XD("endBefore",e,!0)}(...e)))}catch(e){throw HO(e,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new XO(this.firestore,HD(this._delegate,function(...e){return new XD("endAt",e,!1)}(...e)))}catch(e){throw HO(e,"endAt()","Query.endAt()")}}isEqual(e){return Hx(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?lO(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=Fx(e,Bx);const t=Fx(e.firestore,Jx),n=Xx(t),r=new cO(t);return Ix(n,e._query,{source:"server"}).then((n=>new BD(t,r,e,n)))}(this._delegate):function(e){e=Fx(e,Bx);const t=Fx(e.firestore,Jx),n=Xx(t),r=new cO(t);return KD(e._query),Ix(n,e._query).then((n=>new BD(t,r,e,n)))}(this._delegate),t.then((e=>new eM(this.firestore,new BD(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))))}onSnapshot(...e){const t=GO(e),n=QO(e,(e=>new eM(this.firestore,new BD(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))));return dO(this._delegate,t,n)}withConverter(e){return new XO(this.firestore,e?this._delegate.withConverter(KO.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class ZO{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new JO(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class eM{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new XO(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map((e=>new JO(this._firestore,e)))}docChanges(e){return this._delegate.docChanges(e).map((e=>new ZO(this._firestore,e)))}forEach(e,t){this._delegate.forEach((n=>{e.call(t,new JO(this._firestore,n))}))}isEqual(e){return WD(this._delegate,e._delegate)}}class tM extends XO{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new zO(this.firestore,e):null}doc(e){try{return new zO(this.firestore,void 0===e?Kx(this._delegate):Kx(this._delegate,e))}catch(e){throw HO(e,"doc()","CollectionReference.doc()")}}add(e){return function(e,t){const n=Fx(e.firestore,Jx),r=Kx(e),i=iO(e.converter,t);return pO(n,[yD(mD(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,kC.exists(!1))]).then((()=>r))}(this._delegate,e).then((e=>new zO(this.firestore,e)))}isEqual(e){return zx(this._delegate,e._delegate)}withConverter(e){return new tM(this.firestore,e?this._delegate.withConverter(KO.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function nM(e){return MO(e,Vx)}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function rM(e){return function(e,t){const n=Xx(e=Fx(e,Jx)),r=new Yx;return Tx(n,e._databaseId,t,r),r}(this._delegate,e)}function iM(e){return iD(this._delegate,e).then((e=>e?new XO(this,e):null))}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class sM{constructor(...e){this._delegate=new oD(...e)}static documentId(){return new sM(xO.keyField().canonicalString())}isEqual(e){return(e=Ia(e))instanceof oD&&this._delegate._internalPath.isEqual(e._internalPath)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class oM{constructor(e){this._delegate=e}static serverTimestamp(){const e=new wD("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new oM(e)}static delete(){const e=new _D("deleteField");return e._methodName="FieldValue.delete",new oM(e)}static arrayUnion(...e){const t=function(...e){return new bD("arrayUnion",e)}(...e);return t._methodName="FieldValue.arrayUnion",new oM(t)}static arrayRemove(...e){const t=function(...e){return new ID("arrayRemove",e)}(...e);return t._methodName="FieldValue.arrayRemove",new oM(t)}static increment(e){const t=function(e){return new TD("increment",e)}(e);return t._methodName="FieldValue.increment",new oM(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const aM={Firestore:VO,GeoPoint:uD,Timestamp:BE,Blob:UO,Transaction:$O,WriteBatch:WO,DocumentReference:zO,DocumentSnapshot:YO,Query:XO,QueryDocumentSnapshot:JO,QuerySnapshot:eM,CollectionReference:tM,FieldPath:sM,FieldValue:oM,setLogLevel:function(e){var t;t=e,bO.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};!
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e){!function(e){wO=e}(e.SDK_VERSION),function(e,t){e.INTERNAL.registerComponent(new Ta("firestore-compat",(e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore-exp").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},aM)))}(e,((e,t)=>new VO(e,t,new jO))),e.registerVersion("@firebase/firestore-compat","0.0.900-exp.57f19127c")}(oc),function(e){e.prototype.loadBundle=rM,e.prototype.namedQuery=iM}(VO);function cM(e,t){const n={};for(const r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function uM(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map((e=>uM(e)));if("function"==typeof e||"object"==typeof e)return cM(e,(e=>uM(e)));throw new Error("Data cannot be encoded in JSON: "+e)}function lM(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map((e=>lM(e))):"function"==typeof e||"object"==typeof e?cM(e,(e=>lM(e))):e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const hM="functions-exp",dM={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class fM extends Qo{constructor(e,t,n){super(`functions-exp/${e}`,t||""),this.details=n}}class pM{constructor(e,t){this.auth=null,this.messaging=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then((e=>this.auth=e),(()=>{})),this.messaging||t.get().then((e=>this.messaging=e),(()=>{}))}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return null==e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getContext(){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken()}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const gM="us-central1";function mM(e){return new Promise(((t,n)=>{setTimeout((()=>{n(new fM("deadline-exceeded","deadline-exceeded"))}),e)}))}class yM{constructor(e,t,n,r="us-central1",i){this.app=e,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new pM(t,n),this.cancelAllRequests=new Promise((e=>{this.deleteService=()=>Promise.resolve(e())}));try{const e=new URL(r);this.customDomain=e.origin,this.region=gM}catch(e){this.customDomain=null,this.region=r}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;if(null!==this.emulatorOrigin){return`${this.emulatorOrigin}/${t}/${this.region}/${e}`}return null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function _M(e,t,n){return r=>async function(e,t,n,r){const i=e._url(t),s={data:n=uM(n)},o={},a=await e.contextProvider.getContext();a.authToken&&(o.Authorization="Bearer "+a.authToken);a.messagingToken&&(o["Firebase-Instance-ID-Token"]=a.messagingToken);const c=r.timeout||7e4,u=await Promise.race([vM(i,s,o,e.fetchImpl),mM(c),e.cancelAllRequests]);if(!u)throw new fM("cancelled","Firebase Functions instance was deleted.");const l=function(e,t){let n,r=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),i=r;try{const e=t&&t.error;if(e){const t=e.status;if("string"==typeof t){if(!dM[t])return new fM("internal","internal");r=dM[t],i=t}const s=e.message;"string"==typeof s&&(i=s),n=e.details,void 0!==n&&(n=lM(n))}}catch(e){}return"ok"===r?null:new fM(r,i,n)}(u.status,u.json);if(l)throw l;if(!u.json)throw new fM("internal","Response is not valid JSON object.");let h=u.json.data;void 0===h&&(h=u.json.result);if(void 0===h)throw new fM("internal","Response is missing data field.");return{data:lM(h)}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,t,r,n||{})}async function vM(e,t,n,r){let i;n["Content-Type"]="application/json";try{i=await r(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch(e){return{status:0,json:null}}let s=null;try{s=await i.json()}catch(e){}return{status:i.status,json:s}}function wM(e,t,n){!function(e,t,n){e.emulatorOrigin=`http://${t}:${n}`}(Ia(e),t,n)}var bM;bM=fetch.bind(self),Wa(new Ta(hM,((e,{instanceIdentifier:t})=>{const n=e.getProvider("app-exp").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("messaging");return new yM(n,r,i,t,bM)}),"PUBLIC").setMultipleInstances(!0)),Ja("@firebase/functions-exp","0.0.900-exp.57f19127c");
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class IM{constructor(e,t){this.app=e,this._delegate=t,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(e,t){return function(e,t,n){return _M(Ia(e),t,n)}(this._delegate,e,t)}useFunctionsEmulator(e){const t=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(null==t)throw new Qo("functions","No origin provided to useFunctionsEmulator()");if(null==t[2])throw new Qo("functions","Port missing in origin provided to useFunctionsEmulator()");return wM(this._delegate,t[1],Number(t[2]))}useEmulator(e,t){return wM(this._delegate,e,t)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const TM=(e,{instanceIdentifier:t})=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("functions-exp").getImmediate({identifier:null!=t?t:"us-central1"});return new IM(n,r)};function EM(e){return Array.prototype.slice.call(e)}function SM(e){return new Promise((function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function CM(e,t,n){var r,i=new Promise((function(i,s){SM(r=e[t].apply(e,n)).then(i,s)}));return i.request=r,i}function kM(e,t,n){var r=CM(e,t,n);return r.then((function(e){if(e)return new DM(e,r.request)}))}function RM(e,t,n){n.forEach((function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})}))}function NM(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return CM(this[t],r,arguments)})}))}function AM(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})}))}function PM(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return kM(this[t],r,arguments)})}))}function xM(e){this._index=e}function DM(e,t){this._cursor=e,this._request=t}function OM(e){this._store=e}function MM(e){this._tx=e,this.complete=new Promise((function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}}))}function LM(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new MM(n)}function FM(e){this._db=e}function UM(e,t,n){var r=CM(indexedDB,"open",[e,t]),i=r.request;return i&&(i.onupgradeneeded=function(e){n&&n(new LM(i.result,e.oldVersion,i.transaction))}),r.then((function(e){return new FM(e)}))}function qM(e){return CM(indexedDB,"deleteDatabase",[e])}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
!function(){const e={Functions:IM};oc.INTERNAL.registerComponent(new Ta("functions-compat",TM,"PUBLIC").setServiceProps(e).setMultipleInstances(!0))}(),oc.registerVersion("@firebase/functions-compat","0.0.900-exp.57f19127c"),RM(xM,"_index",["name","keyPath","multiEntry","unique"]),NM(xM,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),PM(xM,"_index",IDBIndex,["openCursor","openKeyCursor"]),RM(DM,"_cursor",["direction","key","primaryKey","value"]),NM(DM,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(e){e in IDBCursor.prototype&&(DM.prototype[e]=function(){var t=this,n=arguments;return Promise.resolve().then((function(){return t._cursor[e].apply(t._cursor,n),SM(t._request).then((function(e){if(e)return new DM(e,t._request)}))}))})})),OM.prototype.createIndex=function(){return new xM(this._store.createIndex.apply(this._store,arguments))},OM.prototype.index=function(){return new xM(this._store.index.apply(this._store,arguments))},RM(OM,"_store",["name","keyPath","indexNames","autoIncrement"]),NM(OM,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),PM(OM,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),AM(OM,"_store",IDBObjectStore,["deleteIndex"]),MM.prototype.objectStore=function(){return new OM(this._tx.objectStore.apply(this._tx,arguments))},RM(MM,"_tx",["objectStoreNames","mode"]),AM(MM,"_tx",IDBTransaction,["abort"]),LM.prototype.createObjectStore=function(){return new OM(this._db.createObjectStore.apply(this._db,arguments))},RM(LM,"_db",["name","version","objectStoreNames"]),AM(LM,"_db",IDBDatabase,["deleteObjectStore","close"]),FM.prototype.transaction=function(){return new MM(this._db.transaction.apply(this._db,arguments))},RM(FM,"_db",["name","version","objectStoreNames"]),AM(FM,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(e){[OM,xM].forEach((function(t){e in t.prototype&&(t.prototype[e.replace("open","iterate")]=function(){var t=EM(arguments),n=t[t.length-1],r=this._store||this._index,i=r[e].apply(r,t.slice(0,-1));i.onsuccess=function(){n(i.result)}})}))})),[xM,OM].forEach((function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise((function(i){n.iterateCursor(e,(function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():i(r)):i(r)}))}))})}));const jM="0.0.900-exp.57f19127c",VM=1e4,BM=`w:${jM}`,$M="FIS_v2",WM=36e5,KM=new Yo("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function zM(e){return e instanceof Qo&&e.code.includes("request-failed")}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function HM({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function GM(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function QM(e,t){const n=(await t.json()).error;return KM.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function YM({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function JM(e,{refreshToken:t}){const n=YM(e);return n.append("Authorization",function(e){return`FIS_v2 ${e}`}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t)),n}async function XM(e){const t=await e();return t.status>=500&&t.status<600?e():t}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function ZM(e){return new Promise((t=>{setTimeout(t,e)}))}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const eL=/^[cdef][\w-]{21}$/;function tL(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var t}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e);return eL.test(t)?t:""}catch(e){return""}}function nL(e){return`${e.appName}!${e.appId}`}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const rL=new Map;function iL(e,t){const n=nL(e);sL(n,t),function(e,t){const n=function(){!oL&&"BroadcastChannel"in self&&(oL=new BroadcastChannel("[Firebase] FID Change"),oL.onmessage=e=>{sL(e.data.key,e.data.fid)});return oL}();n&&n.postMessage({key:e,fid:t});0===rL.size&&oL&&(oL.close(),oL=null)}(n,t)}function sL(e,t){const n=rL.get(e);if(n)for(const e of n)e(t)}let oL=null;
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const aL="firebase-installations-store";let cL=null;function uL(){return cL||(cL=UM("firebase-installations-database",1,(e=>{switch(e.oldVersion){case 0:e.createObjectStore(aL)}}))),cL}async function lL(e,t){const n=nL(e),r=(await uL()).transaction(aL,"readwrite"),i=r.objectStore(aL),s=await i.get(n);return await i.put(t,n),await r.complete,s&&s.fid===t.fid||iL(e,t.fid),t}async function hL(e){const t=nL(e),n=(await uL()).transaction(aL,"readwrite");await n.objectStore(aL).delete(t),await n.complete}async function dL(e,t){const n=nL(e),r=(await uL()).transaction(aL,"readwrite"),i=r.objectStore(aL),s=await i.get(n),o=t(s);return void 0===o?await i.delete(n):await i.put(o,n),await r.complete,!o||s&&s.fid===o.fid||iL(e,o.fid),o}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function fL(e){let t;const n=await dL(e,(n=>{const r=function(e){return mL(e||{fid:tL(),registrationStatus:0})}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(KM.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:async function(e,t){try{return lL(e,await async function(e,{fid:t}){const n=HM(e),r=YM(e),i={fid:t,authVersion:$M,appId:e.appId,sdkVersion:BM},s={method:"POST",headers:r,body:JSON.stringify(i)},o=await XM((()=>fetch(n,s)));if(o.ok){const e=await o.json();return{fid:e.fid||t,registrationStatus:2,refreshToken:e.refreshToken,authToken:GM(e.authToken)}}throw await QM("Create Installation",o)}(e,t))}catch(n){throw zM(n)&&409===n.customData.serverCode?await hL(e):await lL(e,{fid:t.fid,registrationStatus:0}),n}}(e,n)}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:pL(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function pL(e){let t=await gL(e);for(;1===t.registrationStatus;)await ZM(100),t=await gL(e);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await fL(e);return n||t}return t}function gL(e){return dL(e,(e=>{if(!e)throw KM.create("installation-not-found");return mL(e)}))}function mL(e){return 1===(t=e).registrationStatus&&t.registrationTime+VM<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t;
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}async function yL({appConfig:e,platformLoggerProvider:t},n){const r=function(e,{fid:t}){return`${HM(e)}/${t}/authTokens:generate`}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e,n),i=JM(e,n),s=t.getImmediate({optional:!0});s&&i.append("x-firebase-client",s.getPlatformInfoString());const o={installation:{sdkVersion:BM}},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await XM((()=>fetch(r,a)));if(c.ok){return GM(await c.json())}throw await QM("Generate Auth Token",c)}async function _L(e,t=!1){let n;const r=await dL(e.appConfig,(r=>{if(!wL(r))throw KM.create("not-registered");const i=r.authToken;if(!t&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+WM}(e)}(i))return r;if(1===i.requestStatus)return n=async function(e,t){let n=await vL(e.appConfig);for(;1===n.authToken.requestStatus;)await ZM(100),n=await vL(e.appConfig);const r=n.authToken;return 0===r.requestStatus?_L(e,t):r}(e,t),r;{if(!navigator.onLine)throw KM.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return n=async function(e,t){try{const n=await yL(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await lL(e.appConfig,r),n}catch(n){if(!zM(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await lL(e.appConfig,n)}else await hL(e.appConfig);throw n}}(e,t),t}}));return n?await n:r.authToken}function vL(e){return dL(e,(e=>{if(!wL(e))throw KM.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+VM<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n;
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */}))}function wL(e){return void 0!==e&&2===e.registrationStatus}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function bL(e,t=!1){const n=e;await async function(e){const{registrationPromise:t}=await fL(e);t&&await t}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(n.appConfig);return(await _L(n,t)).token}function IL(e){return KM.create("missing-app-config-values",{valueName:e})}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const TL="installations-exp",EL=e=>{const t=Ka(e.getProvider("app-exp").getImmediate(),TL).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await fL(t.appConfig);return r?r.catch(console.error):_L(t).catch(console.error),n.fid}(t),getToken:e=>bL(t,e)}};Wa(new Ta(TL,(e=>{const t=e.getProvider("app-exp").getImmediate();return{app:t,appConfig:function(e){if(!e||!e.options)throw IL("App Configuration");if(!e.name)throw IL("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw IL(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t),platformLoggerProvider:Ka(t,"platform-logger"),_delete:()=>Promise.resolve()}}),"PUBLIC")),Wa(new Ta("installations-exp-internal",EL,"PRIVATE")),Ja("@firebase/installations-exp",jM);
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const SL=new Yo("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const CL="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",kL="google.c.a.c_id";
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
   * in compliance with the License. You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software distributed under the License
   * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
   * or implied. See the License for the specific language governing permissions and limitations under
   * the License.
   */
var RL;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function NL(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function AL(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let e=0;e<n.length;++e)r[e]=n.charCodeAt(e);return r}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */!function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(RL||(RL={}));const PL="fcm_token_details_db",xL="fcm_token_object_Store";
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const DL="firebase-messaging-store";let OL=null;function ML(){return OL||(OL=UM("firebase-messaging-database",1,(e=>{switch(e.oldVersion){case 0:e.createObjectStore(DL)}}))),OL}async function LL(e){const t=UL(e),n=await ML(),r=await n.transaction(DL).objectStore(DL).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB&&!(await indexedDB.databases()).map((e=>e.name)).includes(PL))return null;let t=null;return(await UM(PL,5,(async n=>{var r;if(n.oldVersion<2)return;if(!n.objectStoreNames.contains(xL))return;const i=n.transaction.objectStore(xL),s=await i.index("fcmSenderId").get(e);if(await i.clear(),s)if(2===n.oldVersion){const e=s;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(r=e.createTime)&&void 0!==r?r:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"==typeof e.vapidKey?e.vapidKey:NL(e.vapidKey)}}}else if(3===n.oldVersion){const e=s;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:NL(e.auth),p256dh:NL(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:NL(e.vapidKey)}}}else if(4===n.oldVersion){const e=s;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:NL(e.auth),p256dh:NL(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:NL(e.vapidKey)}}}}))).close(),await qM(PL),await qM("fcm_vapid_details_db"),await qM("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await FL(e,t),t}}async function FL(e,t){const n=UL(e),r=(await ML()).transaction(DL,"readwrite");return await r.objectStore(DL).put(t,n),await r.complete,t}function UL({appConfig:e}){return e.appId}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function qL(e,t){const n={method:"DELETE",headers:await VL(e)};try{const r=await fetch(`${jL(e.appConfig)}/${t}`,n),i=await r.json();if(i.error){const e=i.error.message;throw SL.create("token-unsubscribe-failed",{errorInfo:e})}}catch(e){throw SL.create("token-unsubscribe-failed",{errorInfo:e})}}function jL({projectId:e}){return`https://fcmregistrations.googleapis.com/v1/projects/${e}/registrations`}async function VL({appConfig:e,installations:t}){const n=await t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function BL({p256dh:e,auth:t,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:t,p256dh:e}};return r!==CL&&(i.web.applicationPubKey=r),i}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function $L(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:AL(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:NL(t.getKey("auth")),p256dh:NL(t.getKey("p256dh"))},r=await LL(e.firebaseDependencies);if(r){if(function(e,t){const n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,i=t.auth===e.auth,s=t.p256dh===e.p256dh;return n&&r&&i&&s}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(r.subscriptionOptions,n))return Date.now()>=r.createTime+6048e5?async function(e,t){try{const n=await async function(e,t){const n=await VL(e),r=BL(t.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let s;try{const n=await fetch(`${jL(e.appConfig)}/${t.token}`,i);s=await n.json()}catch(e){throw SL.create("token-update-failed",{errorInfo:e})}if(s.error){const e=s.error.message;throw SL.create("token-update-failed",{errorInfo:e})}if(!s.token)throw SL.create("token-update-no-token");return s.token}(e.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:n,createTime:Date.now()});return await FL(e.firebaseDependencies,r),n}catch(t){throw await WL(e),t}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await qL(e.firebaseDependencies,r.token)}catch(e){console.warn(e)}return KL(e.firebaseDependencies,n)}return KL(e.firebaseDependencies,n)}async function WL(e){const t=await LL(e.firebaseDependencies);t&&(await qL(e.firebaseDependencies,t.token),await async function(e){const t=UL(e),n=(await ML()).transaction(DL,"readwrite");await n.objectStore(DL).delete(t),await n.complete}(e.firebaseDependencies));const n=await e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}async function KL(e,t){const n={token:await async function(e,t){const n=await VL(e),r=BL(t),i={method:"POST",headers:n,body:JSON.stringify(r)};let s;try{const t=await fetch(jL(e.appConfig),i);s=await t.json()}catch(e){throw SL.create("token-subscribe-failed",{errorInfo:e})}if(s.error){const e=s.error.message;throw SL.create("token-subscribe-failed",{errorInfo:e})}if(!s.token)throw SL.create("token-subscribe-no-token");return s.token}(e,t),createTime:Date.now(),subscriptionOptions:t};return await FL(e,n),n.token}function zL(e){const t={from:e.from,collapseKey:e.collapse_key};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const i=t.notification.image;i&&(e.notification.image=i)}(t,e),function(e,t){if(!t.data)return;e.data=t.data}(t,e),function(e,t){if(!t.fcmOptions)return;e.fcmOptions={};const n=t.fcmOptions.link;n&&(e.fcmOptions.link=n);const r=t.fcmOptions.analytics_label;r&&(e.fcmOptions.analyticsLabel=r)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t,e),t}function HL(e){return SL.create("missing-app-config-values",{valueName:e})}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class GL{constructor(e,t,n){this.onBackgroundMessageHandler=null,this.onMessageHandler=null;const r=
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e){if(!e||!e.options)throw HL("App Configuration Object");if(!e.name)throw HL("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const e of t)if(!n[e])throw HL(e);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function QL(e,t,n){const r=function(e){switch(e){case RL.NOTIFICATION_CLICKED:return"notification_open";case RL.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t);(await e.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n["google.c.a.c_id"],message_name:n["google.c.a.c_l"],message_time:n["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)})}async function YL(e,t){const n=t.data;if(!n.isFirebaseMessaging)return;e.onMessageHandler&&n.messageType===RL.PUSH_RECEIVED&&("function"==typeof e.onMessageHandler?e.onMessageHandler(zL(n)):e.onMessageHandler.next(zL(n)));const r=n.data;(function(e){return"object"==typeof e&&!!e&&kL in e})(r)&&"1"===r["google.c.a.e"]&&await QL(e,n.messageType,r)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function JL(e){try{e.swRegistration=await navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}),e.swRegistration.update().catch((()=>{}))}catch(e){throw SL.create("failed-service-worker-registration",{browserErrorMessage:e.message})}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function XL(e,t){if(!navigator)throw SL.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw SL.create("permission-blocked");return await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(e,t){t?e.vapidKey=t:e.vapidKey||(e.vapidKey=CL)}(e,null==t?void 0:t.vapidKey),await
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(e,t){if(t||e.swRegistration||await JL(e),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw SL.create("invalid-sw-registration");e.swRegistration=t}}(e,null==t?void 0:t.serviceWorkerRegistration),$L(e)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function ZL(e){return async function(e){if(!navigator)throw SL.create("only-available-in-window");return e.swRegistration||await JL(e),WL(e)}(e=Ia(e))}function eF(e,t){return function(e,t){if(!navigator)throw SL.create("only-available-in-window");return e.onMessageHandler=t,()=>{e.onMessageHandler=null}}(e=Ia(e),t)}Wa(new Ta("messaging-exp",(e=>{(
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(){return await Ho()&&"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})().then((e=>{if(!e)throw SL.create("unsupported-browser")})).catch((e=>{throw SL.create("indexed-db-unsupported")}));const t=new GL(e.getProvider("app-exp").getImmediate(),e.getProvider("installations-exp-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",(e=>YL(t,e))),t}),"PUBLIC"));
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const tF=new Yo("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const nF="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",rF="FCM_MSG";
/**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
   * in compliance with the License. You may obtain a copy of the License at
   *
   * http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software distributed under the License
   * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
   * or implied. See the License for the specific language governing permissions and limitations under
   * the License.
   */
var iF;
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function sF(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function oF(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let e=0;e<n.length;++e)r[e]=n.charCodeAt(e);return r}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */!function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(iF||(iF={}));const aF="fcm_token_details_db",cF="fcm_token_object_Store";
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const uF="firebase-messaging-store";let lF=null;function hF(){return lF||(lF=UM("firebase-messaging-database",1,(e=>{switch(e.oldVersion){case 0:e.createObjectStore(uF)}}))),lF}async function dF(e){const t=pF(e),n=await hF(),r=await n.transaction(uF).objectStore(uF).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB&&!(await indexedDB.databases()).map((e=>e.name)).includes(aF))return null;let t=null;return(await UM(aF,5,(async n=>{var r;if(n.oldVersion<2)return;if(!n.objectStoreNames.contains(cF))return;const i=n.transaction.objectStore(cF),s=await i.index("fcmSenderId").get(e);if(await i.clear(),s)if(2===n.oldVersion){const e=s;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(r=e.createTime)&&void 0!==r?r:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"==typeof e.vapidKey?e.vapidKey:sF(e.vapidKey)}}}else if(3===n.oldVersion){const e=s;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:sF(e.auth),p256dh:sF(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:sF(e.vapidKey)}}}else if(4===n.oldVersion){const e=s;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:sF(e.auth),p256dh:sF(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:sF(e.vapidKey)}}}}))).close(),await qM(aF),await qM("fcm_vapid_details_db"),await qM("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await fF(e,t),t}}async function fF(e,t){const n=pF(e),r=(await hF()).transaction(uF,"readwrite");return await r.objectStore(uF).put(t,n),await r.complete,t}function pF({appConfig:e}){return e.appId}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function gF(e,t){const n={method:"DELETE",headers:await yF(e)};try{const r=await fetch(`${mF(e.appConfig)}/${t}`,n),i=await r.json();if(i.error){const e=i.error.message;throw tF.create("token-unsubscribe-failed",{errorInfo:e})}}catch(e){throw tF.create("token-unsubscribe-failed",{errorInfo:e})}}function mF({projectId:e}){return`https://fcmregistrations.googleapis.com/v1/projects/${e}/registrations`}async function yF({appConfig:e,installations:t}){const n=await t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function _F({p256dh:e,auth:t,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:t,p256dh:e}};return r!==nF&&(i.web.applicationPubKey=r),i}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function vF(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:oF(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:sF(t.getKey("auth")),p256dh:sF(t.getKey("p256dh"))},r=await dF(e.firebaseDependencies);if(r){if(function(e,t){const n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,i=t.auth===e.auth,s=t.p256dh===e.p256dh;return n&&r&&i&&s}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(r.subscriptionOptions,n))return Date.now()>=r.createTime+6048e5?async function(e,t){try{const n=await async function(e,t){const n=await yF(e),r=_F(t.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let s;try{const n=await fetch(`${mF(e.appConfig)}/${t.token}`,i);s=await n.json()}catch(e){throw tF.create("token-update-failed",{errorInfo:e})}if(s.error){const e=s.error.message;throw tF.create("token-update-failed",{errorInfo:e})}if(!s.token)throw tF.create("token-update-no-token");return s.token}(e.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:n,createTime:Date.now()});return await fF(e.firebaseDependencies,r),n}catch(t){throw await wF(e),t}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await gF(e.firebaseDependencies,r.token)}catch(e){console.warn(e)}return bF(e.firebaseDependencies,n)}return bF(e.firebaseDependencies,n)}async function wF(e){const t=await dF(e.firebaseDependencies);t&&(await gF(e.firebaseDependencies,t.token),await async function(e){const t=pF(e),n=(await hF()).transaction(uF,"readwrite");await n.objectStore(uF).delete(t),await n.complete}(e.firebaseDependencies));const n=await e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}async function bF(e,t){const n={token:await async function(e,t){const n=await yF(e),r=_F(t),i={method:"POST",headers:n,body:JSON.stringify(r)};let s;try{const t=await fetch(mF(e.appConfig),i);s=await t.json()}catch(e){throw tF.create("token-subscribe-failed",{errorInfo:e})}if(s.error){const e=s.error.message;throw tF.create("token-subscribe-failed",{errorInfo:e})}if(!s.token)throw tF.create("token-subscribe-no-token");return s.token}(e,t),createTime:Date.now(),subscriptionOptions:t};return await fF(e,n),n.token}async function IF(e,t){const n=function({data:e}){if(!e)return null;try{return e.json()}catch(e){return null}}(e);if(!n)return;const r=await EF();if(function(e){return e.some((e=>"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://")))}(r))return function(e,t){t.isFirebaseMessaging=!0,t.messageType=iF.PUSH_RECEIVED;for(const n of e)n.postMessage(t)}(r,n);if(n.notification&&await function(e){var t;const{actions:n}=e,{maxActions:r}=Notification;n&&r&&n.length>r&&console.warn(`This browser only supports ${r} actions. The remaining actions will not be displayed.`);return self.registration.showNotification(null!==(t=e.title)&&void 0!==t?t:"",e)}(function(e){const t=Object.assign({},e.notification);return t.data={[rF]:e},t}(n)),t&&t.onBackgroundMessageHandler){const e=function(e){const t={from:e.from,collapseKey:e.collapse_key};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const i=t.notification.image;i&&(e.notification.image=i)}(t,e),function(e,t){t.data&&(e.data=t.data)}(t,e),function(e,t){if(!t.fcmOptions)return;e.fcmOptions={};const n=t.fcmOptions.link;n&&(e.fcmOptions.link=n);const r=t.fcmOptions.analytics_label;r&&(e.fcmOptions.analyticsLabel=r)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t,e),t}(n);"function"==typeof t.onBackgroundMessageHandler?t.onBackgroundMessageHandler(e):t.onBackgroundMessageHandler.next(e)}}async function TF(e){var t,n;const r=null===(n=null===(t=e.notification)||void 0===t?void 0:t.data)||void 0===n?void 0:n.FCM_MSG;if(!r)return;if(e.action)return;e.stopImmediatePropagation(),e.notification.close();const i=function(e){var t,n,r;const i=null!==(n=null===(t=e.fcmOptions)||void 0===t?void 0:t.link)&&void 0!==n?n:null===(r=e.notification)||void 0===r?void 0:r.click_action;if(i)return i;return function(e){return"object"==typeof e&&!!e&&"google.c.a.c_id"in e}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(e.data)?self.location.origin:null}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(r);if(!i)return;const s=new URL(i,self.location.href),o=new URL(self.location.origin);if(s.host!==o.host)return;let a=await async function(e){const t=await EF();for(const n of t){const t=new URL(n.url,self.location.href);if(e.host===t.host)return n}return null}(s);return a?a=await a.focus():(a=await self.clients.openWindow(i),await function(e){return new Promise((t=>{setTimeout(t,e)}))}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(3e3)),a?(r.messageType=iF.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,a.postMessage(r)):void 0}function EF(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function SF(e){return tF.create("missing-app-config-values",{valueName:e})}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class CF{constructor(e,t,n){this.onBackgroundMessageHandler=null,this.onMessageHandler=null;const r=function(e){if(!e||!e.options)throw SF("App Configuration Object");if(!e.name)throw SF("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const e of t)if(!n[e])throw SF(e);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function kF(e,t){
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
return function(e,t){if(void 0!==self.document)throw tF.create("only-available-in-sw");return e.onBackgroundMessageHandler=t,()=>{e.onBackgroundMessageHandler=null}}(e=Ia(e),t)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */Wa(new Ta("messaging-sw-exp",(e=>{(
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
async function(){return await Ho()&&"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})().then((e=>{if(!e)throw tF.create("unsupported-browser")})).catch((e=>{throw tF.create("indexed-db-unsupported")}));const t=new CF(e.getProvider("app-exp").getImmediate(),e.getProvider("installations-exp-internal").getImmediate(),e.getProvider("analytics-internal"));return self.addEventListener("push",(e=>{e.waitUntil(IF(e,t))})),self.addEventListener("pushsubscriptionchange",(e=>{e.waitUntil(async function(e,t){var n,r;const{newSubscription:i}=e;if(!i)return void await wF(t);const s=await dF(t.firebaseDependencies);await wF(t),t.vapidKey=null!==(r=null===(n=null==s?void 0:s.subscriptionOptions)||void 0===n?void 0:n.vapidKey)&&void 0!==r?r:nF,await vF(t)}(e,t))})),self.addEventListener("notificationclick",(e=>{e.waitUntil(TF(e))})),t}),"PUBLIC"));
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class RF{constructor(e,t){this.app=e,this._delegate=t,this.app=e,this._delegate=t}async getToken(e){return async function(e,t){return XL(e=Ia(e),t)}(this._delegate,e)}async deleteToken(){return ZL(this._delegate)}onMessage(e){return eF(this._delegate,e)}onBackgroundMessage(e){return kF(this._delegate,e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const NF=e=>navigator?new RF(e.getProvider("app-compat").getImmediate(),e.getProvider("messaging-exp").getImmediate()):new RF(e.getProvider("app-compat").getImmediate(),e.getProvider("messaging-sw-exp").getImmediate());
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
var AF;oc.INTERNAL.registerComponent(new Ta("messaging-compat",NF,"PUBLIC")),oc.registerVersion("@firebase/messaging-compat","0.0.900-exp.57f19127c"),function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(AF||(AF={}));
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const PF="firebasestorage.googleapis.com";class xF extends Qo{constructor(e,t){super(DF(e),`Firebase Storage: ${t} (${DF(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,xF.prototype)}_codeEquals(e){return DF(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function DF(e){return"storage/"+e}function OF(){return new xF("unknown","An unknown error occurred, please check the error payload for server response.")}function MF(){return new xF("canceled","User canceled the upload/download.")}function LF(){return new xF("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function FF(e){return new xF("invalid-argument",e)}function UF(){return new xF("app-deleted","The Firebase app was deleted.")}function qF(e,t){return new xF("invalid-format","String does not match format '"+e+"': "+t)}function jF(e){throw new xF("internal-error","Internal error: "+e)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class VF{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=AF.NO_ERROR,this.sendPromise_=new Promise((e=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=AF.ABORT,e(this)})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=AF.NETWORK_ERROR,e(this)})),this.xhr_.addEventListener("load",(()=>{e(this)}))}))}send(e,t,n,r){if(this.sent_)throw jF("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const e in r)r.hasOwnProperty(e)&&this.xhr_.setRequestHeader(e,r[e].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw jF("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw jF("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponseText(){if(!this.sent_)throw jF("cannot .getResponseText() before sending");return this.xhr_.responseText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class BF{createXhrIo(){return new VF}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class $F{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=$F.makeFromUrl(e,t)}catch(t){return new $F(e,"")}if(""===n.path)return n;throw new xF("invalid-default-bucket","Invalid default bucket '"+e+"'.")}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),a=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${t===PF?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let t=0;t<a.length;t++){const r=a[t],i=r.regex.exec(e);if(i){const e=i[r.indices.bucket];let t=i[r.indices.path];t||(t=""),n=new $F(e,t),r.postModify(n);break}}if(null==n)throw function(e){return new xF("invalid-url","Invalid URL '"+e+"'.")}(e);return n}}class WF{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function KF(e){return"string"==typeof e||e instanceof String}function zF(e){return HF()&&e instanceof Blob}function HF(){return"undefined"!=typeof Blob}function GF(e,t,n,r){if(r<t)throw FF(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw FF(`Invalid value for '${e}'. Expected ${n} or less.`)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function QF(e,t){const n=t.match(/^(\w+):\/\/.+/);let r=t;return null==(null==n?void 0:n[1])&&(r=`https://${t}`),`${r}/v0${e}`}function YF(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class JF{constructor(e,t,n,r,i,s,o,a,c,u,l){this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=s.slice(),this.callback_=o,this.errorCallback_=a,this.progressCallback_=u,this.timeout_=c,this.pool_=l,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=this;function t(t,n){const r=e.resolve_,i=e.reject_,s=n.xhr;if(n.wasSuccessCode)try{const t=e.callback_(s,s.getResponseText());!
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function(e){return void 0!==e}(t)?r():r(t)}catch(e){i(e)}else if(null!==s){const t=OF();t.serverResponse=s.getResponseText(),e.errorCallback_?i(e.errorCallback_(s,t)):i(t)}else if(n.canceled){i(e.appDelete_?UF():MF())}else{i(new xF("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}}this.canceled_?t(0,new XF(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,s=!1,o=0;function a(){return 2===o}let c=!1;function u(...e){c||(c=!0,t.apply(null,e))}function l(t){i=setTimeout((()=>{i=null,e(h,a())}),t)}function h(e,...t){if(c)return;if(e)return void u.call(null,e,...t);if(a()||s)return void u.call(null,e,...t);let n;r<64&&(r*=2),1===o?(o=2,n=0):n=1e3*(r+Math.random()),l(n)}let d=!1;function f(e){d||(d=!0,c||(null!==i?(e||(o=2),clearTimeout(i),l(0)):e||(o=1)))}return l(0),setTimeout((()=>{s=!0,f(!0)}),n),f}((function(t,n){if(n)return void t(!1,new XF(!1,null,!0));const r=e.pool_.createXhrIo();function i(t){const n=t.loaded,r=t.lengthComputable?t.total:-1;null!==e.progressCallback_&&e.progressCallback_(n,r)}e.pendingXhr_=r,null!==e.progressCallback_&&r.addUploadProgressListener(i),r.send(e.url_,e.method_,e.body_,e.headers_).then((n=>{null!==e.progressCallback_&&n.removeUploadProgressListener(i),e.pendingXhr_=null;const r=(n=n).getErrorCode()===AF.NO_ERROR,s=n.getStatus();if(!r||e.isRetryStatusCode_(s)){const e=n.getErrorCode()===AF.ABORT;return void t(!1,new XF(!1,null,e))}const o=-1!==e.successCodes_.indexOf(s);t(!0,new XF(o,n))}))}),t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()}isRetryStatusCode_(e){const t=e>=500&&e<600,n=-1!==[408,429].indexOf(e),r=-1!==this.additionalRetryCodes_.indexOf(e);return t||n||r}}class XF{constructor(e,t,n){this.wasSuccessCode=e,this.xhr=t,this.canceled=!!n}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function ZF(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function eU(...e){const t=ZF();if(void 0!==t){const n=new t;for(let t=0;t<e.length;t++)n.append(e[t]);return n.getBlob()}if(HF())return new Blob(e);throw new xF("unsupported-environment","This browser doesn't seem to support creating Blobs")}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const tU="raw",nU="base64",rU="base64url",iU="data_url";class sU{constructor(e,t){this.data=e,this.contentType=t||null}}function oU(e,t){switch(e){case tU:return new sU(aU(t));case nU:case rU:return new sU(cU(e,t));case iU:return new sU(function(e){const t=new uU(e);return t.base64?cU(nU,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(e){throw qF(iU,"Malformed data URL.")}return aU(t)}(t.rest)}(t),new uU(t).contentType)}throw OF()}function aU(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296==(64512&r)){if(n<e.length-1&&56320==(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function cU(e,t){switch(e){case nU:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw qF(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case rU:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw qF(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=atob(t)}catch(t){throw qF(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);return r}class uU{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw qF(iU,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=e.substring(e.indexOf(",")+1)}}class lU{constructor(e,t){let n=0,r="";zF(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(zF(this.data_)){const n=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,e,t);return null===n?null:new lU(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new lU(n,!0)}}static getBlob(...e){if(HF()){const t=e.map((e=>e instanceof lU?e.data_:e));return new lU(eU.apply(null,t))}{const t=e.map((e=>KF(e)?oU(tU,e).data:e.data_));let n=0;t.forEach((e=>{n+=e.byteLength}));const r=new Uint8Array(n);let i=0;return t.forEach((e=>{for(let t=0;t<e.length;t++)r[i++]=e[t]})),new lU(r,!0)}}uploadData(){return this.data_}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function hU(e){let t;try{t=JSON.parse(e)}catch(e){return null}return function(e){return"object"==typeof e&&!Array.isArray(e)}(t)?t:null}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function dU(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function fU(e,t){return t}class pU{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||fU}}let gU=null;function mU(){if(gU)return gU;const e=[];e.push(new pU("bucket")),e.push(new pU("generation")),e.push(new pU("metageneration")),e.push(new pU("name","fullPath",!0));const t=new pU("name");t.xform=function(e,t){return function(e){return!KF(e)||e.length<2?e:dU(e)}(t)},e.push(t);const n=new pU("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new pU("timeCreated")),e.push(new pU("updated")),e.push(new pU("md5Hash",null,!0)),e.push(new pU("cacheControl",null,!0)),e.push(new pU("contentDisposition",null,!0)),e.push(new pU("contentEncoding",null,!0)),e.push(new pU("contentLanguage",null,!0)),e.push(new pU("contentType",null,!0)),e.push(new pU("metadata","customMetadata",!0)),gU=e,gU}function yU(e,t,n){const r={type:"file"},i=n.length;for(let e=0;e<i;e++){const i=n[e];r[i.local]=i.xform(r,t[i.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,i=new $F(n,r);return t._makeStorageReference(i)}})}(r,e),r}function _U(e,t,n){const r=hU(t);if(null===r)return null;return yU(e,r,n)}function vU(e,t){const n={},r=t.length;for(let i=0;i<r;i++){const r=t[i];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function wU(e,t,n){const r=hU(n);if(null===r)return null;return function(e,t,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(const i of n.prefixes){const n=i.replace(/\/$/,""),s=e._makeStorageReference(new $F(t,n));r.prefixes.push(s)}if(n.items)for(const i of n.items){const n=e._makeStorageReference(new $F(t,i.name));r.items.push(n)}return r}(e,t,r)}class bU{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function IU(e){if(!e)throw OF()}function TU(e,t){return function(n,r){const i=_U(e,r,t);return IU(null!==i),i}}function EU(e,t){return function(n,r){const i=_U(e,r,t);return IU(null!==i),function(e,t,n){const r=hU(t);if(null===r)return null;if(!KF(r.downloadTokens))return null;const i=r.downloadTokens;if(0===i.length)return null;const s=encodeURIComponent;return i.split(",").map((t=>{const r=e.bucket,i=e.fullPath;return QF("/b/"+s(r)+"/o/"+s(i),n)+YF({alt:"media",token:t})}))[0]}(i,r,e.host)}}function SU(e){return function(t,n){let r;var i;return 401===t.getStatus()?r=t.getResponseText().includes("Firebase App Check token is invalid")?new xF("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new xF("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(i=e.bucket,r=new xF("quota-exceeded","Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):r=403===t.getStatus()?function(e){return new xF("unauthorized","User does not have permission to access '"+e+"'.")}(e.path):n,r.serverResponse=n.serverResponse,r}}function CU(e){const t=SU(e);return function(n,r){let i=t(n,r);return 404===n.getStatus()&&(i=function(e){return new xF("object-not-found","Object '"+e+"' does not exist.")}(e.path)),i.serverResponse=r.serverResponse,i}}function kU(e,t,n){const r=QF(t.fullServerUrl(),e.host),i=e.maxOperationRetryTime,s=new bU(r,"GET",TU(e,n),i);return s.errorHandler=CU(t),s}function RU(e,t,n,r,i){const s={};t.isRoot?s.prefix="":s.prefix=t.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const o=QF(t.bucketOnlyServerUrl(),e.host),a=e.maxOperationRetryTime,c=new bU(o,"GET",function(e,t){return function(n,r){const i=wU(e,t,r);return IU(null!==i),i}}(e,t.bucket),a);return c.urlParams=s,c.errorHandler=SU(t),c}function NU(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}class AU{constructor(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null}}function PU(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){IU(!1)}return IU(!!n&&-1!==(t||["active"]).indexOf(n)),n}const xU=262144;function DU(e,t,n,r,i,s,o,a){const c=new AU(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw new xF("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");const u=c.total-c.current;let l=u;i>0&&(l=Math.min(l,i));const h=c.current,d=h+l,f={"X-Goog-Upload-Command":l===u?"upload, finalize":"upload","X-Goog-Upload-Offset":c.current},p=r.slice(h,d);if(null===p)throw LF();const g=t.maxUploadRetryTime,m=new bU(n,"POST",(function(e,n){const i=PU(e,["active","final"]),o=c.current+l,a=r.size();let u;return u="final"===i?TU(t,s)(e,n):null,new AU(o,a,"final"===i,u)}),g);return m.headers=f,m.body=p.uploadData(),m.progressCallback=a||null,m.errorHandler=SU(e),m}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const OU="running",MU="paused",LU="success",FU="canceled",UU="error";function qU(e){switch(e){case"running":case"pausing":case"canceling":return OU;case"paused":return MU;case"success":return LU;case"canceled":return FU;case"error":default:return UU}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class jU{constructor(e,t,n){if(function(e){return"function"==typeof e}(e)||null!=t||null!=n)this.next=e,this.error=t,this.complete=n;else{const t=e;this.next=t.next,this.error=t.error,this.complete=t.complete}}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function VU(e){return(...t)=>{Promise.resolve().then((()=>e(...t)))}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class BU{constructor(e,t,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=mU(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=e=>{this._request=void 0,this._chunkMultiplier=1,e._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=e,this._transition("error"))},this._metadataErrorHandler=e=>{this._request=void 0,e._codeEquals("canceled")?this.completeTransitions_():(this._error=e,this._transition("error"))},this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t,this._start()})),this._promise.then(null,(()=>{}))}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((([t,n])=>{switch(this._state){case"running":e(t,n);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}}))}_createResumable(){this._resolveToken(((e,t)=>{const n=function(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),o=NU(t,r,i),a={name:o.fullPath},c=QF(s,e.host),u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},l=vU(o,n),h=e.maxUploadRetryTime,d=new bU(c,"POST",(function(e){let t;PU(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){IU(!1)}return IU(KF(t)),t}),h);return d.urlParams=a,d.headers=u,d.body=l,d.errorHandler=SU(t),d}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()}),this._errorHandler)}))}_fetchStatus(){const e=this._uploadUrl;this._resolveToken(((t,n)=>{const r=function(e,t,n,r){const i=e.maxUploadRetryTime,s=new bU(n,"POST",(function(e){const t=PU(e,["active","final"]);let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){IU(!1)}n||IU(!1);const i=Number(n);return IU(!isNaN(i)),new AU(i,r.size(),"final"===t)}),i);return s.headers={"X-Goog-Upload-Command":"query"},s.errorHandler=SU(t),s}(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(r,t,n);this._request=i,i.getPromise().then((e=>{e=e,this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()}),this._errorHandler)}))}_continueUpload(){const e=xU*this._chunkMultiplier,t=new AU(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken(((r,i)=>{let s;try{s=DU(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(e){return this._error=e,void this._transition("error")}const o=this._ref.storage._makeRequest(s,r,i);this._request=o,o.getPromise().then((e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()}),this._errorHandler)}))}_increaseMultiplier(){xU*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken(((e,t)=>{const n=kU(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(n,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._transition("success")}),this._metadataErrorHandler)}))}_oneShotUpload(){this._resolveToken(((e,t)=>{const n=function(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+a;const c=NU(t,r,i),u="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+vU(c,n)+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",l="\r\n--"+a+"--",h=lU.getBlob(u,r,l);if(null===h)throw LF();const d={name:c.fullPath},f=QF(s,e.host),p=e.maxUploadRetryTime,g=new bU(f,"POST",TU(e,n),p);return g.urlParams=d,g.headers=o,g.body=h.uploadData(),g.errorHandler=SU(t),g}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")}),this._errorHandler)}))}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request&&this._request.cancel();break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=MF(),this._state=e,this._notifyObservers();break;case"error":case"success":this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=qU(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,r){const i=new jU(t,n,r);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise();this._observers.slice().forEach((e=>{this._notifyObserver(e)}))}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(qU(this._state)){case LU:VU(this._resolve.bind(null,this.snapshot))();break;case FU:case UU:VU(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(qU(this._state)){case OU:case MU:e.next&&VU(e.next.bind(e,this.snapshot))();break;case LU:e.complete&&VU(e.complete.bind(e))();break;case FU:case UU:e.error&&VU(e.error.bind(e,this._error))();break;default:e.error&&VU(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class $U{constructor(e,t){this._service=e,this._location=t instanceof $F?t:$F.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new $U(e,t)}get root(){const e=new $F(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return dU(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new $F(this._location.bucket,e);return new $U(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new xF("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function WU(e){const t={prefixes:[],items:[]};return KU(e,t).then((()=>t))}async function KU(e,t,n){const r={pageToken:n},i=await zU(e,r);t.prefixes.push(...i.prefixes),t.items.push(...i.items),null!=i.nextPageToken&&await KU(e,t,i.nextPageToken)}async function zU(e,t){null!=t&&"number"==typeof t.maxResults&&GF("options.maxResults",1,1e3,t.maxResults);const n=t||{},r=RU(e.storage,e._location,"/",n.pageToken,n.maxResults);return(await e.storage.makeRequestWithTokens(r)).getPromise()}async function HU(e,t){e._throwIfRoot("updateMetadata");const n=function(e,t,n,r){const i=QF(t.fullServerUrl(),e.host),s=vU(n,r),o=e.maxOperationRetryTime,a=new bU(i,"PATCH",TU(e,r),o);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=s,a.errorHandler=CU(t),a}(e.storage,e._location,t,mU());return(await e.storage.makeRequestWithTokens(n)).getPromise()}async function GU(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=QF(t.fullServerUrl(),e.host),i=e.maxOperationRetryTime,s=new bU(r,"GET",EU(e,n),i);return s.errorHandler=CU(t),s}(e.storage,e._location,mU());return(await e.storage.makeRequestWithTokens(t)).getPromise().then((e=>{if(null===e)throw new xF("no-download-url","The given file does not have any download URLs.");return e}))}async function QU(e){e._throwIfRoot("deleteObject");const t=function(e,t){const n=QF(t.fullServerUrl(),e.host),r=e.maxOperationRetryTime,i=new bU(n,"DELETE",(function(e,t){}),r);return i.successCodes=[200,204],i.errorHandler=CU(t),i}(e.storage,e._location);return(await e.storage.makeRequestWithTokens(t)).getPromise()}function YU(e,t){const n=function(e,t){const n=t.split("/").filter((e=>e.length>0)).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new $F(e._location.bucket,n);return new $U(e.storage,r)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function JU(e,t){if(e instanceof eq){const n=e;if(null==n._bucket)throw new xF("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");const r=new $U(n,n._bucket);return null!=t?JU(r,t):r}if(void 0!==t){if(t.includes(".."))throw FF('`path` param cannot contain ".."');return YU(e,t)}return e}function XU(e,t){if(t&&function(e){return/^[A-Za-z]+:\/\//.test(e)}(t)){if(e instanceof eq)return new $U(e,t);throw FF("To use ref(service, url), the first argument must be a Storage instance.")}return JU(e,t)}function ZU(e,t){const n=null==t?void 0:t.storageBucket;return null==n?null:$F.makeFromBucketSpec(n,e)}class eq{constructor(e,t,n,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._pool=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=PF,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?$F.makeFromBucketSpec(i,this._host):ZU(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=$F.makeFromBucketSpec(this._url,e):this._bucket=ZU(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){GF("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){GF("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear(),Promise.resolve()}_makeStorageReference(e){return new $U(this,e)}_makeRequest(e,t,n){if(this._deleted)return new WF(UF());{const r=function(e,t,n,r,i,s){const o=YF(e.urlParams),a=e.url+o,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(c,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,r),new JF(a,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i)}(e,this._appId,t,n,this._pool,this._firebaseVersion);return this._requests.add(r),r.getPromise().then((()=>this._requests.delete(r)),(()=>this._requests.delete(r))),r}}async makeRequestWithTokens(e){const[t,n]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n)}}function tq(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new BU(e,new lU(t),n)}(e=Ia(e),t,n)}function nq(e){return async function(e){e._throwIfRoot("getMetadata");const t=kU(e.storage,e._location,mU());return(await e.storage.makeRequestWithTokens(t)).getPromise()}(e=Ia(e))}function rq(e,t){return XU(e=Ia(e),t)}function iq(e,{instanceIdentifier:t}){const n=e.getProvider("app-exp").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new eq(n,r,i,new BF,t,Ga)}Wa(new Ta("storage-exp",iq,"PUBLIC").setMultipleInstances(!0)),Ja("@firebase/storage","0.0.900-exp.57f19127c");class sq extends Qo{constructor(e,t){super(oq(e),`Firebase Storage: ${t} (${oq(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,sq.prototype)}_codeEquals(e){return oq(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function oq(e){return"storage/"+e}function aq(e){return new sq("invalid-argument",e)}function cq(e,t){return new sq("invalid-format","String does not match format '"+e+"': "+t)}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const uq={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class lq{constructor(e,t){this.data=e,this.contentType=t||null}}function hq(e,t){switch(e){case uq.RAW:return new lq(dq(t));case uq.BASE64:case uq.BASE64URL:return new lq(fq(e,t));case uq.DATA_URL:return new lq(function(e){const t=new pq(e);return t.base64?fq(uq.BASE64,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(e){throw cq(uq.DATA_URL,"Malformed data URL.")}return dq(t)}(t.rest)}(t),new pq(t).contentType)}throw new sq("unknown","An unknown error occurred, please check the error payload for server response.")}function dq(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296==(64512&r)){if(n<e.length-1&&56320==(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function fq(e,t){switch(e){case uq.BASE64:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw cq(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case uq.BASE64URL:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw cq(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=atob(t)}catch(t){throw cq(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);return r}class pq{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw cq(uq.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=e.substring(e.indexOf(",")+1)}}const gq={STATE_CHANGED:"state_changed"},mq={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class yq{constructor(e,t,n){this._delegate=e,this.task=t,this.ref=n}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class _q{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new yq(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then((t=>{if(e)return e(new yq(t,this,this._ref))}),t)}on(e,t,n,r){let i;return t&&(i="function"==typeof t?e=>t(new yq(e,this,this._ref)):{next:t.next?e=>t.next(new yq(e,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,i,n||void 0,r||void 0)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class vq{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map((e=>new wq(e,this._service)))}get items(){return this._delegate.items.map((e=>new wq(e,this._service)))}get nextPageToken(){return this._delegate.nextPageToken||null}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *  http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class wq{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function(e,t){return YU(e,t)}(this._delegate,e);return new wq(t,this.storage)}get root(){return new wq(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new wq(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new _q(tq(this._delegate,e,t),this)}putString(e,t=tU,n){this._throwIfRoot("putString");const r=hq(t,e),i=Object.assign({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new _q(new BU(this._delegate,new lU(r.data,!0),i),this)}listAll(){return function(e){return WU(e=Ia(e))}(this._delegate).then((e=>new vq(e,this.storage)))}list(e){return function(e,t){return zU(e=Ia(e),t)}(this._delegate,e||void 0).then((e=>new vq(e,this.storage)))}getMetadata(){return nq(this._delegate)}updateMetadata(e){return function(e,t){return HU(e=Ia(e),t)}(this._delegate,e)}getDownloadURL(){return function(e){return GU(e=Ia(e))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function(e){return QU(e=Ia(e))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw function(e){return new sq("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function bq(e){return/^[A-Za-z]+:\/\//.test(e)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Iq{constructor(e,t){this.app=e,this._delegate=t,this.INTERNAL={delete:()=>this._delegate._delete()}}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(bq(e))throw aq("ref() expected a child path but got a URL, use refFromURL instead.");return new wq(rq(this._delegate,e),this)}refFromURL(e){if(!bq(e))throw aq("refFromURL() expected a full URL but got a child path, use ref() instead.");try{$F.makeFromUrl(e,this._delegate.host)}catch(e){throw aq("refFromUrl() expected a valid full URL but got an invalid one.")}return new wq(rq(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t){!function(e,t,n){e.host=`http://${t}:${n}`}(this._delegate,e,t)}}function Tq(e,{instanceIdentifier:t}){const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("storage-exp").getImmediate({identifier:t});return new Iq(n,r)}!function(e){const t={TaskState:mq,TaskEvent:gq,StringFormat:uq,Storage:Iq,Reference:wq};e.INTERNAL.registerComponent(new Ta("storage",Tq,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),e.registerVersion("@firebase/storage-compat","0.0.900-exp.57f19127c")}(oc);const Eq="0.0.900-exp.57f19127c",Sq=Eq,Cq="FB-PERF-TRACE-MEASURE",kq="_wt_",Rq="_fcp",Nq="_fid",Aq="@firebase/performance/config",Pq="@firebase/performance/configexpire",xq="Performance",Dq=new Yo("performance",xq,{"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"Performance can only be initialized once."}),Oq=new Oa(xq);
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
let Mq,Lq,Fq,Uq;Oq.logLevel=ka.INFO;class qq{constructor(e){if(this.window=e,!e)throw Dq.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){this.performance&&this.performance.mark&&this.performance.mark(e)}measure(e,t,n){this.performance&&this.performance.measure&&this.performance.measure(e,t,n)}getEntriesByType(e){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(e):[]}getEntriesByName(e){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(e):[]}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!zo()||(Oq.info("IndexedDB is not supported by current browswer"),!1):(Oq.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;new this.PerformanceObserver((e=>{for(const n of e.getEntries())t(n)})).observe({entryTypes:[e]})}static getInstance(){return void 0===Mq&&(Mq=new qq(Lq)),Mq}}function jq(){return Fq}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Vq(e,t){const n=e.length-t.length;if(n<0||n>1)throw Dq.create("invalid String merger input");const r=[];for(let n=0;n<e.length;n++)r.push(e.charAt(n)),t.length>n&&r.push(t.charAt(n));return r.join("")}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Bq{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Vq("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Vq("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return void 0===Uq&&(Uq=new Bq),Uq}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var $q;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VISIBLE=1]="VISIBLE",e[e.HIDDEN=2]="HIDDEN"}($q||($q={}));const Wq=["firebase_","google_","ga_"],Kq=new RegExp("^[a-zA-Z]\\w*$");function zq(){const e=qq.getInstance().navigator;return"serviceWorker"in e?e.serviceWorker.controller?2:3:1}function Hq(){switch(qq.getInstance().document.visibilityState){case"visible":return $q.VISIBLE;case"hidden":return $q.HIDDEN;default:return $q.UNKNOWN}}function Gq(){const e=qq.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Qq(e){var t;const n=null===(t=e.options)||void 0===t?void 0:t.appId;if(!n)throw Dq.create("no app id");return n}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Yq="0.0.1",Jq=!0,Xq="FIREBASE_INSTALLATIONS_AUTH";function Zq(e,t){const n=function(){const e=qq.getInstance().localStorage;if(!e)return;const t=e.getItem(Pq);if(!(t&&(n=t,Number(n)>Date.now())))return;var n;const r=e.getItem(Aq);if(!r)return;try{return JSON.parse(r)}catch(e){return}}();return n?(tj(n),Promise.resolve()):function(e,t){return function(e){const t=e.getToken();return t.then((e=>{})),t}(e.installations).then((n=>{const r=function(e){var t;const n=null===(t=e.options)||void 0===t?void 0:t.projectId;if(!n)throw Dq.create("no project id");return n}(e.app),i=function(e){var t;const n=null===(t=e.options)||void 0===t?void 0:t.apiKey;if(!n)throw Dq.create("no api key");return n}(e.app),s=new Request(`https://firebaseremoteconfig.googleapis.com/v1/projects/${r}/namespaces/fireperf:fetch?key=${i}`,{method:"POST",headers:{Authorization:`${Xq} ${n}`},body:JSON.stringify({app_instance_id:t,app_instance_id_token:n,app_id:Qq(e.app),app_version:Sq,sdk_version:Yq})});return fetch(s).then((e=>{if(e.ok)return e.json();throw Dq.create("RC response not ok")}))})).catch((()=>{Oq.info(ej)}))}(e,t).then(tj).then((e=>function(e){const t=qq.getInstance().localStorage;if(!e||!t)return;t.setItem(Aq,JSON.stringify(e)),t.setItem(Pq,String(Date.now()+60*Bq.getInstance().configTimeToLive*60*1e3))}(e)),(()=>{}))}const ej="Could not fetch config, will use default configs";function tj(e){if(!e)return e;const t=Bq.getInstance(),n=e.entries||{};return void 0!==n.fpr_enabled?t.loggingEnabled="true"===String(n.fpr_enabled):t.loggingEnabled=Jq,n.fpr_log_source&&(t.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(t.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(t.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(t.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(t.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),t.logTraceAfterSampling=nj(t.tracesSamplingRate),t.logNetworkAfterSampling=nj(t.networkRequestsSamplingRate),e}function nj(e){return Math.random()<=e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */let rj,ij=1;function sj(e){return ij=2,rj=rj||function(e){return function(){const e=qq.getInstance().document;return new Promise((t=>{if(e&&"complete"!==e.readyState){const n=()=>{"complete"===e.readyState&&(e.removeEventListener("readystatechange",n),t())};e.addEventListener("readystatechange",n)}else t()}))}().then((()=>function(e){const t=e.getId();return t.then((e=>{Fq=e})),t}(e.installations))).then((t=>Zq(e,t))).then((()=>oj()),(()=>oj()))}(e),rj}function oj(){ij=3}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const aj=1e4;let cj,uj=3,lj=[],hj=!1;function dj(e){setTimeout((()=>{if(0!==uj)return lj.length?void function(){const e=lj.splice(0,1e3),t=e.map((e=>({source_extension_json_proto3:e.message,event_time_ms:String(e.eventTime)})));(function(e,t){return function(e){const t=Bq.getInstance().getFlTransportFullUrl();return fetch(t,{method:"POST",body:JSON.stringify(e)})}(e).then((e=>(e.ok||Oq.info("Call to Firebase backend failed."),e.json()))).then((e=>{const n=Number(e.nextRequestWaitMillis);let r=aj;isNaN(n)||(r=Math.max(n,r));const i=e.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(lj=[...t,...lj],Oq.info("Retry transport request later.")),uj=3,dj(r)}))})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Bq.getInstance().logSource,log_event:t},e).catch((()=>{lj=[...e,...lj],uj--,Oq.info(`Tries left: ${uj}.`),dj(aj)}))}():dj(aj)}),e)}function fj(e){return(...t)=>{!function(e){if(!e.eventTime||!e.message)throw Dq.create("invalid cc log");lj=[...lj,e]}({message:e(...t),eventTime:Date.now()})}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function pj(e,t){cj||(cj=fj(yj)),cj(e,t)}function gj(e){const t=Bq.getInstance();!t.instrumentationEnabled&&e.isAuto||(t.dataCollectionEnabled||e.isAuto)&&qq.getInstance().requiredApisAvailable()&&(e.isAuto&&Hq()!==$q.VISIBLE||(3===ij?mj(e):sj(e.performanceController).then((()=>mj(e)),(()=>mj(e)))))}function mj(e){if(!jq())return;const t=Bq.getInstance();t.loggingEnabled&&t.logTraceAfterSampling&&setTimeout((()=>pj(e,1)),0)}function yj(e,t){return 0===t?function(e){const t={url:e.url,http_method:e.httpMethod||0,http_response_code:200,response_payload_bytes:e.responsePayloadBytes,client_start_time_us:e.startTimeUs,time_to_response_initiated_us:e.timeToResponseInitiatedUs,time_to_response_completed_us:e.timeToResponseCompletedUs},n={application_info:_j(e.performanceController.app),network_request_metric:t};return JSON.stringify(n)}(e):function(e){const t={name:e.name,is_auto:e.isAuto,client_start_time_us:e.startTimeUs,duration_us:e.durationUs};0!==Object.keys(e.counters).length&&(t.counters=e.counters);const n=e.getAttributes();0!==Object.keys(n).length&&(t.custom_attributes=n);const r={application_info:_j(e.performanceController.app),trace_metric:t};return JSON.stringify(r)}(e)}function _j(e){return{google_app_id:Qq(e),app_instance_id:jq(),web_app_info:{sdk_version:Sq,page_url:qq.getInstance().getUrl(),service_worker_status:zq(),visibility_state:Hq(),effective_connection_type:Gq()},application_process_state:0}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const vj=["_fp",Rq,Nq];
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class wj{constructor(e,t,n=!1,r){this.performanceController=e,this.name=t,this.isAuto=n,this.state=1,this.customAttributes={},this.counters={},this.api=qq.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=`FB-PERF-TRACE-START-${this.randomId}-${this.name}`,this.traceStopMark=`FB-PERF-TRACE-STOP-${this.randomId}-${this.name}`,this.traceMeasure=r||`FB-PERF-TRACE-MEASURE-${this.randomId}-${this.name}`,r&&this.calculateTraceMetrics())}start(){if(1!==this.state)throw Dq.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(2!==this.state)throw Dq.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),gj(this)}record(e,t,n){if(e<=0)throw Dq.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw Dq.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*t),this.startTimeUs=Math.floor(1e3*e),n&&n.attributes&&(this.customAttributes=Object.assign({},n.attributes)),n&&n.metrics)for(const e of Object.keys(n.metrics))isNaN(Number(n.metrics[e]))||(this.counters[e]=Number(Math.floor(n.metrics[e])));gj(this)}incrementMetric(e,t=1){void 0===this.counters[e]?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)}putMetric(e,t){if(!function(e,t){return!(0===e.length||e.length>100)&&(t&&t.startsWith(kq)&&vj.indexOf(e)>-1||!e.startsWith("_"))}(e,this.name))throw Dq.create("invalid custom metric name",{customMetricName:e});this.counters[e]=function(e){const t=Math.floor(e);return t<e&&Oq.info(`Metric value should be an Integer, setting the value as : ${t}.`),t}(t)}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const n=function(e){return!(0===e.length||e.length>40)&&(!Wq.some((t=>e.startsWith(t)))&&!!e.match(Kq))}(e),r=function(e){return 0!==e.length&&e.length<=100}(t);if(n&&r)this.customAttributes[e]=t;else{if(!n)throw Dq.create("invalid attribute name",{attributeName:e});if(!r)throw Dq.create("invalid attribute value",{attributeValue:t})}}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){void 0!==this.customAttributes[e]&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(1e3*t.duration),this.startTimeUs=Math.floor(1e3*(t.startTime+this.api.getTimeOrigin())))}static createOobTrace(e,t,n,r){const i=qq.getInstance().getUrl();if(!i)return;const s=new wj(e,kq+i,!0),o=Math.floor(1e3*qq.getInstance().getTimeOrigin());s.setStartTime(o),t&&t[0]&&(s.setDuration(Math.floor(1e3*t[0].duration)),s.putMetric("domInteractive",Math.floor(1e3*t[0].domInteractive)),s.putMetric("domContentLoadedEventEnd",Math.floor(1e3*t[0].domContentLoadedEventEnd)),s.putMetric("loadEventEnd",Math.floor(1e3*t[0].loadEventEnd)));if(n){const e=n.find((e=>"first-paint"===e.name));e&&e.startTime&&s.putMetric("_fp",Math.floor(1e3*e.startTime));const t=n.find((e=>"first-contentful-paint"===e.name));t&&t.startTime&&s.putMetric(Rq,Math.floor(1e3*t.startTime)),r&&s.putMetric(Nq,Math.floor(1e3*r))}gj(s)}static createUserTimingTrace(e,t){gj(new wj(e,t,!1,t))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function bj(e,t){const n=t;if(!n||void 0===n.responseStart)return;const r=qq.getInstance().getTimeOrigin(),i=Math.floor(1e3*(n.startTime+r)),s=n.responseStart?Math.floor(1e3*(n.responseStart-n.startTime)):void 0,o=Math.floor(1e3*(n.responseEnd-n.startTime));!function(e){const t=Bq.getInstance();if(!t.instrumentationEnabled)return;const n=e.url,r=t.logEndPointUrl.split("?")[0],i=t.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&t.loggingEnabled&&t.logNetworkAfterSampling&&setTimeout((()=>pj(e,0)),0)}({performanceController:e,url:n.name&&n.name.split("?")[0],responsePayloadBytes:n.transferSize,startTimeUs:i,timeToResponseInitiatedUs:s,timeToResponseCompletedUs:o})}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function Ij(e){jq()&&(setTimeout((()=>function(e){const t=qq.getInstance(),n=t.getEntriesByType("navigation"),r=t.getEntriesByType("paint");if(t.onFirstInputDelay){let i=setTimeout((()=>{wj.createOobTrace(e,n,r),i=void 0}),5e3);t.onFirstInputDelay((t=>{i&&(clearTimeout(i),wj.createOobTrace(e,n,r,t))}))}else wj.createOobTrace(e,n,r)}(e)),0),setTimeout((()=>function(e){const t=qq.getInstance(),n=t.getEntriesByType("resource");for(const t of n)bj(e,t);t.setupObserver("resource",(t=>bj(e,t)))}(e)),0),setTimeout((()=>function(e){const t=qq.getInstance(),n=t.getEntriesByType("measure");for(const t of n)Tj(e,t);t.setupObserver("measure",(t=>Tj(e,t)))}(e)),0))}function Tj(e,t){const n=t.name;n.substring(0,Cq.length)!==Cq&&wj.createUserTimingTrace(e,n)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class Ej{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(void 0!==(null==e?void 0:e.dataCollectionEnabled)&&(this.dataCollectionEnabled=e.dataCollectionEnabled),void 0!==(null==e?void 0:e.instrumentationEnabled)&&(this.instrumentationEnabled=e.instrumentationEnabled),qq.getInstance().requiredApisAvailable()?Ho().then((e=>{e&&(hj||(dj(5500),hj=!0),sj(this).then((()=>Ij(this)),(()=>Ij(this))),this.initialized=!0)})).catch((e=>{Oq.info(`Environment doesn't support IndexedDB: ${e}`)})):Oq.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Bq.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Bq.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Bq.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Bq.getInstance().dataCollectionEnabled}}Wa(new Ta("performance-exp",((e,{options:t})=>{const n=e.getProvider("app-exp").getImmediate(),r=e.getProvider("installations-exp-internal").getImmediate();if("[DEFAULT]"!==n.name)throw Dq.create("FB not default");if("undefined"==typeof window)throw Dq.create("no window");!function(e){Lq=e}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(window);const i=new Ej(n,r);return i._init(t),i}),"PUBLIC")),Ja("@firebase/performance-exp",Eq);
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class Sj{constructor(e,t){this.app=e,this._delegate=t}get instrumentationEnabled(){return this._delegate.instrumentationEnabled}set instrumentationEnabled(e){this._delegate.instrumentationEnabled=e}get dataCollectionEnabled(){return this._delegate.dataCollectionEnabled}set dataCollectionEnabled(e){this._delegate.dataCollectionEnabled=e}trace(e){return function(e,t){return e=Ia(e),new wj(e,t)}(this._delegate,e)}}function Cj(e){const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("performance-exp").getImmediate();return new Sj(t,n)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
var kj;(kj=oc).INTERNAL.registerComponent(new Ta("performance-compat",Cj,"PUBLIC")),kj.registerVersion("@firebase/performance-compat","0.0.900-exp.57f19127c");
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Rj="analytics-exp",Nj="https://www.googletagmanager.com/gtag/js",Aj=new Oa("@firebase/analytics");
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
function Pj(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}function xj(e,t,n,r){return async function(i,s,o){try{"event"===i?await async function(e,t,n,r,i){try{let s=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=await Pj(n);for(const n of e){const e=r.find((e=>e.measurementId===n)),i=e&&t[e.appId];if(!i){s=[];break}s.push(i)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",r,i||{})}catch(e){Aj.error(e)}}(e,t,n,s,o):"config"===i?await async function(e,t,n,r,i,s){const o=r[i];try{if(o)await t[o];else{const e=(await Pj(n)).find((e=>e.measurementId===i));e&&await t[e.appId]}}catch(e){Aj.error(e)}e("config",i,s)}(e,t,n,r,s,o):e("set",s)}catch(e){Aj.error(e)}}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const Dj=new Yo("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"Firebase Analytics has already been initialized. initializeAnalytics() must only be called once. getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'});const Oj=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Mj(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function Lj(e,t=Oj,n){const{appId:r,apiKey:i,measurementId:s}=e.options;if(!r)throw Dj.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw Dj.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Uj;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),Fj({appId:r,apiKey:i,measurementId:s},o,a,t)}async function Fj(e,{throttleEndTimeMillis:t,backoffCount:n},r,i=Oj){const{appId:s,measurementId:o}=e;try{await function(e,t){return new Promise(((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(s),r(Dj.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(r,t)}catch(e){if(o)return Aj.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${e.message}]`),{appId:s,measurementId:o};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:Mj(r)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,i);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw Dj.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return i.deleteThrottleMetadata(s),t}catch(t){if(!function(e){if(!(e instanceof Qo&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t)){if(i.deleteThrottleMetadata(s),o)return Aj.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${t.message}]`),{appId:s,measurementId:o};throw t}const a=503===Number(t.customData.httpStatus)?ba(n,i.intervalMillis,30):ba(n,i.intervalMillis),c={throttleEndTimeMillis:Date.now()+a,backoffCount:n+1};return i.setThrottleMetadata(s,c),Aj.debug(`Calling attemptFetch again in ${a} millis`),Fj(e,c,r,i)}}class Uj{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function qj(e,t,n,r,i,s,o){var a;const c=Lj(e);c.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&Aj.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>Aj.error(e))),t.push(c);const u=async function(){if(!zo())return Aj.warn(Dj.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await Ho()}catch(e){return Aj.warn(Dj.create("indexeddb-unavailable",{errorInfo:e}).message),!1}return!0}().then((e=>e?r.getId():void 0)),[l,h]=await Promise.all([c,u]);(function(){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(Nj))return t;return null})()||function(e,t){const n=document.createElement("script");n.src=`${Nj}?l=${e}&id=${t}`,n.async=!0,document.head.appendChild(n)}(s,l.measurementId),i("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d.origin="firebase",d.update=!0,null!=h&&(d.firebase_id=h),i("config",l.measurementId,d),l.measurementId}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class jj{constructor(e){this.app=e}_delete(){return delete Vj[this.app.options.appId],Promise.resolve()}}let Vj={},Bj=[];const $j={};let Wj,Kj,zj="dataLayer",Hj="gtag",Gj=!1;function Qj(e){if(Gj)throw Dj.create("already-initialized");e.dataLayerName&&(zj=e.dataLayerName),e.gtagName&&(Hj=e.gtagName)}function Yj(e,t,n){!function(){const e=[];if(Bo()&&e.push("This is a browser extension environment."),Go()||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=Dj.create("invalid-analytics-context",{errorInfo:t});Aj.warn(n.message)}}();const r=e.options.appId;if(!r)throw Dj.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw Dj.create("no-api-key");Aj.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Vj[r])throw Dj.create("already-exists",{id:r});if(!Gj){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(zj);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,i){let s=function(...e){window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(s=window[i]),window[i]=xj(s,e,t,n),{gtagCore:s,wrappedGtag:window[i]}}(Vj,Bj,$j,zj,Hj);Kj=e,Wj=t,Gj=!0}Vj[r]=qj(e,Bj,$j,t,Wj,zj,n);return new jj(e)}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */async function Jj(){if(Bo())return!1;if(!Go())return!1;if(!zo())return!1;try{return await Ho()}catch(e){return!1}}function Xj(e,t,n){e=Ia(e),async function(e,t,n,r){if(r&&r.global)return e("set",{screen_name:n}),Promise.resolve();e("config",await t,{update:!0,screen_name:n})}(Kj,Vj[e.app.options.appId],t,n).catch((e=>Aj.error(e)))}function Zj(e,t,n){e=Ia(e),async function(e,t,n,r){if(r&&r.global)return e("set",{user_id:n}),Promise.resolve();e("config",await t,{update:!0,user_id:n})}(Kj,Vj[e.app.options.appId],t,n).catch((e=>Aj.error(e)))}function eV(e,t,n){e=Ia(e),async function(e,t,n,r){if(r&&r.global){const t={};for(const e of Object.keys(n))t[`user_properties.${e}`]=n[e];return e("set",t),Promise.resolve()}e("config",await t,{update:!0,user_properties:n})}(Kj,Vj[e.app.options.appId],t,n).catch((e=>Aj.error(e)))}function tV(e,t){e=Ia(e),async function(e,t){const n=await e;window[`ga-disable-${n}`]=!t}(Vj[e.app.options.appId],t).catch((e=>Aj.error(e)))}function nV(e,t,n,r){e=Ia(e),async function(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}(Kj,Vj[e.app.options.appId],t,n,r).catch((e=>Aj.error(e)))}Wa(new Ta(Rj,((e,{options:t})=>Yj(e.getProvider("app-exp").getImmediate(),e.getProvider("installations-exp-internal").getImmediate(),t)),"PUBLIC")),Wa(new Ta("analytics-internal",(function(e){try{const t=e.getProvider(Rj).getImmediate();return{logEvent:(e,n,r)=>nV(t,e,n,r)}}catch(e){throw Dj.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),Ja("@firebase/analytics-exp","0.0.900-exp.57f19127c");
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class rV{constructor(e,t){this.app=e,this._delegate=t}logEvent(e,t,n){nV(this._delegate,e,t,n)}setCurrentScreen(e,t){Xj(this._delegate,e,t)}setUserId(e,t){Zj(this._delegate,e,t)}setUserProperties(e,t){eV(this._delegate,e,t)}setAnalyticsCollectionEnabled(e){tV(this._delegate,e)}}
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */var iV;!function(e){e.ADD_SHIPPING_INFO="add_shipping_info",e.ADD_PAYMENT_INFO="add_payment_info",e.ADD_TO_CART="add_to_cart",e.ADD_TO_WISHLIST="add_to_wishlist",e.BEGIN_CHECKOUT="begin_checkout",e.CHECKOUT_PROGRESS="checkout_progress",e.EXCEPTION="exception",e.GENERATE_LEAD="generate_lead",e.LOGIN="login",e.PAGE_VIEW="page_view",e.PURCHASE="purchase",e.REFUND="refund",e.REMOVE_FROM_CART="remove_from_cart",e.SCREEN_VIEW="screen_view",e.SEARCH="search",e.SELECT_CONTENT="select_content",e.SELECT_ITEM="select_item",e.SELECT_PROMOTION="select_promotion",e.SET_CHECKOUT_OPTION="set_checkout_option",e.SHARE="share",e.SIGN_UP="sign_up",e.TIMING_COMPLETE="timing_complete",e.VIEW_CART="view_cart",e.VIEW_ITEM="view_item",e.VIEW_ITEM_LIST="view_item_list",e.VIEW_PROMOTION="view_promotion",e.VIEW_SEARCH_RESULTS="view_search_results"}(iV||(iV={}));
/**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const sV=e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("analytics-exp").getImmediate();return new rV(t,n)};!function(){const e={Analytics:rV,settings:Qj,isSupported:Jj,EventName:iV};oc.INTERNAL.registerComponent(new Ta("analytics-compat",sV,"PUBLIC").setServiceProps(e).setMultipleInstances(!0))}(),oc.registerVersion("@firebase/analytics-compat","0.0.900-exp.57f19127c");const oV="@firebase/remote-config-exp";
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class aV{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */const cV=new Yo("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}."});
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
const uV=["1","true","t","yes","y","on"];class lV{constructor(e,t=""){this._source=e,this._value=t}asString(){return this._value}asBoolean(){return"static"!==this._source&&uV.indexOf(this._value.toLowerCase())>=0}asNumber(){if("static"===this._source)return 0;let e=Number(this._value);return isNaN(e)&&(e=0),e}getSource(){return this._source}}async function hV(e){const t=Ia(e),[n,r]=await Promise.all([t._storage.getLastSuccessfulFetchResponse(),t._storage.getActiveConfigEtag()]);return!!(n&&n.config&&n.eTag&&n.eTag!==r)&&(await Promise.all([t._storageCache.setActiveConfig(n.config),t._storage.setActiveConfigEtag(n.eTag)]),!0)}function dV(e){const t=Ia(e);return t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then((()=>{t._isInitializationComplete=!0}))),t._initializePromise}async function fV(e){const t=Ia(e),n=new aV;setTimeout((async()=>{n.abort()}),t.settings.fetchTimeoutMillis);try{await t._client.fetch({cacheMaxAgeMillis:t.settings.minimumFetchIntervalMillis,signal:n}),await t._storageCache.setLastFetchStatus("success")}catch(e){const n=function(e,t){return e instanceof Qo&&-1!==e.code.indexOf(t)}(e,"fetch-throttle")?"throttle":"failure";throw await t._storageCache.setLastFetchStatus(n),e}}function pV(e){const t=Ia(e);return function(e={},t={}){return Object.keys(Object.assign(Object.assign({},e),t))}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */(t._storageCache.getActiveConfig(),t.defaultConfig).reduce(((t,n)=>(t[n]=gV(e,n),t)),{})}function gV(e,t){const n=Ia(e);n._isInitializationComplete||n._logger.debug(`A value was requested for key "${t}" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.`);const r=n._storageCache.getActiveConfig();return r&&void 0!==r[t]?new lV("remote",r[t]):n.defaultConfig&&void 0!==n.defaultConfig[t]?new lV("default",String(n.defaultConfig[t])):(n._logger.debug(`Returning static value for key "${t}". Define a default or remote value if this is unintentional.`),new lV("static"))}class mV{constructor(e,t,n,r){this.client=e,this.storage=t,this.storageCache=n,this.logger=r}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const n=Date.now()-t,r=n<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${n}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${r}.`),r}async fetch(e){const[t,n]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(n&&this.isCachedDataFresh(e.cacheMaxAgeMillis,t))return n;e.eTag=n&&n.eTag;const r=await this.client.fetch(e),i=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===r.status&&i.push(this.storage.setLastSuccessfulFetchResponse(r)),await Promise.all(i),r}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function yV(e=navigator){return e.languages&&e.languages[0]||e.language}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class _V{constructor(e,t,n,r,i,s){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=s}async fetch(e){const[t,n]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),r=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,i={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},s={sdk_version:this.sdkVersion,app_instance_id:t,app_instance_id_token:n,app_id:this.appId,language_code:yV()},o={method:"POST",headers:i,body:JSON.stringify(s)},a=fetch(r,o),c=new Promise(((t,n)=>{e.signal.addEventListener((()=>{const e=new Error("The operation was aborted.");e.name="AbortError",n(e)}))}));let u;try{await Promise.race([a,c]),u=await a}catch(e){let t="fetch-client-network";throw"AbortError"===e.name&&(t="fetch-timeout"),cV.create(t,{originalErrorMessage:e.message})}let l=u.status;const h=u.headers.get("ETag")||void 0;let d,f;if(200===u.status){let e;try{e=await u.json()}catch(e){throw cV.create("fetch-client-parse",{originalErrorMessage:e.message})}d=e.entries,f=e.state}if("INSTANCE_STATE_UNSPECIFIED"===f?l=500:"NO_CHANGE"===f?l=304:"NO_TEMPLATE"!==f&&"EMPTY_CONFIG"!==f||(d={}),304!==l&&200!==l)throw cV.create("fetch-status",{httpStatus:l});return{status:l,eTag:h,config:d}}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class vV{constructor(e,t){this.client=e,this.storage=t}async fetch(e){const t=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,t)}async attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:n}){await function(e,t){return new Promise(((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(s),r(cV.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(e.signal,t);try{const t=await this.client.fetch(e);return await this.storage.deleteThrottleMetadata(),t}catch(t){if(!function(e){if(!(e instanceof Qo&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t))throw t;const r={throttleEndTimeMillis:Date.now()+ba(n),backoffCount:n+1};return await this.storage.setThrottleMetadata(r),this.attemptFetch(e,r)}}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class wV{constructor(e,t,n,r,i){this.app=e,this._client=t,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */function bV(e,t){const n=e.target.error||void 0;return cV.create(t,{originalErrorMessage:n&&n.message})}const IV="app_namespace_store";class TV{constructor(e,t,n,r=function(){return new Promise(((e,t)=>{const n=indexedDB.open("firebase_remote_config",1);n.onerror=e=>{t(bV(e,"storage-open"))},n.onsuccess=t=>{e(t.target.result)},n.onupgradeneeded=e=>{const t=e.target.result;switch(e.oldVersion){case 0:t.createObjectStore(IV,{keyPath:"compositeKey"})}}}))}()){this.appId=e,this.appName=t,this.namespace=n,this.openDbPromise=r}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(e){const t=await this.openDbPromise;return new Promise(((n,r)=>{const i=t.transaction([IV],"readonly").objectStore(IV),s=this.createCompositeKey(e);try{const e=i.get(s);e.onerror=e=>{r(bV(e,"storage-get"))},e.onsuccess=e=>{const t=e.target.result;n(t?t.value:void 0)}}catch(e){r(cV.create("storage-get",{originalErrorMessage:e&&e.message}))}}))}async set(e,t){const n=await this.openDbPromise;return new Promise(((r,i)=>{const s=n.transaction([IV],"readwrite").objectStore(IV),o=this.createCompositeKey(e);try{const e=s.put({compositeKey:o,value:t});e.onerror=e=>{i(bV(e,"storage-set"))},e.onsuccess=()=>{r()}}catch(e){i(cV.create("storage-set",{originalErrorMessage:e&&e.message}))}}))}async delete(e){const t=await this.openDbPromise;return new Promise(((n,r)=>{const i=t.transaction([IV],"readwrite").objectStore(IV),s=this.createCompositeKey(e);try{const e=i.delete(s);e.onerror=e=>{r(bV(e,"storage-delete"))},e.onsuccess=()=>{n()}}catch(e){r(cV.create("storage-delete",{originalErrorMessage:e&&e.message}))}}))}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}
/**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */class EV{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){const e=this.storage.getLastFetchStatus(),t=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),r=await e;r&&(this.lastFetchStatus=r);const i=await t;i&&(this.lastSuccessfulFetchTimestampMillis=i);const s=await n;s&&(this.activeConfig=s)}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */Wa(new Ta("remote-config-exp",(function(e,{instanceIdentifier:t}){const n=e.getProvider("app-exp").getImmediate(),r=e.getProvider("installations-exp-internal").getImmediate();if("undefined"==typeof window)throw cV.create("registration-window");const{projectId:i,apiKey:s,appId:o}=n.options;if(!i)throw cV.create("registration-project-id");if(!s)throw cV.create("registration-api-key");if(!o)throw cV.create("registration-app-id");t=t||"firebase";const a=new TV(o,n.name,t),c=new EV(a),u=new Oa(oV);u.logLevel=ka.ERROR;const l=new _V(r,Ga,t,i,s,o),h=new vV(l,a),d=new mV(h,a,c,u),f=new wV(n,d,c,a,u);return dV(f),f}),"PUBLIC").setMultipleInstances(!0)),Ja(oV,"0.0.900-exp.57f19127c");
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
class SV{constructor(e,t){this.app=e,this._delegate=t}get defaultConfig(){return this._delegate.defaultConfig}set defaultConfig(e){this._delegate.defaultConfig=e}get fetchTimeMillis(){return this._delegate.fetchTimeMillis}get lastFetchStatus(){return this._delegate.lastFetchStatus}get settings(){return this._delegate.settings}set settings(e){this._delegate.settings=e}activate(){return hV(this._delegate)}ensureInitialized(){return dV(this._delegate)}fetch(){return fV(this._delegate)}fetchAndActivate(){
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
return async function(e){return e=Ia(e),await fV(e),hV(e)}(this._delegate)}getAll(){return pV(this._delegate)}getBoolean(e){return function(e,t){return gV(Ia(e),t).asBoolean()}(this._delegate,e)}getNumber(e){return function(e,t){return gV(Ia(e),t).asNumber()}(this._delegate,e)}getString(e){return function(e,t){return gV(Ia(e),t).asString()}(this._delegate,e)}getValue(e){return gV(this._delegate,e)}setLogLevel(e){!function(e,t){const n=Ia(e);switch(t){case"debug":n._logger.logLevel=ka.DEBUG;break;case"silent":n._logger.logLevel=ka.SILENT;break;default:n._logger.logLevel=ka.ERROR}}(this._delegate,e)}}function CV(e,{instanceIdentifier:t}){const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("remote-config-exp").getImmediate({identifier:t});return new SV(n,r)}
/**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
return function(e){e.INTERNAL.registerComponent(new Ta("remoteConfig-compat",CV,"PUBLIC").setMultipleInstances(!0)),e.registerVersion("@firebase/remote-config-compat","0.0.900-exp.57f19127c")}(oc),
/**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   */
console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the CDN builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nhttps://www.gstatic.com/firebasejs/5.0.0/firebase-<PACKAGE>.js\n"),oc.registerVersion("firebase-exp","9.0.0-beta.5","compat-cdn"),oc}));
